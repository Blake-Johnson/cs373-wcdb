function reorder_init(){lis=document.getElementsBySelector("ul#orderthese li");var e=document.getElementsBySelector("input[name=order_]")[0];setOrder(e.value.split(",")),e.disabled=!0,draw();for(var t=(lis.length-1)*height,n=0;n<lis.length;n++){var a=lis[n],r=document.getElementById("handle"+a.id);a.style.zIndex=1,Drag.init(r,a,left+10,left+10,top+10,top+10+t),a.onDragStart=startDrag,a.onDragEnd=endDrag,r.style.cursor="move"}}function submitOrderForm(){var e=document.getElementsBySelector("input[name=order_]")[0];e.value=getOrder(),e.disabled=!1}function startDrag(){this.style.zIndex="10",this.className="dragging"}function endDrag(e,t){this.style.zIndex="1",this.className="";var n=this.index,a=Math.round((t-10-top)/height);this.style.top=10+top+a*height+"px",this.index=a,moveItem(n,a)}function moveItem(e,t){if(e!=t){var n,a,r;t>e?(a=e,r=t,n=-1):(n=1,r=e,a=t);for(var i=new Array,o=0;o<lis.length;o++)i[o]=a>o||o>r?lis[o]:o!=t?lis[o-n]:lis[e];reIndex(i),lis=i,draw(),document.getElementsBySelector("input[name=order_]")[0].value=getOrder()}}function reIndex(e){for(var t=0;t<e.length;t++)e[t].index=t}function draw(){for(var e=0;e<lis.length;e++){var t=lis[e];t.index=e,t.style.position="absolute",t.style.left=10+left+"px",t.style.top=10+top+e*height+"px"}}function getOrder(){for(var e=new Array(lis.length),t=0;t<lis.length;t++)e[t]=lis[t].id.substring(1,100);return e.join(",")}function setOrder(e){for(var t=new Array,n=0;n<e.length;n++){var a="p"+e[n];t[t.length]=document.getElementById(a)}reIndex(t),lis=t,draw()}function addEvent(e,t,n,a){if(e.addEventListener)return e.addEventListener(t,n,a),!0;if(e.attachEvent){var r=e.attachEvent("on"+t,n);return r}e["on"+t]=n}addEvent(window,"load",reorder_init);var lis,top=0,left=0,height=30;