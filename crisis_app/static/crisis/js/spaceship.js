/*
  Copyright (c) <2011, 2012> Rootof Creations HB, rootof.com, kickassapp.com
  Raphael 1.5.2 - JavaScript Vector Library
  Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
  Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */
 !function(window){function now(){return(new Date).getTime()}function bind(t,e){return function(){return e.apply(t,arguments)}}function each(t,e,i){if("function"==typeof t.forEach)return t.forEach(e,i),t;for(var n in t)t.hasOwnProperty(n)&&e.call(i||window,t[n],n);return t}function addEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&(t["e"+e+i]=i,t[e+i]=function(){return t["e"+e+i](window.event)},t.attachEvent("on"+e,t[e+i]))}function removeEvent(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&(t.detachEvent("on"+e,t[e+i]),t[e+i]=null,t["e"+e+i]=null)}function stopEvent(t){t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function elementIsContainedIn(t,e){return element.contains?t.contains(e):!!(16&t.compareDocumentPosition(e))}function code(t){var e={38:"up",40:"down",37:"left",39:"right",27:"esc"};return e[t]?e[t]:String.fromCharCode(t)}function random(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function getRect(t){if("function"==typeof t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=window.pageXOffset,n=window.pageYOffset;return{width:e.width,height:e.height,left:e.left+i,top:e.top+n}}for(var e={width:t.offsetWidth,height:t.offsetHeight,left:0,top:0},s=t;s;)e.left+=s.offsetLeft,e.top+=s.offsetTop,s=s.offsetParent;return e}function getCompatElement(){var t=document;return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.documentElement}function getScrollSize(){var t=getCompatElement(),e={x:t.clientWidth,y:t.clientHeight},i=document.body;return{x:Math.max(t.scrollWidth,i.scrollWidth,e.x),y:Math.max(t.scrollHeight,i.scrollHeight,e.y)}}function setStyles(t,e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];"number"==typeof n&&"opacity"!==i&&"zIndex"!==i&&(n+="px"),t.style[i]=n}}function hasClass(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function addClass(t,e){hasClass(t,e)||(t.className+=" "+e)}function cloneElement(t){return t.cloneNode(!0)}!function(){function t(){if(t.is(arguments[0],G)){for(var e=arguments[0],i=Ue[y](t,e.splice(0,3+t.is(e[0],N))),n=i.set(),s=0,r=e[$];r>s;s++){var a=e[s]||{};h[d](a.type)&&n[D](i[a.type]().attr(a))}return n}return Ue[y](t,arguments)}function e(){for(var t=[],e=0;32>e;e++)t[e]=(~~(16*z.random()))[F](16);return t[12]=4,t[16]=(8|3&t[16])[F](16),"r-"+t[E]("")}function i(t,e,i){function n(){var s=Array[u].slice.call(arguments,0),r=s[E]("►"),a=n.cache=n.cache||{},o=n.count=n.count||[];return a[d](r)?i?i(a[r]):a[r]:(o[$]>=1e3&&delete a[o.shift()],o[D](r),a[r]=t[y](e,s),i?i(a[r]):a[r])}return n}function n(e,i,n,s,r){return r?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+r,i,n-2*r,r,-r,s-2*r,2*r-n,2*r-s):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,i,n,s,-n)}function s(){return this.x+_+this.y}function r(e){return function(i,n,s,r){var a={back:e};return t.is(s,"function")?r=s:a.rot=s,i&&i.constructor==De&&(i=i.attrs.path),i&&(a.along=i),this.animate(a,n,r)}}function a(t,e,i,n,s,r){function a(t){return((u*t+c)*t+h)*t}function o(t,e){var i=l(t,e);return((f*i+p)*i+d)*i}function l(t,e){var i,n,s,r,o,l;for(s=t,l=0;8>l;l++){if(r=a(s)-t,O(r)<e)return s;if(o=(3*u*s+2*c)*s+h,O(o)<1e-6)break;s-=r/o}if(i=0,n=1,s=t,i>s)return i;if(s>n)return n;for(;n>i;){if(r=a(s),O(r-t)<e)return s;t>r?i=s:n=s,s=(n-i)/2+i}return s}var h=3*e,c=3*(n-e)-h,u=1-h-c,d=3*i,p=3*(s-i)-d,f=1-d-p;return o(t,1/(200*r))}t.version="1.5.2";var o,l=/[, ]+/,h={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},c=/\{(\d+)\}/g,u="prototype",d="hasOwnProperty",p=document,f=window,m={was:Object[u][d].call(f,"Raphael"),is:f.Raphael},g=function(){this.customAttributes={}},v="appendChild",y="apply",w="concat",x="createTouch"in p,b="",_=" ",k=String,C="split",S="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[C](_),T={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},E="join",$="length",M=k[u].toLowerCase,z=Math,P=z.max,A=z.min,O=z.abs,j=z.pow,B=z.PI,N="number",R="string",G="array",F="toString",L="fill",I=Object[u][F],D="push",V=/^url\(['"]?([^\)]+?)['"]?\)$/i,W=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,H={NaN:1,Infinity:1,"-Infinity":1},K=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,q=z.round,Y="setAttribute",X=parseFloat,U=parseInt,J=" progid:DXImageTransform.Microsoft",Z=k[u].toUpperCase,Q={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},te={along:"along",blur:N,"clip-rect":"csv",cx:N,cy:N,fill:"colour","fill-opacity":N,"font-size":N,height:N,opacity:N,path:"path",r:N,rotation:"csv",rx:N,ry:N,scale:"csv",stroke:"colour","stroke-opacity":N,"stroke-width":N,translation:"csv",width:N,x:N,y:N},ee="replace",ie=/^(from|to|\d+%?)$/,ne=/\s*,\s*/,se={hs:1,rg:1},re=/,?([achlmqrstvxz]),?/gi,ae=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,oe=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,le=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,he=function(t,e){return t.key-e.key};if(t.type=f.SVGAngle||p.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ce,ue=p.createElement("div");if(ue.innerHTML='<v:shape adj="1"/>',ce=ue.firstChild,ce.style.behavior="url(#default#VML)",!ce||"object"!=typeof ce.adj)return t.type=null;ue=null}t.svg=!(t.vml="VML"==t.type),g[u]=t[u],o=g[u],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=M.call(e),"finite"==e?!H[d](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||I.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,i,n,s,r,a){if(null==r){var o=e-n,l=i-s;return o||l?(180*(0>o)+180*z.atan(-l/-o)/B+360)%360:0}return t.angle(e,i,r,a)-t.angle(n,s,r,a)},t.rad=function(t){return t%360*B/180},t.deg=function(t){return 180*t/B%360},t.snapTo=function(e,i,n){if(n=t.is(n,"finite")?n:10,t.is(e,G)){for(var s=e.length;s--;)if(O(e[s]-i)<=n)return e[s]}else{e=+e;var r=i%e;if(n>r)return i-r;if(r>e-n)return i-r+e}return i},t.setWindow=function(t){f=t,p=f.document};var de=function(e){if(t.vml){var n,s=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),n=r.body}catch(a){n=createPopup().document.body}var o=n.createTextRange();de=i(function(t){try{n.style.color=k(t)[ee](s,b);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e[F](16)).slice(-6)}catch(i){return"none"}})}else{var l=p.createElement("i");l.title="Raphaël Colour Picker",l.style.display="none",p.body[v](l),de=i(function(t){return l.style.color=t,p.defaultView.getComputedStyle(l,b).getPropertyValue("color")})}return de(e)},pe=function(){return"hsb("+[this.h,this.s,this.b]+")"},fe=function(){return"hsl("+[this.h,this.s,this.l]+")"},me=function(){return this.hex};t.hsb2rgb=function(e,i,n,s){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,i=e.s,e=e.h,s=e.o),t.hsl2rgb(e,i,n/2,s)},t.hsl2rgb=function(e,i,n,s){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,i=e.s,e=e.h),(e>1||i>1||n>1)&&(e/=360,i/=100,n/=100);var r,a,o,l={},h=["r","g","b"];if(i){r=.5>n?n*(1+i):n+i-n*i,a=2*n-r;for(var c=0;3>c;c++)o=e+1/3*-(c-1),0>o&&o++,o>1&&o--,l[h[c]]=1>6*o?a+6*(r-a)*o:1>2*o?r:2>3*o?a+6*(r-a)*(2/3-o):a}else l={r:n,g:n,b:n};return l.r*=255,l.g*=255,l.b*=255,l.hex="#"+(16777216|l.b|l.g<<8|l.r<<16).toString(16).slice(1),t.is(s,"finite")&&(l.opacity=s),l.toString=me,l},t.rgb2hsb=function(e,i,n){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(n=e.b,i=e.g,e=e.r),null==i&&t.is(e,R)){var s=t.getRGB(e);e=s.r,i=s.g,n=s.b}(e>1||i>1||n>1)&&(e/=255,i/=255,n/=255);var r,a,o=P(e,i,n),l=A(e,i,n),h=o;if(l==o)return{h:0,s:0,b:o,toString:pe};var c=o-l;return a=c/o,r=e==o?(i-n)/c:i==o?2+(n-e)/c:4+(e-i)/c,r/=6,0>r&&r++,r>1&&r--,{h:r,s:a,b:h,toString:pe}},t.rgb2hsl=function(e,i,n){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(n=e.b,i=e.g,e=e.r),null==i&&t.is(e,R)){var s=t.getRGB(e);e=s.r,i=s.g,n=s.b}(e>1||i>1||n>1)&&(e/=255,i/=255,n/=255);var r,a,o,l=P(e,i,n),h=A(e,i,n),c=(l+h)/2;if(h==l)o={h:0,s:0,l:c};else{var u=l-h;a=.5>c?u/(l+h):u/(2-l-h),r=e==l?(i-n)/u:i==l?2+(n-e)/u:4+(e-i)/u,r/=6,0>r&&r++,r>1&&r--,o={h:r,s:a,l:c}}return o.toString=fe,o},t._path2string=function(){return this.join(",")[ee](re,"$1")},t.getRGB=i(function(e){if(!e||(e=k(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(se[d](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=de(e));var i,n,s,r,a,o,l=e.match(W);return l?(l[2]&&(s=U(l[2].substring(5),16),n=U(l[2].substring(3,5),16),i=U(l[2].substring(1,3),16)),l[3]&&(s=U((a=l[3].charAt(3))+a,16),n=U((a=l[3].charAt(2))+a,16),i=U((a=l[3].charAt(1))+a,16)),l[4]&&(o=l[4][C](ne),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),n=X(o[1]),"%"==o[1].slice(-1)&&(n*=2.55),s=X(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),"rgba"==l[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100)),l[5]?(o=l[5][C](ne),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),n=X(o[1]),"%"==o[1].slice(-1)&&(n*=2.55),s=X(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsba"==l[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100),t.hsb2rgb(i,n,s,r)):l[6]?(o=l[6][C](ne),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),n=X(o[1]),"%"==o[1].slice(-1)&&(n*=2.55),s=X(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsla"==l[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100),t.hsl2rgb(i,n,s,r)):(l={r:i,g:n,b:s},l.hex="#"+(16777216|s|n<<8|i<<16).toString(16).slice(1),t.is(r,"finite")&&(l.opacity=r),l)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=i(function(e){if(!e)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=[];return t.is(e,G)&&t.is(e[0],G)&&(n=ve(e)),n[$]||k(e)[ee](ae,function(t,e,s){var r=[],a=M.call(e);for(s[ee](oe,function(t,e){e&&r[D](+e)}),"m"==a&&r[$]>2&&(n[D]([e][w](r.splice(0,2))),a="l",e="m"==e?"l":"L");r[$]>=i[a]&&(n[D]([e][w](r.splice(0,i[a]))),i[a]););}),n[F]=t._path2string,n}),t.findDotsAtSegment=function(t,e,i,n,s,r,a,o,l){var h=1-l,c=j(h,3)*t+3*j(h,2)*l*i+3*h*l*l*s+j(l,3)*a,u=j(h,3)*e+3*j(h,2)*l*n+3*h*l*l*r+j(l,3)*o,d=t+2*l*(i-t)+l*l*(s-2*i+t),p=e+2*l*(n-e)+l*l*(r-2*n+e),f=i+2*l*(s-i)+l*l*(a-2*s+i),m=n+2*l*(r-n)+l*l*(o-2*r+n),g=(1-l)*t+l*i,v=(1-l)*e+l*n,y=(1-l)*s+l*a,w=(1-l)*r+l*o,x=90-180*z.atan((d-f)/(p-m))/B;return(d>f||m>p)&&(x+=180),{x:c,y:u,m:{x:d,y:p},n:{x:f,y:m},start:{x:g,y:v},end:{x:y,y:w},alpha:x}};var ge=i(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=Se(t);for(var e,i=0,n=0,s=[],r=[],a=0,o=t[$];o>a;a++)if(e=t[a],"M"==e[0])i=e[1],n=e[2],s[D](i),r[D](n);else{var l=Ce(i,n,e[1],e[2],e[3],e[4],e[5],e[6]);s=s[w](l.min.x,l.max.x),r=r[w](l.min.y,l.max.y),i=e[5],n=e[6]}var h=A[y](0,s),c=A[y](0,r);return{x:h,y:c,width:P[y](0,s)-h,height:P[y](0,r)-c}}),ve=function(e){var i=[];t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));for(var n=0,s=e[$];s>n;n++){i[n]=[];for(var r=0,a=e[n][$];a>r;r++)i[n][r]=e[n][r]}return i[F]=t._path2string,i},ye=i(function(e){t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));var i=[],n=0,s=0,r=0,a=0,o=0;"M"==e[0][0]&&(n=e[0][1],s=e[0][2],r=n,a=s,o++,i[D](["M",n,s]));for(var l=o,h=e[$];h>l;l++){var c=i[l]=[],u=e[l];if(u[0]!=M.call(u[0]))switch(c[0]=M.call(u[0]),c[0]){case"a":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]-n).toFixed(3),c[7]=+(u[7]-s).toFixed(3);break;case"v":c[1]=+(u[1]-s).toFixed(3);break;case"m":r=u[1],a=u[2];default:for(var d=1,p=u[$];p>d;d++)c[d]=+(u[d]-(d%2?n:s)).toFixed(3)}else{c=i[l]=[],"m"==u[0]&&(r=u[1]+n,a=u[2]+s);for(var f=0,m=u[$];m>f;f++)i[l][f]=u[f]}var g=i[l][$];switch(i[l][0]){case"z":n=r,s=a;break;case"h":n+=+i[l][g-1];break;case"v":s+=+i[l][g-1];break;default:n+=+i[l][g-2],s+=+i[l][g-1]}}return i[F]=t._path2string,i},0,ve),we=i(function(e){t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));var i=[],n=0,s=0,r=0,a=0,o=0;"M"==e[0][0]&&(n=+e[0][1],s=+e[0][2],r=n,a=s,o++,i[0]=["M",n,s]);for(var l=o,h=e[$];h>l;l++){var c=i[l]=[],u=e[l];if(u[0]!=Z.call(u[0]))switch(c[0]=Z.call(u[0]),c[0]){case"A":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]+n),c[7]=+(u[7]+s);break;case"V":c[1]=+u[1]+s;break;case"H":c[1]=+u[1]+n;break;case"M":r=+u[1]+n,a=+u[2]+s;default:for(var d=1,p=u[$];p>d;d++)c[d]=+u[d]+(d%2?n:s)}else for(var f=0,m=u[$];m>f;f++)i[l][f]=u[f];switch(c[0]){case"Z":n=r,s=a;break;case"H":n=c[1];break;case"V":s=c[1];break;case"M":r=i[l][i[l][$]-2],a=i[l][i[l][$]-1];default:n=i[l][i[l][$]-2],s=i[l][i[l][$]-1]}}return i[F]=t._path2string,i},null,ve),xe=function(t,e,i,n){return[t,e,i,n,i,n]},be=function(t,e,i,n,s,r){var a=1/3,o=2/3;return[a*t+o*i,a*e+o*n,a*s+o*i,a*r+o*n,s,r]},_e=function(t,e,n,s,r,a,o,l,h,c){var u,d=120*B/180,p=B/180*(+r||0),f=[],m=i(function(t,e,i){var n=t*z.cos(i)-e*z.sin(i),s=t*z.sin(i)+e*z.cos(i);return{x:n,y:s}});if(c)T=c[0],M=c[1],k=c[2],S=c[3];else{u=m(t,e,-p),t=u.x,e=u.y,u=m(l,h,-p),l=u.x,h=u.y;var g=(z.cos(B/180*r),z.sin(B/180*r),(t-l)/2),v=(e-h)/2,y=g*g/(n*n)+v*v/(s*s);y>1&&(y=z.sqrt(y),n=y*n,s=y*s);var x=n*n,b=s*s,_=(a==o?-1:1)*z.sqrt(O((x*b-x*v*v-b*g*g)/(x*v*v+b*g*g))),k=_*n*v/s+(t+l)/2,S=_*-s*g/n+(e+h)/2,T=z.asin(((e-S)/s).toFixed(9)),M=z.asin(((h-S)/s).toFixed(9));T=k>t?B-T:T,M=k>l?B-M:M,0>T&&(T=2*B+T),0>M&&(M=2*B+M),o&&T>M&&(T-=2*B),!o&&M>T&&(M-=2*B)}var P=M-T;if(O(P)>d){var A=M,j=l,N=h;M=T+d*(o&&M>T?1:-1),l=k+n*z.cos(M),h=S+s*z.sin(M),f=_e(l,h,n,s,r,0,o,j,N,[M,A,k,S])}P=M-T;var R=z.cos(T),G=z.sin(T),F=z.cos(M),L=z.sin(M),I=z.tan(P/4),D=4/3*n*I,V=4/3*s*I,W=[t,e],H=[t+D*G,e-V*R],K=[l+D*L,h-V*F],q=[l,h];if(H[0]=2*W[0]-H[0],H[1]=2*W[1]-H[1],c)return[H,K,q][w](f);f=[H,K,q][w](f)[E]()[C](",");for(var Y=[],X=0,U=f[$];U>X;X++)Y[X]=X%2?m(f[X-1],f[X],p).y:m(f[X],f[X+1],p).x;return Y},ke=function(t,e,i,n,s,r,a,o,l){var h=1-l;return{x:j(h,3)*t+3*j(h,2)*l*i+3*h*l*l*s+j(l,3)*a,y:j(h,3)*e+3*j(h,2)*l*n+3*h*l*l*r+j(l,3)*o}},Ce=i(function(t,e,i,n,s,r,a,o){var l,h=s-2*i+t-(a-2*s+i),c=2*(i-t)-2*(s-i),u=t-i,d=(-c+z.sqrt(c*c-4*h*u))/2/h,p=(-c-z.sqrt(c*c-4*h*u))/2/h,f=[e,o],m=[t,a];return O(d)>"1e12"&&(d=.5),O(p)>"1e12"&&(p=.5),d>0&&1>d&&(l=ke(t,e,i,n,s,r,a,o,d),m[D](l.x),f[D](l.y)),p>0&&1>p&&(l=ke(t,e,i,n,s,r,a,o,p),m[D](l.x),f[D](l.y)),h=r-2*n+e-(o-2*r+n),c=2*(n-e)-2*(r-n),u=e-n,d=(-c+z.sqrt(c*c-4*h*u))/2/h,p=(-c-z.sqrt(c*c-4*h*u))/2/h,O(d)>"1e12"&&(d=.5),O(p)>"1e12"&&(p=.5),d>0&&1>d&&(l=ke(t,e,i,n,s,r,a,o,d),m[D](l.x),f[D](l.y)),p>0&&1>p&&(l=ke(t,e,i,n,s,r,a,o,p),m[D](l.x),f[D](l.y)),{min:{x:A[y](0,m),y:A[y](0,f)},max:{x:P[y](0,m),y:P[y](0,f)}}}),Se=i(function(t,e){for(var i=we(t),n=e&&we(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var i,n;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][w](_e[y](0,[e.x,e.y][w](t.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),n=e.y+(e.y-(e.by||e.y)),t=["C",i,n][w](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][w](be(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][w](be(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][w](xe(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][w](xe(e.x,e.y,t[1],e.y));break;case"V":t=["C"][w](xe(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][w](xe(e.x,e.y,e.X,e.Y))}return t}),o=function(t,e){if(t[e][$]>7){t[e].shift();for(var s=t[e];s[$];)t.splice(e++,0,["C"][w](s.splice(0,6)));t.splice(e,1),c=P(i[$],n&&n[$]||0)}},l=function(t,e,s,r,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",r.x,r.y]),s.bx=0,s.by=0,s.x=t[a][1],s.y=t[a][2],c=P(i[$],n&&n[$]||0))},h=0,c=P(i[$],n&&n[$]||0);c>h;h++){i[h]=a(i[h],s),o(i,h),n&&(n[h]=a(n[h],r)),n&&o(n,h),l(i,n,s,r,h),l(n,i,r,s,h);var u=i[h],d=n&&n[h],p=u[$],f=n&&d[$];s.x=u[p-2],s.y=u[p-1],s.bx=X(u[p-4])||s.x,s.by=X(u[p-3])||s.y,r.bx=n&&(X(d[f-4])||r.x),r.by=n&&(X(d[f-3])||r.y),r.x=n&&d[f-2],r.y=n&&d[f-1]}return n?[i,n]:i},null,ve),Te=i(function(e){for(var i=[],n=0,s=e[$];s>n;n++){var r={},a=e[n].match(/^([^:]*):?([\d\.]*)/);if(r.color=t.getRGB(a[1]),r.color.error)return null;r.color=r.color.hex,a[2]&&(r.offset=a[2]+"%"),i[D](r)}for(n=1,s=i[$]-1;s>n;n++)if(!i[n].offset){for(var o=X(i[n-1].offset||0),l=0,h=n+1;s>h;h++)if(i[h].offset){l=i[h].offset;break}l||(l=100,h=s),l=X(l);for(var c=(l-o)/(h-n+1);h>n;n++)o+=c,i[n].offset=o+"%"}return i}),Ee=function(e,i,n,s){var r;return t.is(e,R)||t.is(e,"object")?(r=t.is(e,R)?p.getElementById(e):e,r.tagName?null==i?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:i,height:n}:void 0):{container:1,x:e,y:i,width:n,height:s}},$e=function(t,e){var i=this;for(var n in e)if(e[d](n)&&!(n in t))switch(typeof e[n]){case"function":!function(e){t[n]=t===i?e:function(){return e[y](i,arguments)}}(e[n]);break;case"object":t[n]=t[n]||{},$e.call(this,t[n],e[n]);break;default:t[n]=e[n]}},Me=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},ze=function(t,e){e.top!==t&&(Me(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},Pe=function(t,e){e.bottom!==t&&(Me(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},Ae=function(t,e,i){Me(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},Oe=function(t,e,i){Me(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},je=function(t){return function(){throw new Error("Raphaël: you are calling to method “"+t+"” of removed object")}};if(t.pathToRelative=ye,t.svg){o.svgns="http://www.w3.org/2000/svg",o.xlink="http://www.w3.org/1999/xlink",q=function(t){return+t+.5*(~~t===t)};var Be=function(t,e){if(!e)return t=p.createElementNS(o.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in e)e[d](i)&&t[Y](i,k(e[i]))};t[F]=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var Ne=function(t,e){var i=Be("path");e.canvas&&e.canvas[v](i);var n=new De(i,e);return n.type="path",Fe(n,{fill:"none",stroke:"#000",path:t}),n},Re=function(t,i,n){var s="linear",r=.5,a=.5,o=t.style;if(i=k(i)[ee](le,function(t,e,i){if(s="radial",e&&i){r=X(e),a=X(i);var n=2*(a>.5)-1;j(r-.5,2)+j(a-.5,2)>.25&&(a=z.sqrt(.25-j(r-.5,2))*n+.5)&&.5!=a&&(a=a.toFixed(5)-1e-5*n)}return b}),i=i[C](/\s*\-\s*/),"linear"==s){var l=i.shift();if(l=-X(l),isNaN(l))return null;var h=[0,0,z.cos(l*B/180),z.sin(l*B/180)],c=1/(P(O(h[2]),O(h[3]))||1);h[2]*=c,h[3]*=c,h[2]<0&&(h[0]=-h[2],h[2]=0),h[3]<0&&(h[1]=-h[3],h[3]=0)}var u=Te(i);if(!u)return null;var d=t.getAttribute(L);d=d.match(/^url\(#(.*)\)$/),d&&n.defs.removeChild(p.getElementById(d[1]));var f=Be(s+"Gradient");f.id=e(),Be(f,"radial"==s?{fx:r,fy:a}:{x1:h[0],y1:h[1],x2:h[2],y2:h[3]}),n.defs[v](f);for(var m=0,g=u[$];g>m;m++){var y=Be("stop");Be(y,{offset:u[m].offset?u[m].offset:m?"100%":"0%","stop-color":u[m].color||"#fff"}),f[v](y)}return Be(t,{fill:"url(#"+f.id+")",opacity:1,"fill-opacity":1}),o.fill=b,o.opacity=1,o.fillOpacity=1,1},Ge=function(e){var i=e.getBBox();Be(e.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Fe=function(i,n){var s={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},r=i.node,a=i.attrs,o=i.rotate(),h=function(t,e){if(e=s[M.call(e)]){for(var i=t.attrs["stroke-width"]||"1",a={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||n["stroke-linecap"]]||0,o=[],l=e[$];l--;)o[l]=e[l]*i+(l%2?1:-1)*a;Be(r,{"stroke-dasharray":o[E](",")})}};n[d]("rotation")&&(o=n.rotation);var c=k(o)[C](l);c.length-1?(c[1]=+c[1],c[2]=+c[2]):c=null,X(o)&&i.rotate(0,!0);for(var u in n)if(n[d](u)){if(!Q[d](u))continue;var f=n[u];switch(a[u]=f,u){case"blur":i.blur(f);break;case"rotation":i.rotate(f,!0);break;case"href":case"title":case"target":var m=r.parentNode;if("a"!=M.call(m.tagName)){var g=Be("a");m.insertBefore(g,r),g[v](r),m=g}"target"==u&&"blank"==f?m.setAttributeNS(i.paper.xlink,"show","new"):m.setAttributeNS(i.paper.xlink,u,f);break;case"cursor":r.style.cursor=f;break;case"clip-rect":var y=k(f)[C](l);if(4==y[$]){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var w=Be("clipPath"),x=Be("rect");w.id=e(),Be(x,{x:y[0],y:y[1],width:y[2],height:y[3]}),w[v](x),i.paper.defs[v](w),Be(r,{"clip-path":"url(#"+w.id+")"}),i.clip=x}if(!f){var S=p.getElementById(r.getAttribute("clip-path")[ee](/(^url\(#|\)$)/g,b));S&&S.parentNode.removeChild(S),Be(r,{"clip-path":b}),delete i.clip}break;case"path":"path"==i.type&&Be(r,{d:f?a.path=we(f):"M0,0"});break;case"width":if(r[Y](u,f),!a.fx)break;u="x",f=a.x;case"x":a.fx&&(f=-a.x-(a.width||0));case"rx":if("rx"==u&&"rect"==i.type)break;case"cx":c&&("x"==u||"cx"==u)&&(c[1]+=f-a[u]),r[Y](u,f),i.pattern&&Ge(i);break;case"height":if(r[Y](u,f),!a.fy)break;u="y",f=a.y;case"y":a.fy&&(f=-a.y-(a.height||0));case"ry":if("ry"==u&&"rect"==i.type)break;case"cy":c&&("y"==u||"cy"==u)&&(c[2]+=f-a[u]),r[Y](u,f),i.pattern&&Ge(i);break;case"r":"rect"==i.type?Be(r,{rx:f,ry:f}):r[Y](u,f);break;case"src":"image"==i.type&&r.setAttributeNS(i.paper.xlink,"href",f);break;case"stroke-width":r.style.strokeWidth=f,r[Y](u,f),a["stroke-dasharray"]&&h(i,a["stroke-dasharray"]);break;case"stroke-dasharray":h(i,f);break;case"translation":var T=k(f)[C](l);T[0]=+T[0]||0,T[1]=+T[1]||0,c&&(c[1]+=T[0],c[2]+=T[1]),$i.call(i,T[0],T[1]);break;case"scale":T=k(f)[C](l),i.scale(+T[0]||1,+T[1]||+T[0]||1,isNaN(X(T[2]))?null:+T[2],isNaN(X(T[3]))?null:+T[3]);break;case L:var z=k(f).match(V);if(z){w=Be("pattern");var P=Be("image");w.id=e(),Be(w,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Be(P,{x:0,y:0}),P.setAttributeNS(i.paper.xlink,"href",z[1]),w[v](P);var A=p.createElement("img");A.style.cssText="position:absolute;left:-9999em;top-9999em",A.onload=function(){Be(w,{width:this.offsetWidth,height:this.offsetHeight}),Be(P,{width:this.offsetWidth,height:this.offsetHeight}),p.body.removeChild(this),i.paper.safari()},p.body[v](A),A.src=z[1],i.paper.defs[v](w),r.style.fill="url(#"+w.id+")",Be(r,{fill:"url(#"+w.id+")"}),i.pattern=w,i.pattern&&Ge(i);break}var O=t.getRGB(f);if(O.error){if(({circle:1,ellipse:1}[d](i.type)||"r"!=k(f).charAt())&&Re(r,f,i.paper)){a.gradient=f,a.fill="none";break}}else delete n.gradient,delete a.gradient,!t.is(a.opacity,"undefined")&&t.is(n.opacity,"undefined")&&Be(r,{opacity:a.opacity}),!t.is(a["fill-opacity"],"undefined")&&t.is(n["fill-opacity"],"undefined")&&Be(r,{"fill-opacity":a["fill-opacity"]});O[d]("opacity")&&Be(r,{"fill-opacity":O.opacity>1?O.opacity/100:O.opacity});case"stroke":O=t.getRGB(f),r[Y](u,O.hex),"stroke"==u&&O[d]("opacity")&&Be(r,{"stroke-opacity":O.opacity>1?O.opacity/100:O.opacity});break;case"gradient":(({circle:1,ellipse:1})[d](i.type)||"r"!=k(f).charAt())&&Re(r,f,i.paper);break;case"opacity":a.gradient&&!a[d]("stroke-opacity")&&Be(r,{"stroke-opacity":f>1?f/100:f});case"fill-opacity":if(a.gradient){var j=p.getElementById(r.getAttribute(L)[ee](/^url\(#|\)$/g,b));if(j){var B=j.getElementsByTagName("stop");B[B[$]-1][Y]("stop-opacity",f)}break}default:"font-size"==u&&(f=U(f,10)+"px");var N=u[ee](/(\-.)/g,function(t){return Z.call(t.substring(1))});r.style[N]=f,r[Y](u,f)}}Ie(i,n),c?i.rotate(c.join(_)):X(o)&&i.rotate(o,!0)},Le=1.2,Ie=function(e,i){if("text"==e.type&&(i[d]("text")||i[d]("font")||i[d]("font-size")||i[d]("x")||i[d]("y"))){var n=e.attrs,s=e.node,r=s.firstChild?U(p.defaultView.getComputedStyle(s.firstChild,b).getPropertyValue("font-size"),10):10;if(i[d]("text")){for(n.text=i.text;s.firstChild;)s.removeChild(s.firstChild);for(var a=k(i.text)[C]("\n"),o=0,l=a[$];l>o;o++)if(a[o]){var h=Be("tspan");o&&Be(h,{dy:r*Le,x:n.x}),h[v](p.createTextNode(a[o])),s[v](h)}}else for(a=s.getElementsByTagName("tspan"),o=0,l=a[$];l>o;o++)o&&Be(a[o],{dy:r*Le,x:n.x});Be(s,{y:n.y});var c=e.getBBox(),u=n.y-(c.y+c.height/2);u&&t.is(u,"finite")&&Be(s,{y:n.y+u})}},De=function(e,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Ve=De[u];De[u].rotate=function(e,i,n){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][E](_):this._.rt.deg;var s=this.getBBox();return e=k(e)[C](l),e[$]-1&&(i=X(e[1]),n=X(e[2])),e=X(e[0]),null!=i&&i!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==n&&(i=null),this._.rt.cx=i,this._.rt.cy=n,i=null==i?s.x+s.width/2:i,n=null==n?s.y+s.height/2:n,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,n),this.clip&&Be(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,n)})):(this.transformations[0]=b,this.clip&&Be(this.clip,{transform:b})),Be(this.node,{transform:this.transformations[E](_)}),this},De[u].hide=function(){return!this.removed&&(this.node.style.display="none"),this},De[u].show=function(){return!this.removed&&(this.node.style.display=""),this},De[u].remove=function(){if(!this.removed){Me(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},De[u].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ge(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(i){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var n=0,s=this.node.getNumberOfChars();s>n;n++){var r=this.node.getExtentOfChar(n);r.y<e.y&&(e.y=r.y),r.y+r.height-e.y>e.height&&(e.height=r.y+r.height-e.y),r.x+r.width-e.x>e.width&&(e.width=r.x+r.width-e.x)}}return t&&this.hide(),e},De[u].attr=function(e,i){if(this.removed)return this;if(null==e){var n={};for(var s in this.attrs)this.attrs[d](s)&&(n[s]=this.attrs[s]);return this._.rt.deg&&(n.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(n.scale=this.scale()),n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n}if(null==i&&t.is(e,R))return"translation"==e?$i.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==L&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==i&&t.is(e,G)){for(var r={},a=0,o=e.length;o>a;a++)r[e[a]]=this.attr(e[a]);return r}if(null!=i){var l={};l[e]=i}else null!=e&&t.is(e,"object")&&(l=e);for(var h in this.paper.customAttributes)if(this.paper.customAttributes[d](h)&&l[d](h)&&t.is(this.paper.customAttributes[h],"function")){var c=this.paper.customAttributes[h].apply(this,[][w](l[h]));this.attrs[h]=l[h];for(var u in c)c[d](u)&&(l[u]=c[u])}return Fe(this,l),this},De[u].toFront=function(){if(this.removed)return this;this.node.parentNode[v](this.node);var t=this.paper;return t.top!=this&&ze(this,t),this},De[u].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Pe(this,this.paper),this.paper),this)},De[u].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[v](this.node),Ae(this,t,this.paper),this},De[u].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),Oe(this,t,this.paper),this},De[u].blur=function(t){var i=this;if(0!==+t){var n=Be("filter"),s=Be("feGaussianBlur");i.attrs.blur=t,n.id=e(),Be(s,{stdDeviation:+t||1.5}),n.appendChild(s),i.paper.defs.appendChild(n),i._blur=n,Be(i.node,{filter:"url(#"+n.id+")"})}else i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")};var We=function(t,e,i,n){var s=Be("circle");t.canvas&&t.canvas[v](s);var r=new De(s,t);return r.attrs={cx:e,cy:i,r:n,fill:"none",stroke:"#000"},r.type="circle",Be(s,r.attrs),r},He=function(t,e,i,n,s,r){var a=Be("rect");t.canvas&&t.canvas[v](a);var o=new De(a,t);return o.attrs={x:e,y:i,width:n,height:s,r:r||0,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},o.type="rect",Be(a,o.attrs),o},Ke=function(t,e,i,n,s){var r=Be("ellipse");t.canvas&&t.canvas[v](r);var a=new De(r,t);return a.attrs={cx:e,cy:i,rx:n,ry:s,fill:"none",stroke:"#000"},a.type="ellipse",Be(r,a.attrs),a},qe=function(t,e,i,n,s,r){var a=Be("image");Be(a,{x:i,y:n,width:s,height:r,preserveAspectRatio:"none"}),a.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[v](a);var o=new De(a,t);return o.attrs={x:i,y:n,width:s,height:r,src:e},o.type="image",o},Ye=function(t,e,i,n){var s=Be("text");Be(s,{x:e,y:i,"text-anchor":"middle"}),t.canvas&&t.canvas[v](s);var r=new De(s,t);return r.attrs={x:e,y:i,"text-anchor":"middle",text:n,font:Q.font,stroke:"none",fill:"#000"},r.type="text",Fe(r,r.attrs),r},Xe=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas[Y]("width",this.width),this.canvas[Y]("height",this.height),this},Ue=function(){var e=Ee[y](0,arguments),i=e&&e.container,n=e.x,s=e.y,r=e.width,a=e.height;if(!i)throw new Error("SVG container not found.");var o=Be("svg");return n=n||0,s=s||0,r=r||512,a=a||342,Be(o,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:r,height:a}),1==i?(o.style.cssText="position:absolute;left:"+n+"px;top:"+s+"px",p.body[v](o)):i.firstChild?i.insertBefore(o,i.firstChild):i[v](o),i=new g,i.width=r,i.height=a,i.canvas=o,$e.call(i,i,t.fn),i.clear(),i};o.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=Be("desc"))[v](p.createTextNode("Created with Raphaël")),t[v](this.desc),t[v](this.defs=Be("defs"))},o.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=je(t)}}if(t.vml){var Je={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Ze=/([clmz]),?([^clmz]*)/gi,Qe=/ progid:\S+Blur\([^\)]+\)/g,ti=/-?[^,\s-]+/g,ei=1e3+_+1e3,ni=10,si={path:1,rect:1},ri=function(t){var e=/[ahqstv]/gi,i=we;if(k(t).match(e)&&(i=Se),e=/[clmz]/g,i==we&&!k(t).match(e)){var n=k(t)[ee](Ze,function(t,e,i){var n=[],s="m"==M.call(e),r=Je[e];return i[ee](ti,function(t){s&&2==n[$]&&(r+=n+Je["m"==e?"l":"L"],n=[]),n[D](q(t*ni))}),r+n});return n}var s,r,a=i(t);n=[];for(var o=0,l=a[$];l>o;o++){s=a[o],r=M.call(a[o][0]),"z"==r&&(r="x");for(var h=1,c=s[$];c>h;h++)r+=q(s[h]*ni)+(h!=c-1?",":b);n[D](r)}return n[E](_)};t[F]=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version},Ne=function(t,e){var i=ai("group");i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=e.coordsize,i.coordorigin=e.coordorigin;var n=ai("shape"),s=n.style;s.width=e.width+"px",s.height=e.height+"px",n.coordsize=ei,n.coordorigin=e.coordorigin,i[v](n);var r=new De(n,i,e),a={fill:"none",stroke:"#000"};return t&&(a.path=t),r.type="path",r.path=[],r.Path=b,Fe(r,a),e.canvas[v](i),r
},Fe=function(e,i){e.attrs=e.attrs||{};var s,r=e.node,a=e.attrs,o=r.style,h=(i.x!=a.x||i.y!=a.y||i.width!=a.width||i.height!=a.height||i.r!=a.r)&&"rect"==e.type,c=e;for(var u in i)i[d](u)&&(a[u]=i[u]);if(h&&(a.path=n(a.x,a.y,a.width,a.height,a.r),e.X=a.x,e.Y=a.y,e.W=a.width,e.H=a.height),i.href&&(r.href=i.href),i.title&&(r.title=i.title),i.target&&(r.target=i.target),i.cursor&&(o.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||h)&&(r.path=ri(a.path)),null!=i.rotation&&e.rotate(i.rotation,!0),i.translation&&(s=k(i.translation)[C](l),$i.call(e,s[0],s[1]),null!=e._.rt.cx&&(e._.rt.cx+=+s[0],e._.rt.cy+=+s[1],e.setBox(e.attrs,s[0],s[1]))),i.scale&&(s=k(i.scale)[C](l),e.scale(+s[0]||1,+s[1]||+s[0]||1,+s[2]||null,+s[3]||null)),"clip-rect"in i){var f=k(i["clip-rect"])[C](l);if(4==f[$]){f[2]=+f[2]+ +f[0],f[3]=+f[3]+ +f[1];var m=r.clipRect||p.createElement("div"),g=m.style,y=r.parentNode;g.clip=t.format("rect({1}px {2}px {3}px {0}px)",f),r.clipRect||(g.position="absolute",g.top=0,g.left=0,g.width=e.paper.width+"px",g.height=e.paper.height+"px",y.parentNode.insertBefore(m,y),m[v](y),r.clipRect=m)}i["clip-rect"]||r.clipRect&&(r.clipRect.style.clip=b)}if("image"==e.type&&i.src&&(r.src=i.src),"image"==e.type&&i.opacity&&(r.filterOpacity=J+".Alpha(opacity="+100*i.opacity+")",o.filter=(r.filterMatrix||b)+(r.filterOpacity||b)),i.font&&(o.font=i.font),i["font-family"]&&(o.fontFamily='"'+i["font-family"][C](",")[0][ee](/^['"]+|['"]+$/g,b)+'"'),i["font-size"]&&(o.fontSize=i["font-size"]),i["font-weight"]&&(o.fontWeight=i["font-weight"]),i["font-style"]&&(o.fontStyle=i["font-style"]),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){r=e.shape||r;var w=r.getElementsByTagName(L)&&r.getElementsByTagName(L)[0],x=!1;if(!w&&(x=w=ai(L)),"fill-opacity"in i||"opacity"in i){var _=((+a["fill-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+t.getRGB(i.fill).o+1||2)-1);_=A(P(_,0),1),w.opacity=_}if(i.fill&&(w.on=!0),(null==w.on||"none"==i.fill)&&(w.on=!1),w.on&&i.fill){var S=i.fill.match(V);S?(w.src=S[1],w.type="tile"):(w.color=t.getRGB(i.fill).hex,w.src=b,w.type="solid",t.getRGB(i.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=k(i.fill).charAt())&&Re(c,i.fill)&&(a.fill="none",a.gradient=i.fill))}x&&r[v](w);var T=r.getElementsByTagName("stroke")&&r.getElementsByTagName("stroke")[0],E=!1;!T&&(E=T=ai("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(T.on=!0),("none"==i.stroke||null==T.on||0==i.stroke||0==i["stroke-width"])&&(T.on=!1);var M=t.getRGB(i.stroke);T.on&&i.stroke&&(T.color=M.hex),_=((+a["stroke-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+M.o+1||2)-1);var z=.75*(X(i["stroke-width"])||1);if(_=A(P(_,0),1),null==i["stroke-width"]&&(z=a["stroke-width"]),i["stroke-width"]&&(T.weight=z),z&&1>z&&(_*=z)&&(T.weight=1),T.opacity=_,i["stroke-linejoin"]&&(T.joinstyle=i["stroke-linejoin"]||"miter"),T.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(T.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var O={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};T.dashstyle=O[d](i["stroke-dasharray"])?O[i["stroke-dasharray"]]:b}E&&r[v](T)}if("text"==c.type)switch(o=c.paper.span.style,a.font&&(o.font=a.font),a["font-family"]&&(o.fontFamily=a["font-family"]),a["font-size"]&&(o.fontSize=a["font-size"]),a["font-weight"]&&(o.fontWeight=a["font-weight"]),a["font-style"]&&(o.fontStyle=a["font-style"]),c.node.string&&(c.paper.span.innerHTML=k(c.node.string)[ee](/</g,"&#60;")[ee](/&/g,"&#38;")[ee](/\n/g,"<br>")),c.W=a.w=c.paper.span.offsetWidth,c.H=a.h=c.paper.span.offsetHeight,c.X=a.x,c.Y=a.y+q(c.H/2),a["text-anchor"]){case"start":c.node.style["v-text-align"]="left",c.bbx=q(c.W/2);break;case"end":c.node.style["v-text-align"]="right",c.bbx=-q(c.W/2);break;default:c.node.style["v-text-align"]="center"}},Re=function(t,e){t.attrs=t.attrs||{};var i,n=(t.attrs,"linear"),s=".5 .5";if(t.attrs.gradient=e,e=k(e)[ee](le,function(t,e,i){return n="radial",e&&i&&(e=X(e),i=X(i),j(e-.5,2)+j(i-.5,2)>.25&&(i=z.sqrt(.25-j(e-.5,2))*(2*(i>.5)-1)+.5),s=e+_+i),b}),e=e[C](/\s*\-\s*/),"linear"==n){var r=e.shift();if(r=-X(r),isNaN(r))return null}var a=Te(e);if(!a)return null;if(t=t.shape||t.node,i=t.getElementsByTagName(L)[0]||ai(L),!i.parentNode&&t.appendChild(i),a[$]){i.on=!0,i.method="none",i.color=a[0].color,i.color2=a[a[$]-1].color;for(var o=[],l=0,h=a[$];h>l;l++)a[l].offset&&o[D](a[l].offset+_+a[l].color);i.colors&&(i.colors.value=o[$]?o[E]():"0% "+i.color),"radial"==n?(i.type="gradientradial",i.focus="100%",i.focussize=s,i.focusposition=s):(i.type="gradient",i.angle=(270-r)%360)}return 1},De=function(e,i,n){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=i,this.paper=n,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},Ve=De[u],Ve.rotate=function(t,e,i){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][E](_):this._.rt.deg:(t=k(t)[C](l),t[$]-1&&(e=X(t[1]),i=X(t[2])),t=X(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==i&&(e=null),this._.rt.cx=e,this._.rt.cy=i,this.setBox(this.attrs,e,i),this.Group.style.rotation=this._.rt.deg,this)},Ve.setBox=function(t,e,i){if(this.removed)return this;var n=this.Group.style,s=this.shape&&this.shape.style||this.node.style;t=t||{};for(var r in t)t[d](r)&&(this.attrs[r]=t[r]);e=e||this._.rt.cx,i=i||this._.rt.cy;var a,o,l,h,c=this.attrs;switch(this.type){case"circle":a=c.cx-c.r,o=c.cy-c.r,l=h=2*c.r;break;case"ellipse":a=c.cx-c.rx,o=c.cy-c.ry,l=2*c.rx,h=2*c.ry;break;case"image":a=+c.x,o=+c.y,l=c.width||0,h=c.height||0;break;case"text":this.textpath.v=["m",q(c.x),", ",q(c.y-2),"l",q(c.x)+1,", ",q(c.y-2)][E](b),a=c.x-q(this.W/2),o=c.y-this.H/2,l=this.W,h=this.H;break;case"rect":case"path":if(this.attrs.path){var u=ge(this.attrs.path);a=u.x,o=u.y,l=u.width,h=u.height}else a=0,o=0,l=this.paper.width,h=this.paper.height;break;default:a=0,o=0,l=this.paper.width,h=this.paper.height}e=null==e?a+l/2:e,i=null==i?o+h/2:i;var p,f=e-this.paper.width/2,m=i-this.paper.height/2;n.left!=(p=f+"px")&&(n.left=p),n.top!=(p=m+"px")&&(n.top=p),this.X=si[d](this.type)?-f:a,this.Y=si[d](this.type)?-m:o,this.W=l,this.H=h,si[d](this.type)?(s.left!=(p=-f*ni+"px")&&(s.left=p),s.top!=(p=-m*ni+"px")&&(s.top=p)):"text"==this.type?(s.left!=(p=-f+"px")&&(s.left=p),s.top!=(p=-m+"px")&&(s.top=p)):(n.width!=(p=this.paper.width+"px")&&(n.width=p),n.height!=(p=this.paper.height+"px")&&(n.height=p),s.left!=(p=a-f+"px")&&(s.left=p),s.top!=(p=o-m+"px")&&(s.top=p),s.width!=(p=l+"px")&&(s.width=p),s.height!=(p=h+"px")&&(s.height=p))},Ve.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Ve.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Ve.getBBox=function(){return this.removed?this:si[d](this.type)?ge(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Ve.remove=function(){if(!this.removed){Me(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},Ve.attr=function(e,i){if(this.removed)return this;if(null==e){var n={};for(var s in this.attrs)this.attrs[d](s)&&(n[s]=this.attrs[s]);return this._.rt.deg&&(n.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(n.scale=this.scale()),n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n}if(null==i&&t.is(e,"string"))return"translation"==e?$i.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==L&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==i&&t.is(e,G)){var r,a={};for(s=0,r=e[$];r>s;s++)a[e[s]]=this.attr(e[s]);return a}var o;if(null!=i&&(o={},o[e]=i),null==i&&t.is(e,"object")&&(o=e),o){for(var l in this.paper.customAttributes)if(this.paper.customAttributes[d](l)&&o[d](l)&&t.is(this.paper.customAttributes[l],"function")){var h=this.paper.customAttributes[l].apply(this,[][w](o[l]));this.attrs[l]=o[l];for(var c in h)h[d](c)&&(o[c]=h[c])}o.text&&"text"==this.type&&(this.node.string=o.text),Fe(this,o),o.gradient&&({circle:1,ellipse:1}[d](this.type)||"r"!=k(o.gradient).charAt())&&Re(this,o.gradient),(!si[d](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Ve.toFront=function(){return!this.removed&&this.Group.parentNode[v](this.Group),this.paper.top!=this&&ze(this,this.paper),this},Ve.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Pe(this,this.paper)),this)},Ve.insertAfter=function(t){return this.removed?this:(t.constructor==Mi&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[v](this.Group),Ae(this,t,this.paper),this)},Ve.insertBefore=function(t){return this.removed?this:(t.constructor==Mi&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),Oe(this,t,this.paper),this)},Ve.blur=function(e){var i=this.node.runtimeStyle,n=i.filter;n=n.replace(Qe,b),0!==+e?(this.attrs.blur=e,i.filter=n+_+J+".Blur(pixelradius="+(+e||1.5)+")",i.margin=t.format("-{0}px 0 0 -{0}px",q(+e||1.5))):(i.filter=n,i.margin=0,delete this.attrs.blur)},We=function(t,e,i,n){var s=ai("group"),r=ai("oval");r.style,s.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",s.coordsize=ei,s.coordorigin=t.coordorigin,s[v](r);var a=new De(r,s,t);return a.type="circle",Fe(a,{stroke:"#000",fill:"none"}),a.attrs.cx=e,a.attrs.cy=i,a.attrs.r=n,a.setBox({x:e-n,y:i-n,width:2*n,height:2*n}),t.canvas[v](s),a},He=function(t,e,i,s,r,a){var o=n(e,i,s,r,a),l=t.path(o),h=l.attrs;return l.X=h.x=e,l.Y=h.y=i,l.W=h.width=s,l.H=h.height=r,h.r=a,h.path=o,l.type="rect",l},Ke=function(t,e,i,n,s){var r=ai("group"),a=ai("oval");a.style,r.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",r.coordsize=ei,r.coordorigin=t.coordorigin,r[v](a);var o=new De(a,r,t);return o.type="ellipse",Fe(o,{stroke:"#000"}),o.attrs.cx=e,o.attrs.cy=i,o.attrs.rx=n,o.attrs.ry=s,o.setBox({x:e-n,y:i-s,width:2*n,height:2*s}),t.canvas[v](r),o},qe=function(t,e,i,n,s,r){var a=ai("group"),o=ai("image");a.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",a.coordsize=ei,a.coordorigin=t.coordorigin,o.src=e,a[v](o);var l=new De(o,a,t);return l.type="image",l.attrs.src=e,l.attrs.x=i,l.attrs.y=n,l.attrs.w=s,l.attrs.h=r,l.setBox({x:i,y:n,width:s,height:r}),t.canvas[v](a),l},Ye=function(e,i,n,s){var r=ai("group"),a=ai("shape"),o=a.style,l=ai("path"),h=(l.style,ai("textpath"));r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=ei,r.coordorigin=e.coordorigin,l.v=t.format("m{0},{1}l{2},{1}",q(10*i),q(10*n),q(10*i)+1),l.textpathok=!0,o.width=e.width,o.height=e.height,h.string=k(s),h.on=!0,a[v](h),a[v](l),r[v](a);var c=new De(h,r,e);return c.shape=a,c.textpath=l,c.type="text",c.attrs.text=s,c.attrs.x=i,c.attrs.y=n,c.attrs.w=1,c.attrs.h=1,Fe(c,{font:Q.font,stroke:"none",fill:"#000"}),c.setBox(),e.canvas[v](r),c},Xe=function(t,e){var i=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),i.width=t,i.height=e,i.clip="rect(0 "+t+" "+e+" 0)",this};var ai;p.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!p.namespaces.rvml&&p.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ai=function(t){return p.createElement("<rvml:"+t+' class="rvml">')}}catch(oi){ai=function(t){return p.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Ue=function(){var e=Ee[y](0,arguments),i=e.container,n=e.height,s=e.width,r=e.x,a=e.y;if(!i)throw new Error("VML container not found.");var o=new g,l=o.canvas=p.createElement("div"),h=l.style;return r=r||0,a=a||0,s=s||512,n=n||342,s==+s&&(s+="px"),n==+n&&(n+="px"),o.width=1e3,o.height=1e3,o.coordsize=1e3*ni+_+1e3*ni,o.coordorigin="0 0",o.span=p.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",l[v](o.span),h.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",s,n),1==i?(p.body[v](l),h.left=r+"px",h.top=a+"px",h.position="absolute"):i.firstChild?i.insertBefore(l,i.firstChild):i[v](l),$e.call(o,o,t.fn),o},o.clear=function(){this.canvas.innerHTML=b,this.span=p.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[v](this.span),this.bottom=this.top=null},o.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=je(t);return!0}}var li=navigator.userAgent.match(/Version\/(.*?)\s/);o.safari="Apple Computer, Inc."==navigator.vendor&&(li&&li[1]<4||"iP"==navigator.platform.slice(0,2))?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});f.setTimeout(function(){t.remove()})}:function(){};for(var hi=function(){this.returnValue=!1},ci=function(){return this.originalEvent.preventDefault()},ui=function(){this.cancelBubble=!0},di=function(){return this.originalEvent.stopPropagation()},pi=function(){return p.addEventListener?function(t,e,i,n){var s=x&&T[e]?T[e]:e,r=function(s){if(x&&T[d](e))for(var r=0,a=s.targetTouches&&s.targetTouches.length;a>r;r++)if(s.targetTouches[r].target==t){var o=s;s=s.targetTouches[r],s.originalEvent=o,s.preventDefault=ci,s.stopPropagation=di;break}return i.call(n,s)};return t.addEventListener(s,r,!1),function(){return t.removeEventListener(s,r,!1),!0}}:p.attachEvent?function(t,e,i,n){var s=function(t){return t=t||f.event,t.preventDefault=t.preventDefault||hi,t.stopPropagation=t.stopPropagation||ui,i.call(n,t)};t.attachEvent("on"+e,s);var r=function(){return t.detachEvent("on"+e,s),!0};return r}:void 0}(),fi=[],mi=function(t){for(var e,i=t.clientX,n=t.clientY,s=p.documentElement.scrollTop||p.body.scrollTop,r=p.documentElement.scrollLeft||p.body.scrollLeft,a=fi.length;a--;){if(e=fi[a],x){for(var o,l=t.touches.length;l--;)if(o=t.touches[l],o.identifier==e.el._drag.id){i=o.clientX,n=o.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();i+=r,n+=s,e.move&&e.move.call(e.move_scope||e.el,i-e.el._drag.x,n-e.el._drag.y,i,n,t)}},gi=function(e){t.unmousemove(mi).unmouseup(gi);for(var i,n=fi.length;n--;)i=fi[n],i.el._drag={},i.end&&i.end.call(i.end_scope||i.start_scope||i.move_scope||i.el,e);fi=[]},vi=S[$];vi--;)!function(e){t[e]=De[u][e]=function(i,n){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:e,f:i,unbind:pi(this.shape||this.node||p,e,i,n||this)})),this},t["un"+e]=De[u]["un"+e]=function(t){for(var i=this.events,n=i[$];n--;)if(i[n].name==e&&i[n].f==t)return i[n].unbind(),i.splice(n,1),!i.length&&delete this.events,this;return this}}(S[vi]);Ve.hover=function(t,e,i,n){return this.mouseover(t,i).mouseout(e,n||i)},Ve.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},Ve.drag=function(e,i,n,s,r,a){return this._drag={},this.mousedown(function(o){(o.originalEvent||o).preventDefault();var l=p.documentElement.scrollTop||p.body.scrollTop,h=p.documentElement.scrollLeft||p.body.scrollLeft;this._drag.x=o.clientX+h,this._drag.y=o.clientY+l,this._drag.id=o.identifier,i&&i.call(r||s||this,o.clientX+h,o.clientY+l,o),!fi.length&&t.mousemove(mi).mouseup(gi),fi.push({el:this,move:e,end:n,move_scope:s,start_scope:r,end_scope:a})}),this},Ve.undrag=function(e,i,n){for(var s=fi.length;s--;)fi[s].el==this&&fi[s].move==e&&fi[s].end==n&&fi.splice(s++,1);!fi.length&&t.unmousemove(mi).unmouseup(gi)},o.circle=function(t,e,i){return We(this,t||0,e||0,i||0)},o.rect=function(t,e,i,n,s){return He(this,t||0,e||0,i||0,n||0,s||0)},o.ellipse=function(t,e,i,n){return Ke(this,t||0,e||0,i||0,n||0)},o.path=function(e){return e&&!t.is(e,R)&&!t.is(e[0],G)&&(e+=b),Ne(t.format[y](t,arguments),this)},o.image=function(t,e,i,n,s){return qe(this,t||"about:blank",e||0,i||0,n||0,s||0)},o.text=function(t,e,i){return Ye(this,t||0,e||0,k(i))},o.set=function(t){return arguments[$]>1&&(t=Array[u].splice.call(arguments,0,arguments[$])),new Mi(t)},o.setSize=Xe,o.top=o.bottom=null,o.raphael=t,Ve.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,this.attrs.scale="1 1",void 0)},Ve.scale=function(t,e,i,n){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:s};e=e||t,!+e&&(e=t);var r,a,o=this.attrs;if(0!=t){var l=this.getBBox(),h=l.x+l.width/2,c=l.y+l.height/2,u=O(t/this._.sx),d=O(e/this._.sy);i=+i||0==i?i:h,n=+n||0==n?n:c;var p=this._.sx>0,f=this._.sy>0,m=~~(t/O(t)),g=~~(e/O(e)),v=u*m,y=d*g,x=this.node.style,k=i+O(h-i)*v*(h>i==p?1:-1),C=n+O(c-n)*y*(c>n==f?1:-1),S=t*m>e*g?d:u;switch(this.type){case"rect":case"image":var T=o.width*u,M=o.height*d;this.attr({height:M,r:o.r*S,width:T,x:k-T/2,y:C-M/2});break;case"circle":case"ellipse":this.attr({rx:o.rx*u,ry:o.ry*d,r:o.r*S,cx:k,cy:C});break;case"text":this.attr({x:k,y:C});break;case"path":for(var z=ye(o.path),P=!0,A=p?v:u,j=f?y:d,B=0,N=z[$];N>B;B++){var R=z[B],G=Z.call(R[0]);if("M"!=G||!P)if(P=!1,"A"==G)R[z[B][$]-2]*=A,R[z[B][$]-1]*=j,R[1]*=u,R[2]*=d,R[5]=+(m+g?!!+R[5]:!+R[5]);else if("H"==G)for(var F=1,L=R[$];L>F;F++)R[F]*=A;else if("V"==G)for(F=1,L=R[$];L>F;F++)R[F]*=j;else for(F=1,L=R[$];L>F;F++)R[F]*=F%2?A:j}var I=ge(z);r=k-I.x-I.width/2,a=C-I.y-I.height/2,z[0][1]+=r,z[0][2]+=a,this.attr({path:z})}this.type in{text:1,image:1}&&(1!=m||1!=g)?this.transformations?(this.transformations[2]="scale("[w](m,",",g,")"),this.node[Y]("transform",this.transformations[E](_)),r=-1==m?-o.x-(T||0):o.x,a=-1==g?-o.y-(M||0):o.y,this.attr({x:r,y:a}),o.fx=m-1,o.fy=g-1):(this.node.filterMatrix=J+".Matrix(M11="[w](m,", M12=0, M21=0, M22=",g,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),x.filter=(this.node.filterMatrix||b)+(this.node.filterOpacity||b)):this.transformations?(this.transformations[2]=b,this.node[Y]("transform",this.transformations[E](_)),o.fx=0,o.fy=0):(this.node.filterMatrix=b,x.filter=(this.node.filterMatrix||b)+(this.node.filterOpacity||b)),o.scale=[t,e,i,n][E](_),this._.sx=t,this._.sy=e}return this},Ve.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var yi={},wi=function(e,i,n,s,r,a,o,l,h){var c,u,d=0,p=100,f=[e,i,n,s,r,a,o,l].join(),m=yi[f];if(!m&&(yi[f]=m={data:[]}),m.timer&&clearTimeout(m.timer),m.timer=setTimeout(function(){delete yi[f]},2e3),null!=h){var g=wi(e,i,n,s,r,a,o,l);p=10*~~g}for(var v=0;p+1>v;v++){if(m.data[h]>v?u=m.data[v*p]:(u=t.findDotsAtSegment(e,i,n,s,r,a,o,l,v/p),m.data[v]=u),v&&(d+=j(j(c.x-u.x,2)+j(c.y-u.y,2),.5)),null!=h&&d>=h)return u;c=u}return null==h?d:void 0},xi=function(e,i){return function(n,s,r){n=Se(n);for(var a,o,l,h,c,u="",d={},p=0,f=0,m=n.length;m>f;f++){if(l=n[f],"M"==l[0])a=+l[1],o=+l[2];else{if(h=wi(a,o,l[1],l[2],l[3],l[4],l[5],l[6]),p+h>s){if(i&&!d.start){if(c=wi(a,o,l[1],l[2],l[3],l[4],l[5],l[6],s-p),u+=["C",c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y],r)return u;d.start=u,u=["M",c.x,c.y+"C",c.n.x,c.n.y,c.end.x,c.end.y,l[5],l[6]][E](),p+=h,a=+l[5],o=+l[6];continue}if(!e&&!i)return c=wi(a,o,l[1],l[2],l[3],l[4],l[5],l[6],s-p),{x:c.x,y:c.y,alpha:c.alpha}}p+=h,a=+l[5],o=+l[6]}u+=l}return d.end=u,c=e?p:i?d:t.findDotsAtSegment(a,o,l[1],l[2],l[3],l[4],l[5],l[6],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},bi=xi(1),_i=xi(),ki=xi(0,1);Ve.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():bi(this.attrs.path):void 0},Ve.getPointAtLength=function(t){return"path"==this.type?_i(this.attrs.path,t):void 0},Ve.getSubpath=function(t,e){if("path"==this.type){if(O(this.getTotalLength()-e)<"1e-6")return ki(this.attrs.path,t).end;var i=ki(this.attrs.path,e,1);return t?ki(i,t).end:i}},t.easing_formulas={linear:function(t){return t},"<":function(t){return j(t,3)},">":function(t){return j(t-1,3)+1},"<>":function(t){return t=2*t,1>t?j(t,3)/2:(t-=2,(j(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,i=e/4;return j(2,-10*t)*z.sin((t-i)*2*B/e)+1},bounce:function(t){var e,i=7.5625,n=2.75;return 1/n>t?e=i*t*t:2/n>t?(t-=1.5/n,e=i*t*t+.75):2.5/n>t?(t-=2.25/n,e=i*t*t+.9375):(t-=2.625/n,e=i*t*t+.984375),e}};var Ci=[],Si=function(){for(var e=+new Date,i=0;i<Ci[$];i++){var n=Ci[i];if(!n.stop&&!n.el.removed){var s,r=e-n.start,a=n.ms,o=n.easing,l=n.from,h=n.diff,c=n.to,u=n.t,p=n.el,f={};if(a>r){var m=o(r/a);for(var g in l)if(l[d](g)){switch(te[g]){case"along":s=m*a*h[g],c.back&&(s=c.len-s);var v=_i(c[g],s);p.translate(h.sx-h.x||0,h.sy-h.y||0),h.x=v.x,h.y=v.y,p.translate(v.x-h.sx,v.y-h.sy),c.rot&&p.rotate(h.r+v.alpha,v.x,v.y);break;case N:s=+l[g]+m*a*h[g];break;case"colour":s="rgb("+[Ei(q(l[g].r+m*a*h[g].r)),Ei(q(l[g].g+m*a*h[g].g)),Ei(q(l[g].b+m*a*h[g].b))][E](",")+")";break;case"path":s=[];for(var y=0,w=l[g][$];w>y;y++){s[y]=[l[g][y][0]];for(var x=1,k=l[g][y][$];k>x;x++)s[y][x]=+l[g][y][x]+m*a*h[g][y][x];s[y]=s[y][E](_)}s=s[E](_);break;case"csv":switch(g){case"translation":var C=m*a*h[g][0]-u.x,S=m*a*h[g][1]-u.y;u.x+=C,u.y+=S,s=C+_+S;break;case"rotation":s=+l[g][0]+m*a*h[g][0],l[g][1]&&(s+=","+l[g][1]+","+l[g][2]);break;case"scale":s=[+l[g][0]+m*a*h[g][0],+l[g][1]+m*a*h[g][1],2 in c[g]?c[g][2]:b,3 in c[g]?c[g][3]:b][E](_);break;case"clip-rect":for(s=[],y=4;y--;)s[y]=+l[g][y]+m*a*h[g][y]}break;default:var T=[].concat(l[g]);for(s=[],y=p.paper.customAttributes[g].length;y--;)s[y]=+T[y]+m*a*h[g][y]}f[g]=s}p.attr(f),p._run&&p._run.call(p)}else c.along&&(v=_i(c.along,c.len*!c.back),p.translate(h.sx-(h.x||0)+v.x-h.sx,h.sy-(h.y||0)+v.y-h.sy),c.rot&&p.rotate(h.r+v.alpha,v.x,v.y)),(u.x||u.y)&&p.translate(-u.x,-u.y),c.scale&&(c.scale+=b),p.attr(c),Ci.splice(i--,1)}}t.svg&&p&&p.paper&&p.paper.safari(),Ci[$]&&setTimeout(Si)},Ti=function(e,i,n,s,r){var a=n-s;i.timeouts.push(setTimeout(function(){t.is(r,"function")&&r.call(i),i.animate(e,a,e.easing)},s))},Ei=function(t){return P(A(t,255),0)},$i=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:s};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var i=ye(this.attrs.path);i[0][1]+=+t,i[0][2]+=+e,this.attr({path:i})}return this};Ve.animateWith=function(t,e,i,n,s){for(var r=0,a=Ci.length;a>r;r++)Ci[r].el.id==t.id&&(e.start=Ci[r].start);return this.animate(e,i,n,s)},Ve.animateAlong=r(),Ve.animateAlongBack=r(1),Ve.onAnimation=function(t){return this._run=t||0,this},Ve.animate=function(e,i,n,s){var r=this;if(r.timeouts=r.timeouts||[],(t.is(n,"function")||!n)&&(s=n||null),r.removed)return s&&s.call(r),r;var o={},h={},c=!1,u={};for(var p in e)if(e[d](p)&&(te[d](p)||r.paper.customAttributes[d](p)))switch(c=!0,o[p]=r.attr(p),null==o[p]&&(o[p]=Q[p]),h[p]=e[p],te[p]){case"along":var f=bi(e[p]),m=_i(e[p],f*!!e.back),g=r.getBBox();u[p]=f/i,u.tx=g.x,u.ty=g.y,u.sx=m.x,u.sy=m.y,h.rot=e.rot,h.back=e.back,h.len=f,e.rot&&(u.r=X(r.rotate())||0);break;case N:u[p]=(h[p]-o[p])/i;break;case"colour":o[p]=t.getRGB(o[p]);var v=t.getRGB(h[p]);u[p]={r:(v.r-o[p].r)/i,g:(v.g-o[p].g)/i,b:(v.b-o[p].b)/i};break;case"path":var y=Se(o[p],h[p]);o[p]=y[0];var w=y[1];u[p]=[];for(var x=0,b=o[p][$];b>x;x++){u[p][x]=[0];for(var _=1,S=o[p][x][$];S>_;_++)u[p][x][_]=(w[x][_]-o[p][x][_])/i}break;case"csv":var T=k(e[p])[C](l),E=k(o[p])[C](l);switch(p){case"translation":o[p]=[0,0],u[p]=[T[0]/i,T[1]/i];break;case"rotation":o[p]=E[1]==T[1]&&E[2]==T[2]?E:[0,T[1],T[2]],u[p]=[(T[0]-o[p][0])/i,0,0];break;case"scale":e[p]=T,o[p]=k(o[p])[C](l),u[p]=[(T[0]-o[p][0])/i,(T[1]-o[p][1])/i,0,0];break;case"clip-rect":for(o[p]=k(o[p])[C](l),u[p]=[],x=4;x--;)u[p][x]=(T[x]-o[p][x])/i}h[p]=T;break;default:for(T=[].concat(e[p]),E=[].concat(o[p]),u[p]=[],x=r.paper.customAttributes[p][$];x--;)u[p][x]=((T[x]||0)-(E[x]||0))/i}if(c){var M=t.easing_formulas[n];if(!M)if(M=k(n).match(K),M&&5==M[$]){var z=M;M=function(t){return a(t,+z[1],+z[2],+z[3],+z[4],i)}}else M=function(t){return t};Ci.push({start:e.start||+new Date,ms:i,easing:M,from:o,diff:u,to:h,el:r,t:{x:0,y:0}}),t.is(s,"function")&&(r._ac=setTimeout(function(){s.call(r)},i)),1==Ci[$]&&setTimeout(Si)}else{var P,A=[];for(var O in e)e[d](O)&&ie.test(O)&&(p={value:e[O]},"from"==O&&(O=0),"to"==O&&(O=100),p.key=U(O,10),A.push(p));for(A.sort(he),A[0].key&&A.unshift({key:0,value:r.attrs}),x=0,b=A[$];b>x;x++)Ti(A[x].value,r,i/100*A[x].key,i/100*(A[x-1]&&A[x-1].key||0),A[x-1]&&A[x-1].value.callback);P=A[A[$]-1].value.callback,P&&r.timeouts.push(setTimeout(function(){P.call(r)},i))}return this},Ve.stop=function(){for(var t=0;t<Ci.length;t++)Ci[t].el.id==this.id&&Ci.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;ii>t;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Ve.translate=function(t,e){return this.attr({translation:t+" "+e})},Ve[F]=function(){return"Raphaël’s object"},t.ae=Ci;var Mi=function(t){if(this.items=[],this[$]=0,this.type="set",t)for(var e=0,i=t[$];i>e;e++)!t[e]||t[e].constructor!=De&&t[e].constructor!=Mi||(this[this.items[$]]=this.items[this.items[$]]=t[e],this[$]++)};Mi[u][D]=function(){for(var t,e,i=0,n=arguments[$];n>i;i++)t=arguments[i],!t||t.constructor!=De&&t.constructor!=Mi||(e=this.items[$],this[e]=this.items[e]=t,this[$]++);return this},Mi[u].pop=function(){return delete this[this[$]--],this.items.pop()};for(var zi in Ve)Ve[d](zi)&&(Mi[u][zi]=function(t){return function(){for(var e=0,i=this.items[$];i>e;e++)this.items[e][t][y](this.items[e],arguments);return this}}(zi));Mi[u].attr=function(e,i){if(e&&t.is(e,G)&&t.is(e[0],"object"))for(var n=0,s=e[$];s>n;n++)this.items[n].attr(e[n]);else for(var r=0,a=this.items[$];a>r;r++)this.items[r].attr(e,i);return this},Mi[u].animate=function(e,i,n,s){(t.is(n,"function")||!n)&&(s=n||null);var r,a,o=this.items[$],l=o,h=this;for(s&&(a=function(){!--o&&s.call(h)}),n=t.is(n,R)?n:a,r=this.items[--l].animate(e,i,n,a);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(r,e,i,n,a);return this},Mi[u].insertAfter=function(t){for(var e=this.items[$];e--;)this.items[e].insertAfter(t);return this},Mi[u].getBBox=function(){for(var t=[],e=[],i=[],n=[],s=this.items[$];s--;){var r=this.items[s].getBBox();t[D](r.x),e[D](r.y),i[D](r.x+r.width),n[D](r.y+r.height)}return t=A[y](0,t),e=A[y](0,e),{x:t,y:e,width:P[y](0,i)-t,height:P[y](0,n)-e}},Mi[u].clone=function(t){t=new Mi;for(var e=0,i=this.items[$];i>e;e++)t[D](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var n in t.face)t.face[d](n)&&(e.face[n]=t.face[n]);if(this.fonts[i]?this.fonts[i][D](e):this.fonts[i]=[e],!t.svg){e.face["units-per-em"]=U(t.face["units-per-em"],10);for(var s in t.glyphs)if(t.glyphs[d](s)){var r=t.glyphs[s];if(e.glyphs[s]={w:r.w,k:{},d:r.d&&"M"+r.d[ee](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},r.k)for(var a in r.k)r[d](a)&&(e.glyphs[s].k[a]=r.k[a])}}return t},o.getFont=function(e,i,n,s){if(s=s||"normal",n=n||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,t.fonts){var r=t.fonts[e];if(!r){var a=new RegExp("(^|\\s)"+e[ee](/[^\w\d\s+!~.:_-]/g,b)+"(\\s|$)","i");for(var o in t.fonts)if(t.fonts[d](o)&&a.test(o)){r=t.fonts[o];break}}var l;if(r)for(var h=0,c=r[$];c>h&&(l=r[h],l.face["font-weight"]!=i||l.face["font-style"]!=n&&l.face["font-style"]||l.face["font-stretch"]!=s);h++);return l}},o.print=function(e,i,n,s,r,a,o){a=a||"middle",o=P(A(o||0,1),-1);var h,c=this.set(),u=k(n)[C](b),d=0;if(t.is(s,n)&&(s=this.getFont(s)),s){h=(r||16)/s.face["units-per-em"];for(var p=s.face.bbox.split(l),f=+p[0],m=+p[1]+("baseline"==a?p[3]-p[1]+ +s.face.descent:(p[3]-p[1])/2),g=0,v=u[$];v>g;g++){var y=g&&s.glyphs[u[g-1]]||{},w=s.glyphs[u[g]];d+=g?(y.w||s.w)+(y.k&&y.k[u[g]]||0)+s.w*o:0,w&&w.d&&c[D](this.path(w.d).attr({fill:"#000",stroke:"none",translation:[d,0]}))}c.scale(h,h,f,m).translate(e-f,i-m)}return c},t.format=function(e,i){var n=t.is(i,G)?[0][w](i):arguments;return e&&t.is(e,R)&&n[$]-1&&(e=e[ee](c,function(t,e){return null==n[++e]?b:n[e]})),e||b},t.ninja=function(){return m.was?f.Raphael=m.is:delete Raphael,t},t.el=Ve,t.st=Mi[u],m.was?f.Raphael=t:Raphael=t}(),function(t,e,i,n,s,r){function a(t,e){var i=typeof t[e];return"function"==i||!("object"!=i||!t[e])||"unknown"==i}function o(t,e){return!("object"!=typeof t[e]||!t[e])}function l(t){return"[object Array]"===Object.prototype.toString.call(t)}function h(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return $=Array.prototype.slice.call(t.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),M=parseInt($[0],10)>9&&parseInt($[1],10)>0,t=null,!0}catch(e){return!1}}function c(){if(!W){W=!0;for(var t=0;t<H.length;t++)H[t]();H.length=0}}function u(t,e){return W?(t.call(e),void 0):(H.push(function(){t.call(e)}),void 0)}function d(){var t=parent;if(""!==G)for(var e=0,i=G.split(".");e<i.length;e++)t=t[i[e]];return t.easyXDM}function p(e){return t.easyXDM=L,G=e,G&&(I="easyXDM_"+G.replace(".","_")+"_"),F}function f(t){return t.match(B)[3]}function m(t){return t.match(B)[4]||""}function g(t){var e=t.toLowerCase().match(B),i=e[2],n=e[3],s=e[4]||"";return("http:"==i&&":80"==s||"https:"==i&&":443"==s)&&(s=""),i+"//"+n+s}function v(t){if(t=t.replace(R,"$1/"),!t.match(/^(http||https):\/\//)){var e="/"===t.substring(0,1)?"":i.pathname;"/"!==e.substring(e.length-1)&&(e=e.substring(0,e.lastIndexOf("/")+1)),t=i.protocol+"//"+i.host+e+t}for(;N.test(t);)t=t.replace(N,"");return t}function y(t,e){var i="",n=t.indexOf("#");-1!==n&&(i=t.substring(n),t=t.substring(0,n));var s=[];for(var a in e)e.hasOwnProperty(a)&&s.push(a+"="+r(e[a]));return t+(D?"#":-1==t.indexOf("?")?"?":"&")+s.join("&")+i}function w(t){return"undefined"==typeof t}function x(t,e,i){var n;for(var s in e)e.hasOwnProperty(s)&&(s in t?(n=e[s],"object"==typeof n?x(t[s],n,i):i||(t[s]=e[s])):t[s]=e[s]);return t}function b(){var t=e.body.appendChild(e.createElement("form")),i=t.appendChild(e.createElement("input"));i.name=I+"TEST"+O,E=i!==t.elements[i.name],e.body.removeChild(t)}function _(t){w(E)&&b();var i;E?i=e.createElement('<iframe name="'+t.props.name+'"/>'):(i=e.createElement("IFRAME"),i.name=t.props.name),i.id=i.name=t.props.name,delete t.props.name,t.onLoad&&z(i,"load",t.onLoad),"string"==typeof t.container&&(t.container=e.getElementById(t.container)),t.container||(x(i.style,{position:"absolute",top:"-2000px"}),t.container=e.body);var n=t.props.src;return delete t.props.src,x(i,t.props),i.border=i.frameBorder=0,i.allowTransparency=!0,t.container.appendChild(i),i.src=n,t.props.src=n,i}function k(t,e){"string"==typeof t&&(t=[t]);for(var i,n=t.length;n--;)if(i=t[n],i=new RegExp("^"==i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(e))return!0;return!1}function C(n){var s,r=n.protocol;if(n.isHost=n.isHost||w(q.xdm_p),D=n.hash||!1,n.props||(n.props={}),n.isHost)n.remote=v(n.remote),n.channel=n.channel||"default"+O++,n.secret=Math.random().toString(16).substring(2),w(r)&&(g(i.href)==g(n.remote)?r="4":a(t,"postMessage")||a(e,"postMessage")?r="1":n.swf&&a(t,"ActiveXObject")&&h()?r="6":"Gecko"===navigator.product&&"frameElement"in t&&-1==navigator.userAgent.indexOf("WebKit")?r="5":n.remoteHelper?(n.remoteHelper=v(n.remoteHelper),r="2"):r="0");
else if(n.channel=q.xdm_c,n.secret=q.xdm_s,n.remote=q.xdm_e,r=q.xdm_p,n.acl&&!k(n.acl,n.remote))throw new Error("Access denied for "+n.remote);switch(n.protocol=r,r){case"0":if(x(n,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),n.isHost){if(!n.local){for(var o,l=i.protocol+"//"+i.host,c=e.body.getElementsByTagName("img"),u=c.length;u--;)if(o=c[u],o.src.substring(0,l.length)===l){n.local=o.src;break}n.local||(n.local=t)}var d={xdm_c:n.channel,xdm_p:0};n.local===t?(n.usePolling=!0,n.useParent=!0,n.local=i.protocol+"//"+i.host+i.pathname+i.search,d.xdm_e=n.local,d.xdm_pa=1):d.xdm_e=v(n.local),n.container&&(n.useResize=!1,d.xdm_po=1),n.remote=y(n.remote,d)}else x(n,{channel:q.xdm_c,remote:q.xdm_e,useParent:!w(q.xdm_pa),usePolling:!w(q.xdm_po),useResize:n.useParent?!1:n.useResize});s=[new F.stack.HashTransport(n),new F.stack.ReliableBehavior({}),new F.stack.QueueBehavior({encode:!0,maxLength:4e3-n.remote.length}),new F.stack.VerifyBehavior({initiate:n.isHost})];break;case"1":s=[new F.stack.PostMessageTransport(n)];break;case"2":s=[new F.stack.NameTransport(n),new F.stack.QueueBehavior,new F.stack.VerifyBehavior({initiate:n.isHost})];break;case"3":s=[new F.stack.NixTransport(n)];break;case"4":s=[new F.stack.SameOriginTransport(n)];break;case"5":s=[new F.stack.FrameElementTransport(n)];break;case"6":$||h(),s=[new F.stack.FlashTransport(n)]}return s.push(new F.stack.QueueBehavior({lazy:n.lazy,remove:!0})),s}function S(t){for(var e,i={incoming:function(t,e){this.up.incoming(t,e)},outgoing:function(t,e){this.down.outgoing(t,e)},callback:function(t){this.up.callback(t)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},n=0,s=t.length;s>n;n++)e=t[n],x(e,i,!0),0!==n&&(e.down=t[n-1]),n!==s-1&&(e.up=t[n+1]);return e}function T(t){t.up.down=t.down,t.down.up=t.up,t.up=t.down=null}var E,$,M,z,P,A=this,O=Math.floor(1e4*Math.random()),j=Function.prototype,B=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,N=/[\-\w]+\/\.\.\//,R=/([^:])\/\//g,G="",F={},L=t.easyXDM,I="easyXDM_",D=!1;if(a(t,"addEventListener"))z=function(t,e,i){t.addEventListener(e,i,!1)},P=function(t,e,i){t.removeEventListener(e,i,!1)};else{if(!a(t,"attachEvent"))throw new Error("Browser not supported");z=function(t,e,i){t.attachEvent("on"+e,i)},P=function(t,e,i){t.detachEvent("on"+e,i)}}var V,W=!1,H=[];if("readyState"in e?(V=e.readyState,W="complete"==V||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==V||"interactive"==V)):W=!!e.body,!W){if(a(t,"addEventListener"))z(e,"DOMContentLoaded",c);else if(z(e,"readystatechange",function(){"complete"==e.readyState&&c()}),e.documentElement.doScroll&&t===top){var K=function(){if(!W){try{e.documentElement.doScroll("left")}catch(t){return n(K,1),void 0}c()}};K()}z(t,"load",c)}var q=function(t){t=t.substring(1).split("&");for(var e,i={},n=t.length;n--;)e=t[n].split("="),i[e[0]]=s(e[1]);return i}(/xdm_e=/.test(i.search)?i.search:i.hash),Y=function(){var t={},e={a:[1,2,3]},i='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(e).replace(/\s/g,"")===i?JSON:(Object.toJSON&&Object.toJSON(e).replace(/\s/g,"")===i&&(t.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(e=i.evalJSON(),e.a&&3===e.a.length&&3===e.a[2]&&(t.parse=function(t){return t.evalJSON()})),t.stringify&&t.parse?(Y=function(){return t},t):null)};x(F,{version:"2.4.15.118",query:q,stack:{},apply:x,getJSONObject:Y,whenReady:u,noConflict:p}),F.DomHelper={on:z,un:P,requiresJSON:function(i){o(t,"JSON")||e.write('<script type="text/javascript" src="'+i+'"><'+"/script>")}},function(){var t={};F.Fn={set:function(e,i){t[e]=i},get:function(e,i){var n=t[e];return i&&delete t[e],n}}}(),F.Socket=function(t){var e=S(C(t).concat([{incoming:function(e,i){t.onMessage(e,i)},callback:function(e){t.onReady&&t.onReady(e)}}])),i=g(t.remote);this.origin=g(t.remote),this.destroy=function(){e.destroy()},this.postMessage=function(t){e.outgoing(t,i)},e.init()},F.Rpc=function(t,e){if(e.local)for(var i in e.local)if(e.local.hasOwnProperty(i)){var n=e.local[i];"function"==typeof n&&(e.local[i]={method:n})}var s=S(C(t).concat([new F.stack.RpcBehavior(this,e),{callback:function(e){t.onReady&&t.onReady(e)}}]));this.origin=g(t.remote),this.destroy=function(){s.destroy()},s.init()},F.stack.SameOriginTransport=function(t){var e,s,r,a;return e={outgoing:function(t,e,i){r(t),i&&i()},destroy:function(){s&&(s.parentNode.removeChild(s),s=null)},onDOMReady:function(){a=g(t.remote),t.isHost?(x(t.props,{src:y(t.remote,{xdm_e:i.protocol+"//"+i.host+i.pathname,xdm_c:t.channel,xdm_p:4}),name:I+t.channel+"_provider"}),s=_(t),F.Fn.set(t.channel,function(t){return r=t,n(function(){e.up.callback(!0)},0),function(t){e.up.incoming(t,a)}})):(r=d().Fn.get(t.channel,!0)(function(t){e.up.incoming(t,a)}),n(function(){e.up.callback(!0)},0))},init:function(){u(e.onDOMReady,e)}}},F.stack.FlashTransport=function(t){function s(t){n(function(){a.up.incoming(t,l)},0)}function r(i){var n=t.swf+"?host="+t.isHost,s="easyXDM_swf_"+Math.floor(1e4*Math.random());F.Fn.set("flash_loaded"+i.replace(/[\-.]/g,"_"),function(){F.stack.FlashTransport[i].swf=h=c.firstChild;for(var t=F.stack.FlashTransport[i].queue,e=0;e<t.length;e++)t[e]();t.length=0}),t.swfContainer?c="string"==typeof t.swfContainer?e.getElementById(t.swfContainer):t.swfContainer:(c=e.createElement("div"),x(c.style,M&&t.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),e.body.appendChild(c));var r="callback=flash_loaded"+i.replace(/[\-.]/g,"_")+"&proto="+A.location.protocol+"&domain="+f(A.location.href)+"&port="+m(A.location.href)+"&ns="+G;c.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+s+"' data='"+n+"'>"+"<param name='allowScriptAccess' value='always'></param>"+"<param name='wmode' value='transparent'>"+"<param name='movie' value='"+n+"'></param>"+"<param name='flashvars' value='"+r+"'></param>"+"<embed type='application/x-shockwave-flash' FlashVars='"+r+"' allowScriptAccess='always' wmode='transparent' src='"+n+"' height='1' width='1'></embed>"+"</object>"}var a,o,l,h,c;return a={outgoing:function(e,i,n){h.postMessage(t.channel,e.toString()),n&&n()},destroy:function(){try{h.destroyChannel(t.channel)}catch(e){}h=null,o&&(o.parentNode.removeChild(o),o=null)},onDOMReady:function(){l=t.remote,F.Fn.set("flash_"+t.channel+"_init",function(){n(function(){a.up.callback(!0)})}),F.Fn.set("flash_"+t.channel+"_onMessage",s),t.swf=v(t.swf);var e=f(t.swf),c=function(){F.stack.FlashTransport[e].init=!0,h=F.stack.FlashTransport[e].swf,h.createChannel(t.channel,t.secret,g(t.remote),t.isHost),t.isHost&&(M&&t.swfNoThrottle&&x(t.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),x(t.props,{src:y(t.remote,{xdm_e:g(i.href),xdm_c:t.channel,xdm_p:6,xdm_s:t.secret}),name:I+t.channel+"_provider"}),o=_(t))};F.stack.FlashTransport[e]&&F.stack.FlashTransport[e].init?c():F.stack.FlashTransport[e]?F.stack.FlashTransport[e].queue.push(c):(F.stack.FlashTransport[e]={queue:[c]},r(e))},init:function(){u(a.onDOMReady,a)}}},F.stack.PostMessageTransport=function(e){function s(t){if(t.origin)return g(t.origin);if(t.uri)return g(t.uri);if(t.domain)return i.protocol+"//"+t.domain;throw"Unable to retrieve the origin of the event"}function r(t){var i=s(t);i==h&&t.data.substring(0,e.channel.length+1)==e.channel+" "&&a.up.incoming(t.data.substring(e.channel.length+1),i)}var a,o,l,h;return a={outgoing:function(t,i,n){l.postMessage(e.channel+" "+t,i||h),n&&n()},destroy:function(){P(t,"message",r),o&&(l=null,o.parentNode.removeChild(o),o=null)},onDOMReady:function(){if(h=g(e.remote),e.isHost){var s=function(i){i.data==e.channel+"-ready"&&(l="postMessage"in o.contentWindow?o.contentWindow:o.contentWindow.document,P(t,"message",s),z(t,"message",r),n(function(){a.up.callback(!0)},0))};z(t,"message",s),x(e.props,{src:y(e.remote,{xdm_e:g(i.href),xdm_c:e.channel,xdm_p:1}),name:I+e.channel+"_provider"}),o=_(e)}else z(t,"message",r),l="postMessage"in t.parent?t.parent:t.parent.document,l.postMessage(e.channel+"-ready",h),n(function(){a.up.callback(!0)},0)},init:function(){u(a.onDOMReady,a)}}},F.stack.FrameElementTransport=function(s){var r,a,o,l;return r={outgoing:function(t,e,i){o.call(this,t),i&&i()},destroy:function(){a&&(a.parentNode.removeChild(a),a=null)},onDOMReady:function(){l=g(s.remote),s.isHost?(x(s.props,{src:y(s.remote,{xdm_e:g(i.href),xdm_c:s.channel,xdm_p:5}),name:I+s.channel+"_provider"}),a=_(s),a.fn=function(t){return delete a.fn,o=t,n(function(){r.up.callback(!0)},0),function(t){r.up.incoming(t,l)}}):(e.referrer&&g(e.referrer)!=q.xdm_e&&(t.top.location=q.xdm_e),o=t.frameElement.fn(function(t){r.up.incoming(t,l)}),r.up.callback(!0))},init:function(){u(r.onDOMReady,r)}}},F.stack.NameTransport=function(t){function e(e){var i=t.remoteHelper+(o?"#_3":"#_2")+t.channel;l.contentWindow.sendMessage(e,i)}function i(){o?2!==++c&&o||a.up.callback(!0):(e("ready"),a.up.callback(!0))}function s(t){a.up.incoming(t,p)}function r(){d&&n(function(){d(!0)},0)}var a,o,l,h,c,d,p,f;return a={outgoing:function(t,i,n){d=n,e(t)},destroy:function(){l.parentNode.removeChild(l),l=null,o&&(h.parentNode.removeChild(h),h=null)},onDOMReady:function(){o=t.isHost,c=0,p=g(t.remote),t.local=v(t.local),o?(F.Fn.set(t.channel,function(e){o&&"ready"===e&&(F.Fn.set(t.channel,s),i())}),f=y(t.remote,{xdm_e:t.local,xdm_c:t.channel,xdm_p:2}),x(t.props,{src:f+"#"+t.channel,name:I+t.channel+"_provider"}),h=_(t)):(t.remoteHelper=t.remote,F.Fn.set(t.channel,s)),l=_({props:{src:t.local+"#_4"+t.channel},onLoad:function e(){var s=l||this;P(s,"load",e),F.Fn.set(t.channel+"_load",r),function a(){"function"==typeof s.contentWindow.sendMessage?i():n(a,50)}()}})},init:function(){u(a.onDOMReady,a)}}},F.stack.HashTransport=function(e){function i(t){if(m){var i=e.remote+"#"+p++ +"_"+t;(l||!v?m.contentWindow:m).location=i}}function s(t){d=t,o.up.incoming(d.substring(d.indexOf("_")+1),y)}function r(){if(f){var t=f.location.href,e="",i=t.indexOf("#");-1!=i&&(e=t.substring(i)),e&&e!=d&&s(e)}}function a(){h=setInterval(r,c)}var o,l,h,c,d,p,f,m,v,y;return o={outgoing:function(t){i(t)},destroy:function(){t.clearInterval(h),(l||!v)&&m.parentNode.removeChild(m),m=null},onDOMReady:function(){if(l=e.isHost,c=e.interval,d="#"+e.channel,p=0,v=e.useParent,y=g(e.remote),l){if(e.props={src:e.remote,name:I+e.channel+"_provider"},v)e.onLoad=function(){f=t,a(),o.up.callback(!0)};else{var i=0,s=e.delay/50;!function r(){if(++i>s)throw new Error("Unable to reference listenerwindow");try{f=m.contentWindow.frames[I+e.channel+"_consumer"]}catch(t){}f?(a(),o.up.callback(!0)):n(r,50)}()}m=_(e)}else f=t,a(),v?(m=parent,o.up.callback(!0)):(x(e,{props:{src:e.remote+"#"+e.channel+new Date,name:I+e.channel+"_consumer"},onLoad:function(){o.up.callback(!0)}}),m=_(e))},init:function(){u(o.onDOMReady,o)}}},F.stack.ReliableBehavior=function(){var t,e,i=0,n=0,s="";return t={incoming:function(r,a){var o=r.indexOf("_"),l=r.substring(0,o).split(",");r=r.substring(o+1),l[0]==i&&(s="",e&&e(!0)),r.length>0&&(t.down.outgoing(l[1]+","+i+"_"+s,a),n!=l[1]&&(n=l[1],t.up.incoming(r,a)))},outgoing:function(r,a,o){s=r,e=o,t.down.outgoing(n+","+ ++i+"_"+r,a)}}},F.stack.QueueBehavior=function(t){function e(){if(t.remove&&0===o.length)return T(i),void 0;if(!l&&0!==o.length&&!a){l=!0;var s=o.shift();i.down.outgoing(s.data,s.origin,function(t){l=!1,s.callback&&n(function(){s.callback(t)},0),e()})}}var i,a,o=[],l=!0,h="",c=0,u=!1,d=!1;return i={init:function(){w(t)&&(t={}),t.maxLength&&(c=t.maxLength,d=!0),t.lazy?u=!0:i.down.init()},callback:function(t){l=!1;var n=i.up;e(),n.callback(t)},incoming:function(e,n){if(d){var r=e.indexOf("_"),a=parseInt(e.substring(0,r),10);h+=e.substring(r+1),0===a&&(t.encode&&(h=s(h)),i.up.incoming(h,n),h="")}else i.up.incoming(e,n)},outgoing:function(n,s,a){t.encode&&(n=r(n));var l,h=[];if(d){for(;0!==n.length;)l=n.substring(0,c),n=n.substring(l.length),h.push(l);for(;l=h.shift();)o.push({data:h.length+"_"+l,origin:s,callback:0===h.length?a:null})}else o.push({data:n,origin:s,callback:a});u?i.down.init():e()},destroy:function(){a=!0,i.down.destroy()}}},F.stack.VerifyBehavior=function(t){function e(){n=Math.random().toString(16).substring(2),i.down.outgoing(n)}var i,n,s;return i={incoming:function(r,a){var o=r.indexOf("_");-1===o?r===n?i.up.callback(!0):s||(s=r,t.initiate||e(),i.down.outgoing(r)):r.substring(0,o)===s&&i.up.incoming(r.substring(o+1),a)},outgoing:function(t,e,s){i.down.outgoing(n+"_"+t,e,s)},callback:function(){t.initiate&&e()}}},F.stack.RpcBehavior=function(t,e){function i(t){t.jsonrpc="2.0",r.down.outgoing(a.stringify(t))}function n(t,e){var n=Array.prototype.slice;return function(){var s,r=arguments.length,a={method:e};r>0&&"function"==typeof arguments[r-1]?(r>1&&"function"==typeof arguments[r-2]?(s={success:arguments[r-2],error:arguments[r-1]},a.params=n.call(arguments,0,r-2)):(s={success:arguments[r-1]},a.params=n.call(arguments,0,r-1)),h[""+ ++o]=s,a.id=o):a.params=n.call(arguments,0),t.namedParams&&1===a.params.length&&(a.params=a.params[0]),i(a)}}function s(t,e,n,s){if(!n)return e&&i({id:e,error:{code:-32601,message:"Procedure not found."}}),void 0;var r,a;e?(r=function(t){r=j,i({id:e,result:t})},a=function(t,n){a=j;var s={id:e,error:{code:-32099,message:t}};n&&(s.error.data=n),i(s)}):r=a=j,l(s)||(s=[s]);try{var o=n.method.apply(n.scope,s.concat([r,a]));w(o)||r(o)}catch(h){a(h.message)}}var r,a=e.serializer||Y(),o=0,h={};return r={incoming:function(t){var n=a.parse(t);if(n.method)e.handle?e.handle(n,i):s(n.method,n.id,e.local[n.method],n.params);else{var r=h[n.id];n.error?r.error&&r.error(n.error):r.success&&r.success(n.result),delete h[n.id]}},init:function(){if(e.remote)for(var i in e.remote)e.remote.hasOwnProperty(i)&&(t[i]=n(e.remote[i],i));r.down.init()},destroy:function(){for(var i in e.remote)e.remote.hasOwnProperty(i)&&t.hasOwnProperty(i)&&delete t[i];r.down.destroy()}}},A.easyXDM=F}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent),function(){function t(t){var e=document.createElement("script"),n=!1;e.src=t,e.async=!0,e.onload=e.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,e.onload=e.onreadystatechange=null,e&&e.parentNode&&e.parentNode.removeChild(e))},i||(i=document.getElementsByTagName("head")[0],i||(i=document.body)),i.appendChild(e)}function e(e,i,o){n="?",i=i||{};for(s in i)i.hasOwnProperty(s)&&(n+=encodeURIComponent(s)+"="+encodeURIComponent(i[s])+"&");var l="json"+ ++r;return a[l]=function(t){o(t);try{delete a[l]}catch(e){}a[l]=null},t(e+n+"callback="+l),l}var i,n,s,r=0,a=this;return{get:e}}();var Class=function(t){var e=function(){return e.$prototyping?this:"function"==typeof this.initialize?this.initialize.apply(this,arguments):void 0};t.Extends&&(e.parent=t.Extends,t.Extends.$prototyping=!0,e.prototype=new t.Extends,t.Extends.$prototyping=!1);for(var i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i]);return e};"undefined"!=typeof exports&&(exports.Class=Class);var Vector=new Class({initialize:function(t,e){"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)},cp:function(){return new Vector(this.x,this.y)},mul:function(t){return this.x*=t,this.y*=t,this},mulNew:function(t){return new Vector(this.x*t,this.y*t)},div:function(t){return this.x/=t,this.y/=t,this},divNew:function(t){return new Vector(this.x/t,this.y/t)},add:function(t){return this.x+=t.x,this.y+=t.y,this},addNew:function(t){return new Vector(this.x+t.x,this.y+t.y)},sub:function(t){return this.x-=t.x,this.y-=t.y,this},subNew:function(t){return new Vector(this.x-t.x,this.y-t.y)},rotate:function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)-Math.sin(t)*i,this.y=e*Math.sin(t)+Math.cos(t)*i,this},rotateNew:function(t){return this.cp().rotate(t)},setAngle:function(t){var e=this.len();return this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},setAngleNew:function(t){return this.cp().setAngle(t)},setLength:function(t){var e=this.len();return e?this.mul(t/e):this.x=this.y=t,this},setLengthNew:function(t){return this.cp().setLength(t)},normalize:function(){var t=this.len();return 0==t?this:(this.x/=t,this.y/=t,this)},normalizeNew:function(){return this.cp().normalize()},angle:function(){return Math.atan2(this.y,this.x)},collidesWith:function(t){return this.x>t.x&&this.y>t.y&&this.x<t.x+t.width&&this.y<t.y+t.height},len:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return.005>t&&t>-.005?0:t},is:function(t){return"object"==typeof t&&this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y},inTriangle:function(t,e,i){var n=i.subNew(t),s=e.subNew(t),r=p.subNew(t),a=n.dot(n),o=n.dot(s),l=n.dot(r),h=s.dot(s),c=s.dot(r),u=1/(a*h-o*o),d=(h*l-o*c)*u,f=(a*c-o*l)*u;return d>0&&f>0&&1>d+f},distanceFrom:function(t){return Math.sqrt(Math.pow(this.x-t.x,2),Math.pow(this.y-t.y,2))},toString:function(){return"[Vector("+this.x+", "+this.y+") angle: "+this.angle()+", length: "+this.len()+"]"}});"undefined"!=typeof exports&&(exports.Vector=Vector);var Rect=new Class({initialize:function(t,e,i,n){this.pos=new Vector(t,e),this.size={width:i,height:n}},hasPoint:function(t){return t.x>this.getLeft()&&t.x<this.getRight()&&t.y>this.getTop()&&t.y<this.getBottom()},setLeft:function(t){this.pos.x=t+this.size.width/2},setTop:function(t){this.pos.y=t+this.size.height/2},getLeft:function(){return this.pos.x-this.size.width/2},getTop:function(){return this.pos.y-this.size.height/2},getRight:function(){return this.pos.x+this.size.width/2},getBottom:function(){return this.pos.y+this.size.height/2},cp:function(){return new Rect(this.pos.x,this.pos.y,this.size.width,this.size.height)}});"undefined"!=typeof exports&&(exports.Rect=Rect);var Fx=new Class({initialize:function(){this.listeners=[],this.tweens={},this.running={}},addListener:function(t){this.listeners.push(t)},add:function(t,e){if(e=e||{},e.duration=e.duration||500,e.transition=e.transition||Tween.Linear,e.repeats="undefined"==typeof e.repeats?!1:e.repeats,!e.tweens){var i=e.start||0,n="undefined"==typeof e.end?1:e.end;e.tweens=[[i,n]]}this.tweens[t]=e},update:function(t){t="number"==typeof t?t:now();for(var e in this.tweens)if(this.tweens.hasOwnProperty(e)){if(!this.running[e]){this.tweenStart(e,t);continue}var i=this.tweens[e],n=t-this.running[e].startTime;if(n>i.duration){this.tweenFinished(i,e);continue}for(var s,r=i.transition(n/i.duration),a=[],o=0;s=i.tweens[o];o++){var l=r*(s[1]-s[0])+s[0];a.push(l)}this.fire(e,a,r)}},tweenStart:function(t,e){this.running[t]={startTime:e};for(var i,n=[],s=0;i=this.tweens[t].tweens[s];s++)n.push(i[0]);this.fire(t,n,0)},tweenFinished:function(t,e){for(var i,n=[],s=0;i=t.tweens[s];s++)n.push(i[1]);return this.fire(e,n,1),t.repeats?(this.tweenStart(e,now()),void 0):(delete this.running[e],delete this.tweens[e],void 0)},fire:function(t,e,i){for(var n,s=0;n=this.listeners[s];s++)n.set.call(n,t,e,i)}}),Tween={Linear:function(t){return t},Quadratic:function(t){return t*t},Quintic:function(t){return t*t*t},Shake:function(t){return Math.sin(t)}},GameGlobals={FPS:60,useAnimationFrame:!1,boids:{flockRadius:400,size:100},path:function(){return document.location.protocol+"//kickassapp.com/"+Array.prototype.slice.call(arguments).join("")},hasCanvas:"undefined"!=typeof document.createElement("canvas").getContext,bulletColor:"white"};GameGlobals.easyXDMFlash=GameGlobals.path("easyxdm.swf"),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(var s=n>=0?n:Math.max(i-Math.abs(n),0);i>s;s++)if(s in e&&e[s]===t)return s;return-1});var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),KickAss=new Class({initialize:function(){this.players=[],this.elements=[],this.weaponClass=Weapons[1].cannonClass,this.scrollPos=new Vector(0,0),this.scrollSize=new Vector(0,0),this.windowSize={width:0,height:0},this.updateWindowInfo(),this.world=new World(this),this.bulletManager=new BulletManager,this.bulletManager.game=this,this.bulletManager.updateEnemyIndex(),this.explosionManager=new ExplosionManager,this.explosionManager.game=this,this.statisticsManager=new StatisticsManager,this.statisticsManager.game=this,GameGlobals.stats=this.statisticsManager,this.sessionManager=new SessionManager,this.sessionManager.game=this,this.alienManager=new AlienManager(this),this.lastUpdate=now(),this.keyMap={},this.keydownEvent=bind(this,this.keydown),this.keyupEvent=bind(this,this.keyup),this.multiplier=10,window.KickAssStyle&&"white"===window.KickAssStyle&&(GameGlobals.bulletColor="white"),addEvent(document,"keydown",this.keydownEvent),addEvent(document,"keyup",this.keyupEvent),addEvent(document,"keypress",this.keydownEvent)},begin:function(){this.addPlayer(),this.sessionManager.isPlaying=!0,GameGlobals.useAnimationFrame||(this.loopTimer=window.setInterval(bind(this,this.loop),1e3/GameGlobals.FPS)),GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},keydown:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!0,e){case"left":case"right":case"up":case"down":case"esc":case" ":stopEvent(t)}switch(e){case"esc":this.destroy()}},keyup:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!1,e){case"left":case"right":case"up":case"down":case"esc":case" ":t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}},loop:function(){var t=now(),e=(t-this.lastUpdate)/1e3;this.updateWindowInfo();for(var i,n=0;i=this.players[n];n++)i.update(e);this.world.update(e),this.bulletManager.update(e),this.explosionManager.update(e),this.alienManager.update(e),this.statisticsManager.update(e),this.sessionManager.update(e),this.lastUpdate=t,GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},addPlayer:function(){var t=Ships.Standard;window.KICKASSSHIP&&KICKASSSHIP.points&&(t=KICKASSSHIP);var e=new Player;e.game=this,e.setShip(t),this.players.push(e),this.explosionManager.addExplosion(e.pos)},registerElement:function(t){if(!t)throw new Error("Can't register unexisting element.");this.elements.push(t)},unregisterElement:function(t){this.elements.splice(this.elements.indexOf(t),1)},isKickAssElement:function(t){for(var e,i=0;e=this.elements[i];i++)if(t===e||elementIsContainedIn(e,t))return!0;return!1},isKeyPressed:function(t){return!!this.keyMap[t]},updateWindowInfo:function(){var t=!!window.ActiveXObject&&"BackCompat"==document.compatMode;this.windowSize={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight},t&&(this.windowSize.width=document.body.clientWidth,this.windowSize.height=document.body.clientHeight),this.scrollPos.x=window.pageXOffset||document.documentElement.scrollLeft,this.scrollPos.y=window.pageYOffset||document.documentElement.scrollTop,this.scrollSize=getScrollSize()},hideAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="hidden"},showAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="visible"},updateShips:function(t,e){e||this.ui.showMessage("You're now flying<br /><em>"+t.name+"<em>!!");for(var i,n=0;i=this.players[n];n++)i.setShip(t)},changeWeapon:function(t,e){this.weaponClass=t.cannonClass,e||this.ui.showMessage("Changed to "+t.name.toUpperCase()+"!!!!");for(var i,n=0;i=this.players[n];n++)i.setCannons(t.cannonClass)},changeWeaponById:function(t,e){Weapons[t]&&this.changeWeapon(Weapons[t],e)},flyOutPlayers:function(t){for(var e,i=0;e=this.players[i];i++)e.flyTo(t,-e.size.height),e.isBound=!1},flyInPlayers:function(){for(var t,e=0;t=this.players[e];e++)t.flyTo(t.pos.x,100,function(){this.isBound=!0})},newRank:function(t){this.ui.showMessage("OMG. You leveled up to: <strong>"+t+"</strong>!<br /><small>Be sure to check what cool new stuff you get in the menu.</small>")},destroy:function(){removeEvent(document,"keydown",this.keydownEvent),removeEvent(document,"keypress",this.keydownEvent),removeEvent(document,"keyup",this.keyupEvent);for(var t,e=0;t=this.players[e];e++)t.destroy();this.bulletManager.destroy(),this.explosionManager.destroy(),GameGlobals.useAnimationFrame||clearInterval(this.loopTimer),window.KICKASSGAME=!1}}),StatisticsManager=new Class({initialize:function(){this.data={},this.data.startedPlaying=now(),this.data.elementsDestroyed=0,this.data.shotsFired=0,this.data.distanceFlownInPixels=0,this.data.totalPointsThisSession=0,this.data.usedThrusters=0,this.lastUpdate=0},usedThrusters:function(){this.data.usedThrusters=1},increaseDistanceWithPixels:function(t){this.data.distanceFlownInPixels+=t},increasePointsGainedWithPoints:function(t){this.data.totalPointsThisSession+=t},addShotFired:function(){this.data.shotsFired++},addElementsDestroyed:function(){this.data.elementsDestroyed++},update:function(t){this.lastUpdate+=t,this.lastUpdate>.25&&(this.syncWithServer(),this.lastUpdate=0)},syncWithServer:function(){var t=[];for(var e in this.data)this.data.hasOwnProperty(e)&&t.push(e+":"+this.data[e])}}),World=new Class({initialize:function(t){return},render:function(){return},update:function(t){}}),Ships={Standard:{points:[[-10,10],[0,-15],[10,10]],thrusters:[{s:{w:20,h:7},p:{x:0,y:14},a:0}],cannons:[{p:{x:0,y:-15},a:0}]}},PLAYERIDS=0,Player=new Class({initialize:function(){this.id=PLAYERIDS++,this.tween=!1,this.isBound=!0,this.pos=new Vector(200,200),this.vel=new Vector(0,0),this.acc=new Vector(0,0),this.dir=new Vector(0,1),this.currentRotation=0,this.isBroken=!1,this.lineOffsets=[],this.deadTime=0,this.friction=.8,this.terminalVelocity=2e3,this.lastPos=new Vector(0,0)},setShip:function(t){this.ship=t,this.verts=[];for(var e,i=0;e=this.ship.points[i];i++)this.verts.push(new Vector(e[0],e[1]));this.verts.push(this.verts[0]),this.thrusters=[],this.cannons=[],this.addThrusters(this.ship.thrusters),this.addCannons(this.ship.cannons),this.size=this.getSizeFromVertsAndObjects(),this.bounds=this.calculateBounds(),this.sheet&&this.sheet.destroy(),this.sheet=new Sheet(new Rect(100,100,this.bounds.x,this.bounds.y)),this.forceRedraw=!0},setCannons:function(t){for(var e,i=[],n=0;e=this.cannons[n];n++){var s=new t(e.pos.x,e.pos.y,e.angle);s.player=this,s.game=this.game,i.push(s),e.destroy()}this.cannons=i},addThrusters:function(t){for(var e,i=0;e=t[i];i++){var n=new Thruster(e);this.thrusters.push(n)}},addCannons:function(t){for(var e,i=0;e=t[i];i++){var n=WeaponMap[e.m]||WeaponMap.cannon,s=new n.cannonClass(e.p.x,e.p.y,e.a);s.player=this,s.game=this.game,this.cannons.push(s)}},update:function(t){if(this.isBroken){if(!this.lineOffsets.length)for(var e=0;e<this.verts.length-1;e++)this.lineOffsets[e]={pos:new Vector(0,0),dir:new Vector(1,1).setAngle(2*Math.PI*Math.random())};for(var e=0;e<this.lineOffsets.length;e++)this.lineOffsets[e].pos.add(this.lineOffsets[e].dir.cp().setLength(50).mul(t));return this.sheet.clear(),this.sheet.setAngle(this.dir.angle()),this.sheet.setPosition(this.pos),this.sheet.drawBrokenPlayer(this.verts,this.lineOffsets),now()-this.deadTime>1e3&&(this.isBroken=!1,this.lineOffsets=[],this.randomPos()),void 0}this.tween||(this.game.isKeyPressed("left")||this.game.isKeyPressed("right")?(this.game.isKeyPressed("left")&&this.rotateLeft(t),this.game.isKeyPressed("right")&&this.rotateRight(t)):this.stopRotate(),this.game.isKeyPressed("up")?this.activateThrusters():this.stopThrusters()),this.game.isKeyPressed(" ")?(this.isShooting=!0,this.isBroken||this.shootPressed()):this.isShooting&&(this.isShooting=!1,this.shootReleased()),this.currentRotation&&this.dir.setAngle(this.dir.angle()+this.currentRotation*t);var i=this.acc.mulNew(t).sub(this.vel.mulNew(t*this.friction));this.vel.add(i),this.vel.len()>this.terminalVelocity&&this.vel.setLength(this.terminalVelocity);var n=this.vel.mulNew(t);this.pos.add(n),GameGlobals.stats.increaseDistanceWithPixels(n.len());for(var s,r=!this.acc.is({x:0,y:0}),e=0;s=this.thrusters[e];e++)s.setIsShown(r),s.update(t);if(this.isBound&&this.checkBounds(),!this.lastPos.is(this.pos)||this.currentRotation||this.forceRedraw){if(this.forceRedraw=!1,this.sheet.clear(),this.sheet.setAngle(this.dir.angle()+Math.PI/2),this.sheet.setPosition(this.pos),r)for(var s,e=0;s=this.thrusters[e];e++)s.drawTo(this.sheet);this.sheet.drawPlayer(this.verts),this.lastPos=this.pos.cp()}for(var a,e=0;a=this.cannons[e];e++)a.update(t)},randomPos:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height;this.pos=new Vector(random(0,t),random(0,e))},checkBounds:function(){if(!this.tween){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,n=this.pos.y+this.sheet.rect.size.height/2;i>t?(window.scrollTo(this.game.scrollPos.x+50,this.game.scrollPos.y),this.pos.x=0):this.pos.x<0&&(window.scrollTo(this.game.scrollPos.x-50,this.game.scrollPos.y),this.pos.x=t-this.sheet.rect.size.width/2),n>e?(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y+.75*e),this.pos.y=0):this.pos.y<0&&(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y-.75*e),this.pos.y=e-this.sheet.rect.size.height/2)}},inRect:function(t){for(var e,i=!1,n=0;e=this.verts[n];n++)t.hasPoint(new Vector(e.x+this.pos.x,e.y+this.pos.y))&&(i=!0);return i},hit:function(){this.isBroken||(this.isBroken=!0,this.deadTime=now())},activateThrusters:function(){this.game.statisticsManager.usedThrusters(),this.acc=new Vector(500,0).setAngle(this.dir.angle())},stopThrusters:function(){this.acc=new Vector(0,0)},rotateLeft:function(t){this.currentRotation=Math.max(2*-Math.PI,this.currentRotation-10*Math.PI*t)},rotateRight:function(t){this.currentRotation=Math.min(2*Math.PI,this.currentRotation+10*Math.PI*t)},stopRotate:function(){this.currentRotation=0},getSizeFromVertsAndObjects:function(){for(var t,e=0,i=0;t=this.verts[i];i++)e=Math.max(e,new Vector(t).len());for(var n,i=0;n=this.thrusters[i];i++){var s=new Vector(n.pos.x-n.size.width/2,n.pos.y-n.size.height/2).rotate(n.angle),r=new Vector(n.pos.x+n.size.width/2,n.pos.y-n.size.height/2).rotate(n.angle),a=new Vector(n.pos.x-n.size.width/2,n.pos.y+n.size.height/2).rotate(n.angle),o=new Vector(n.pos.x+n.size.width/2,n.pos.y+n.size.height/2).rotate(n.angle);e=Math.max(e,s.len(),r.len(),a.len(),o.len())}return{width:2*e,height:2*e}},calculateBounds:function(){return{x:1*Math.max(this.size.width,this.size.height),y:1*Math.max(this.size.height,this.size.width)}},shootPressed:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootPressed()},shootReleased:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootReleased()},flyTo:function(t,e,i){this.tween={start:{pos:this.pos.cp(),dir:this.dir.cp()},to:new Vector(t,e),callback:i||function(){}},this.tween.time=this.getTimeforTween()},destroy:function(){this.sheet.destroy()}}),Thruster=new Class({initialize:function(t,e){this.pos=new Vector(t.p),this.size={width:t.s.w,height:t.s.h},this.angle=t.a||0,this.ship=e,this.isShown=!1,this.flameY=1,this.fx=new Fx,this.fx.addListener(this),this.flames={r:[],y:[]},this.lastFrameUpdate=0,this.generateFlames()},update:function(){this.fx.update(),now()-this.lastFrameUpdate>1e3/60&&this.generateFlames()},set:function(t,e){switch(t){case"flames":this.flameY=e}},setIsShown:function(t){!this.isShown&&t&&(this.flameY=0,this.generateFlames(),this.fx.add("flames",{start:this.flameY,end:1,duration:250,transition:Tween.Quintic})),this.isShown=t},drawTo:function(t){t.drawFlames(this.flames,this.angle)},generateFlames:function(){function t(t,e){return new Vector(t,e)}var e=this.size.width,i=.05*this.size.width,n=.8*this.size.width,s=.1*n,r=e/2,a=n/2;-this.size.height/2;var o=this.pos.x,l=this.pos.y-this.size.height/2;this.flames.r=[t(-r+o,l)],this.flames.y=[t(-a+o,l)],this.flames.self=this;for(var h=0;e>h;h+=i)this.flames.r.push(t(h-r+o,this.flameY*random(.7*this.size.height,this.size.height)+l));
this.flames.r.push(t(r+o,l));for(var h=0;n>h;h+=s)this.flames.y.push(t(h-a+o,this.flameY*random(.4*this.size.height,.7*this.size.height)+l));this.flames.y.push(t(a+o,l)),this.lastFrameUpdate=now();for(var c,u=t(o,l),d=0;c=this.flames.r[d];d++)c.sub(u).rotate(this.angle).add(u);for(var c,d=0;c=this.flames.y[d];d++)c.sub(u).rotate(this.angle).add(u)}}),ELEMENTSTHATARENOTTOBEINCLUDED=["BR","SCRIPT","STYLE","TITLE","META","HEAD","OPTION","OPTGROUP","LINK"],ELEMENTSIZETHRESHOLD=5,BulletManager=new Class({initialize:function(){this.lastBlink=0,this.blinkActive=!1,this.enemyIndex=[],this.updateDelay=2.5,this.nextUpdate=this.updateDelay},update:function(t){this.game.isKeyPressed("B")?this.blink():this.blinkActive&&this.endBlink(),this.nextUpdate-=t,this.nextUpdate<0&&this.updateEnemyIndex()},blink:function(){if(now()-this.lastBlink>250){for(var t,e=0;t=this.enemyIndex[e];e++)t.style.outline=this.blinkActive?t.KICKASSOLDBORDER:"1px solid red";this.blinkActive=!this.blinkActive,this.lastBlink=now(),this.blinkActive||this.updateEnemyIndex()}},endBlink:function(){for(var t,e=0;t=this.enemyIndex[e];e++)t.style.outline=t.KICKASSOLDBORDER;this.lastBlink=0,this.blinkActive=!1},updateEnemyIndex:function(){var t=document.getElementsByTagName("*");this.enemyIndex=[];for(var e,i=0;e=t[i];i++)this.isDestroyable(e)&&(this.enemyIndex.push(e),e.KICKASSOLDBORDER=e.style.outline||document.defaultView.getComputedStyle(e,null).outline);this.nextUpdate=this.updateDelay},isDestroyable:function(t,e){if(this.shouldIgnoreElement(t,e))return!1;for(var i,n=0;i=t.childNodes[n];n++)if(1===i.nodeType&&-1===ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(i.tagName)&&i.offsetWidth>=ELEMENTSIZETHRESHOLD&&i.offsetHeight>=ELEMENTSIZETHRESHOLD&&"hidden"!==document.defaultView.getComputedStyle(i,null).visibility)return!1;return!0},isDestroyableFromCollision:function(t){return this.isDestroyable(t,!0)},shouldIgnoreElement:function(t,e){if(1!==t.nodeType)return!0;if(t==document.documentElement||t==document.body)return!0;if(-1!==ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(t.tagName))return!0;if("hidden"==t.style.visibility||"none"==t.style.display)return!0;if(t.className&&-1!=t.className.indexOf("KICKASSELEMENT"))return!0;if(!e&&(t.offsetWidth<ELEMENTSIZETHRESHOLD||t.offsetHeight<ELEMENTSIZETHRESHOLD))return!0;var i;return(t.offsetLeft<0||t.offsetTop<0)&&(i=getRect(t),i.left+i.width<0||i.top+i.height<0)?!0:(i||(i=getRect(t)),i.top>=this.game.scrollSize.y?!0:!1)},destroy:function(){for(var t in this.bullets)if(this.bullets.hasOwnProperty(t))for(var e,i=0;e=this.bullets[t][i];i++)e.destroy();this.bullets={}}}),SessionManager=new Class({initialize:function(){this.isPlaying=!1},update:function(){this.isPlaying&&0==this.game.bulletManager.enemyIndex.length&&this.weHaveWon()},weHaveWon:function(){this.isPlaying=!1,this.game.ui.showMessage("You're done!")}}),AlienManager=Class({initialize:function(){this.aliens=[]},update:function(t){if(this.aliens.length)for(var e,i=0;e=this.aliens[i];i++)e.update(t),e.render()}}),alienSize={w:41,h:30};new Class({initialize:function(){this.pos=new Vector(100,100),this.sprite=new Sheet(new Rect(this.pos.x,this.pos.y,alienSize.w,alienSize.h))},update:function(){},render:function(){}});var ExplosionManager=new Class({initialize:function(){this.explosions=[]},update:function(t){for(var e,i=now(),n=0;e=this.explosions[n];n++)i-e.bornAt>(e.ttl||500)?(e.destroy(),this.explosions.splice(n,1)):e.update(t)},addExplosion:function(t,e,i){i=i||ParticleExplosion;var n=new i(t,e);n.game=this.game,n.checkBounds(),this.explosions.push(n)},destroy:function(){for(var t,e=0;t=this.explosions[e];e++)t.destroy();this.explosions=[]}}),Cannon=new Class({initialize:function(t,e,i){this.pos=new Vector(t,e),this.angle=i||0},shootPressed:function(){},shootReleased:function(){},checkCollisions:function(){},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.game.hideAll(),this.checkCollisions(t),this.game.showAll()},checkCollision:function(t){var e=t.checkCollision();return e?(this.game.explosionManager.addExplosion(t.pos,e,this.getExplosionClass()),e.isShot||e.parentNode.removeChild(e),GameGlobals.stats.addElementsDestroyed(),!0):!1},createBullet:function(t){var e=this.getABulletPos(),i=this.getABulletDir(),n=new t(e,i);return n.game=this.game,n.manager=this,n.initCanvas(),n.vel.add(n.vel.cp().setLength(this.player.vel.len())),n},getABulletPos:function(){return this.player.pos.cp().add(this.pos.cp().rotate(this.player.dir.angle()+Math.PI/2))},getABulletDir:function(){return this.player.dir.cp().rotate(this.angle)},destroy:function(){}}),LaserCannon=new Class({Extends:Cannon,initialize:function(){Cannon.prototype.initialize.apply(this,arguments),this.lasers=[]},getExplosionClass:function(){return SplitExplosion},update:function(t){this.lasers.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},checkCollisions:function(t){for(var e,i=0;e=this.lasers[i];i++)e.update(t),this.checkCollision(e)},removeOld:function(){for(var t,e=0;t=this.lasers[e];e++)t.outOfBounds&&(t.destroy(),this.lasers.splice(e,1))},shootPressed:function(){this.lasers.length>5||now()-this.lastFired<500||(this.lastFired=now(),GameGlobals.stats.addShotFired(),this.lasers.push(this.createBullet(LaserBullet)))},destroy:function(){if(this.lasers.length){for(var t,e=0;t=this.lasers[e];e++)t.destroy();this.lasers=[]}}}),BallCannon=new Class({Extends:Cannon,initialize:function(){Cannon.prototype.initialize.apply(this,arguments),this.lastFired=0,this.bullets=[]},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.bullets.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},removeOld:function(){for(var t,e=now(),i=0;t=this.bullets[i];i++)e-t.bornAt>2e3&&(t.destroy(),this.bullets.splice(i,1))},checkCollisions:function(t){for(var e,i=0;e=this.bullets[i];i++)e.update(t),this.checkCollision(e)&&(e.destroy(),this.bullets.splice(i,1))},shootPressed:function(){now()-this.lastFired<200||(this.lastFired=now(),this.addBullet(),GameGlobals.stats.addShotFired())},addBullet:function(){this.bullets.length>7&&(this.bullets[0].destroy(),this.bullets.shift());var t=this.createBullet(Bullet);this.bullets.push(t)},destroy:function(){for(var t,e=0;t=this.bullets[e];e++)t.destroy();this.bullets=[]}}),Bullet=new Class({initialize:function(t,e){this.pos=t.cp(),this.dir=e,this.vel=new Vector(500,500),this.bornAt=now()},initCanvas:function(){this.sheet=new Sheet(new Rect(this.pos.x,this.pos.y,5,5)),this.sheet.drawBullet()},draw:function(){this.sheet.setPosition(this.pos)},update:function(t){this.pos.add(this.vel.setAngle(this.dir.angle()).mulNew(t)),this.checkBounds(),this.draw()},checkCollision:function(){var t=document.elementFromPoint(this.pos.x,this.pos.y);t&&3==t.nodeType&&(t=t.parentNode);var e=t&&this.game.bulletManager.isDestroyableFromCollision(t)?t:!1;return e},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,n=this.pos.y+this.sheet.rect.size.height/2;i>t?this.pos.x=0:this.pos.x<0&&(this.pos.x=t-this.sheet.rect.size.width/2),n>e?this.pos.y=0:this.pos.y<0&&(this.pos.y=e-this.sheet.rect.size.height/2)},destroy:function(){this.sheet.destroy()}}),LaserBullet=new Class({Extends:Bullet,initialize:function(){Bullet.prototype.initialize.apply(this,arguments),this.vel=new Vector(750,750),this.lastDrawPos=this.pos.cp()},initCanvas:function(){var t=Math.max(GameGlobals.laserImage.width,GameGlobals.laserImage.height);this.sheet=new Sheet(new Rect(0,0,t,t))},update:function(){Bullet.prototype.update.apply(this,arguments)},draw:function(){this.sheet.drawLaser(this.pos,this.dir),this.lastDrawPos=this.pos.cp()},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,n=this.pos.y+this.sheet.rect.size.height/2;(i>t||this.pos.x<0)&&(this.outOfBounds=!0),(n>e||this.pos.y<0)&&(this.outOfBounds=!0)},destroy:function(){this.sheet.destroy()}});GameGlobals.laserImage=document.createElement("img"),GameGlobals.laserImage.src=GameGlobals.path("css/gfx/kickass/laser.png");var Explosion=new Class({initialize:function(t){this.bornAt=now(),this.pos=t.cp()},update:function(){},checkBounds:function(){},destroy:function(){}}),ParticleExplosion=new Class({Extends:Explosion,initialize:function(t){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(150,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,250,250))},update:function(t){for(var e,i=0;e=this.particles[i];i++)e.pos.add(e.vel.mulNew(t).mul(random(.5,1)).setAngle(e.dir.angle()));this.sheet.clear(),this.sheet.drawExplosion(this.particles)},generateParticles:function(){for(var t=0,e=GameGlobals.hasCanvas?40:10;e>t;t++)this.particles.push({dir:new Vector(random(0,20)-10,random(0,20)-10).normalize(),vel:this.particleVel.cp(),pos:new Vector(0,0),color:["yellow","red"][random(0,1)]})},checkBounds:function(){var t=this.sheet.rect.getRight(),e=this.sheet.rect.getBottom(),i=this.game.windowSize.width,n=this.game.windowSize.height;t>i&&(this.pos.x-=t-i),e>n&&(this.pos.y-=e-n),this.sheet.setPosition(this.pos)},destroy:function(){this.sheet.destroy()}});new Class({Extends:ParticleExplosion,initialize:function(t){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(200,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,500,500)),this.ttl=2e3,this.generationDelay=.6,this.generationTimes=2,this.nextGenerate=this.generationDelay},update:function(t){this.nextGenerate-=t,this.nextGenerate<=0&&this.generationTimes>0&&(this.nextGenerate=this.generationDelay,this.generateParticles(),this.generationTimes--),ParticleExplosion.prototype.update.call(this,t)}});var SplitExplosion=new Class({Extends:Explosion,initialize:function(t,e){e&&(Explosion.prototype.initialize.apply(this,arguments),this.element=e,this.fx=new Fx,this.fx.addListener(this),this.start())},update:function(){this.element&&this.fx.update()},set:function(t){},start:function(){var t=this.createClones(),e=t[0],i=t[1],n="rotate(-"+random(30,50)+"deg) translate(-100px, 40px)",s="rotate("+random(30,50)+"deg) translate(100px, 40px)";setStyles(e,{WebkitTransform:n,MozTransform:n,OTransform:n,MsTransform:n}),setStyles(i,{WebkitTransform:s,MozTransform:s,OTransform:s,MsTransform:s}),this.left=e,this.right=i,this.fx.add("opacity",{start:1,end:.5,duration:500})},createClones:function(){var t=getRect(this.element),e=this.createContainer(t),i=this.createContainer(t),n=cloneElement(this.element),s=cloneElement(this.element);addClass(n,"KICKASSELEMENT"),addClass(s,"KICKASSELEMENT");var r={margin:0,overflow:"hidden"};return setStyles(n,r),setStyles(s,r),e.appendChild(n),i.appendChild(s),i.style.left=t.left+t.width/2+"px",i.scrollLeft+=t.width/2,this.element.style.opacity=0,this.element.style.visibility="hidden",this.element.style.display="none",each([e,i],function(t){t.style.WebkitTransition="-webkit-transform 500ms ease-in",t.style.OTransition="-o-transform 500ms ease-in",t.style.MozTransition="-moz-transform 500ms ease-in",t.style.MsTransition="-ms-transform 500ms ease-in"})},createContainer:function(t){var e=document.createElement("div");return setStyles(e,{position:"absolute",left:t.left,top:t.top,width:.5*t.width,height:t.height,overflow:"hidden"}),document.body.appendChild(e),e},destroy:function(){try{this.left.parentNode.removeChild(this.left),this.right.parentNode.removeChild(this.right),this.element.parentNode.removeChild(this.element)}catch(t){}}}),Weapons={1:{name:"Cannon",id:"cannon",cannonClass:BallCannon},2:{name:"Laser",id:"laser",cannonClass:LaserCannon}},WeaponMap={cannon:Weapons[1],laser:Weapons[2]},SheetRaphael=new Class({initialize:function(t){this.rect=t,this.fillColor="black",this.strokeColor="black",this.lineWidth=1,this.polyString="",this.raphael=Raphael(this.rect.pos.x-this.rect.size.width/2,this.rect.pos.y-this.rect.size.height/2,this.rect.size.width,this.rect.size.height),this.raphael.canvas.style.zIndex="10000",this.raphael.canvas.className="KICKASSELEMENT",GameGlobals.kickass.registerElement(this.raphael.canvas)},tracePoly:function(t){if(t[0]){this.polyString="M"+t[0].x+" "+t[0].y;for(var e=0;e<t.length;e++)this.polyString+="L"+t[e].x+" "+t[e].y}},setAngle:function(t){this.angle=t},updateCanvas:function(){this.raphael.canvas.width=this.rect.size.width,this.raphael.canvas.height=this.rect.size.height,this.raphael.canvas.style.left=GameGlobals.kickass.scrollPos.x+(this.rect.pos.x-this.rect.size.width/2)+"px",this.raphael.canvas.style.top=GameGlobals.kickass.scrollPos.y+(this.rect.pos.y-this.rect.size.height/2)+"px"},drawLine:function(t,e,i,n){this.tracePoly([[t,e],[i,n]]),this.strokePath()},drawCircle:function(t,e){e=e||{x:0,y:0},this.currentElement=this.raphael.circle(e.x,e.y,t),this.currentElement.attr("fill",this.fillColor)},setFillColor:function(t){this.fillColor=t},setStrokeColor:function(t){this.strokeColor=t},setLineWidth:function(t){this.lineWidth=t},fillPath:function(){this.currentElement=this.raphael.path(this.polyString),this.currentElement.translate(this.rect.size.width/2,this.rect.size.height/2),this.currentElement.attr("fill",this.fillColor),this.currentElement.attr("stroke",this.fillColor),this.currentElement.rotate(Raphael.deg(this.angle),this.rect.size.width/2,this.rect.size.height/2)},strokePath:function(){this.currentElement=this.raphael.path(this.polyString),this.currentElement.attr("stroke",this.strokeColor),this.currentElement.attr("stroke-width",this.lineWidth),this.currentElement.translate(this.rect.size.width/2,this.rect.size.height/2),this.currentElement.rotate(Raphael.deg(this.angle),this.rect.size.width/2,this.rect.size.height/2)},clear:function(){this.raphael.clear()},destroy:function(){GameGlobals.kickass.unregisterElement(this.raphael.canvas),this.raphael.remove()}}),SheetCanvas=new Class({initialize:function(rect){with(this.canvas=document.createElement("canvas"),this.canvas.className="KICKASSELEMENT",this.canvas.style)position="absolute",zIndex="1000000";GameGlobals.kickass.registerElement(this.canvas),this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d")),this.rect=rect,this.angle=0,this.updateCanvas(),document.body.appendChild(this.canvas)},tracePoly:function(t){if(t[0]){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.rotate(this.angle),this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(var e=0;e<t.length;e++)this.ctx.lineTo(t[e].x,t[e].y);this.ctx.restore()}},setAngle:function(t){this.angle=t},updateCanvas:function(){this.canvas.width!=this.rect.size.width&&(this.canvas.width=this.rect.size.width),this.canvas.height!=this.rect.size.height&&(this.canvas.height=this.rect.size.height),this.canvas.style.left=GameGlobals.kickass.scrollPos.x+(this.rect.pos.x-this.rect.size.width/2)+"px",this.canvas.style.top=GameGlobals.kickass.scrollPos.y+(this.rect.pos.y-this.rect.size.height/2)+"px"},drawLine:function(t,e,i,n){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,n),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},drawCircle:function(t,e){e=e||{x:0,y:0},this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),e&&this.ctx.translate(e.x,e.y),this.ctx.beginPath(),this.ctx.arc(0,0,t,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()},drawRect:function(t,e,i,n){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.translate(t,e),this.ctx.fillRect(t,e,i,n),this.ctx.restore(),this.ctx.fill()},drawImageFull:function(t){this.ctx.drawImage(t,0,0,this.rect.size.width,this.rect.size.height)},drawImage:function(t,e,i){this.ctx.save(),this.ctx.translate(this.rect.size.width/2+e,this.rect.size.height/2+i),this.ctx.rotate(this.angle),this.ctx.drawImage(t,0,-11),this.ctx.restore()},setFillColor:function(t){this.ctx.fillStyle=t},setStrokeColor:function(t){this.ctx.strokeStyle=t},setLineWidth:function(t){this.ctx.lineWidth=t},fillPath:function(){this.ctx.fill()},strokePath:function(){this.ctx.stroke()},clear:function(){this.ctx.clearRect(0,0,this.rect.size.width,this.rect.size.height)},destroy:function(){GameGlobals.kickass.unregisterElement(this.canvas),this.canvas.parentNode.removeChild(this.canvas)}}),Sheet=new Class({initialize:function(t){this.rect=t,this.drawer=GameGlobals.hasCanvas?new SheetCanvas(t):new SheetRaphael(t)},clear:function(){this.drawer.clear()},setPosition:function(t){this.rect.pos=t.cp(),this.drawer.rect=this.rect,this.drawer.updateCanvas()},setAngle:function(t){this.drawer.setAngle(t)},drawPlayer:function(t){this.drawer.setFillColor("white"),this.drawer.setStrokeColor("black"),this.drawer.setLineWidth(1.5),this.drawer.tracePoly(t),this.drawer.fillPath(),this.drawer.tracePoly(t),this.drawer.strokePath()},drawBrokenPlayer:function(t,e){this.drawer.setStrokeColor("black"),this.drawer.setLineWidth(1.5);for(var i,n=1,s=t[0];i=t[n];n++,s=i){var r=e[n-1];this.drawer.drawLine(s.x+r.pos.x,s.x+r.pos.y,i.x+r.pos.x,i.y+r.pos.y)}},drawFlames:function(t){this.drawer.setLineWidth(1.5),this.drawer.setFillColor("red"),this.drawer.tracePoly(t.r),this.drawer.fillPath(),this.drawer.setFillColor("yellow"),this.drawer.tracePoly(t.y),this.drawer.fillPath()},drawBullet:function(){this.drawer.setFillColor(GameGlobals.bulletColor),this.drawer.drawCircle(2.5)},drawExplosion:function(t){for(var e,i=0;e=t[i];i++)this.drawer.setFillColor(e.color),this.drawer.drawRect(e.pos.x,e.pos.y,3,3)},drawFace:function(t){this.drawer.drawImageFull(t)},drawLaser:function(t,e){this.clear(),this.setPosition(t),this.drawer.setAngle(e.angle()),this.drawer.drawImage(GameGlobals.laserImage,0,0)},transformToSheetCoordinates:function(t){var e=t.cp().sub(new Vector(this.rect.size.width/2,this.rect.size.height/2));return e},destroy:function(){this.drawer.destroy()}}),initKickAss=function(){window.KICKASSGAME?window.KICKASSGAME.addPlayer():(window.KICKASSGAME=GameGlobals.kickass=new KickAss,window.KICKASSGAME.begin())};initKickAss()}("undefined"!=typeof exports?exports:window);