/* Copyright (c) <2011, 2012> Rootof Creations HB, rootof.com, kickassapp.com
  Raphael 1.5.2 - JavaScript Vector Library
  Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
  Licensed under the MIT (http://raphaeljs.com/license.html) license.
 */
!function(window){function now(){return(new Date).getTime()}function bind(t,e){return function(){return e.apply(t,arguments)}}function each(t,e,i){if("function"==typeof t.forEach)return t.forEach(e,i),t;for(var s in t)t.hasOwnProperty(s)&&e.call(i||window,t[s],s);return t}function addEvent(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&(t["e"+e+i]=i,t[e+i]=function(){return t["e"+e+i](window.event)},t.attachEvent("on"+e,t[e+i]))}function removeEvent(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&(t.detachEvent("on"+e,t[e+i]),t[e+i]=null,t["e"+e+i]=null)}function stopEvent(t){t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function elementIsContainedIn(t,e){return element.contains?t.contains(e):!!(16&t.compareDocumentPosition(e))}function code(t){var e={38:"up",40:"down",37:"left",39:"right",27:"esc"};return e[t]?e[t]:String.fromCharCode(t)}function random(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function getRect(t){if("function"==typeof t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=window.pageXOffset,s=window.pageYOffset;return{width:e.width,height:e.height,left:e.left+i,top:e.top+s}}for(var e={width:t.offsetWidth,height:t.offsetHeight,left:0,top:0},n=t;n;)e.left+=n.offsetLeft,e.top+=n.offsetTop,n=n.offsetParent;return e}function getCompatElement(){var t=document;return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.documentElement}function getScrollSize(){var t=getCompatElement(),e={x:t.clientWidth,y:t.clientHeight},i=document.body;return{x:Math.max(t.scrollWidth,i.scrollWidth,e.x),y:Math.max(t.scrollHeight,i.scrollHeight,e.y)}}function setStyles(t,e){for(var i in e)if(e.hasOwnProperty(i)){var s=e[i];"number"==typeof s&&"opacity"!==i&&"zIndex"!==i&&(s+="px"),t.style[i]=s}}function hasClass(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function addClass(t,e){hasClass(t,e)||(t.className+=" "+e)}function cloneElement(t){return t.cloneNode(!0)}function newElement(t,e){var i=document.createElement(t);for(var s in e)e.hasOwnProperty(s)&&("styles"===s?setStyles(i,e[s]):i[s]=e[s]);return i}function delay(t,e,i){return setTimeout(bind(i,e),t)}!function(){function t(){if(t.is(arguments[0],G)){for(var e=arguments[0],i=$e[v](t,e.splice(0,3+t.is(e[0],I))),s=i.set(),n=0,r=e[z];r>n;n++){var a=e[n]||{};l[f](a.type)&&s[W](i[a.type]().attr(a))}return s}return $e[v](t,arguments)}function e(){for(var t=[],e=0;32>e;e++)t[e]=(~~(16*B.random()))[F](16);return t[12]=4,t[16]=(8|3&t[16])[F](16),"r-"+t[T]("")}function i(t,e,i){function s(){var n=Array[u].slice.call(arguments,0),r=n[T]("►"),a=s.cache=s.cache||{},o=s.count=s.count||[];return a[f](r)?i?i(a[r]):a[r]:(o[z]>=1e3&&delete a[o.shift()],o[W](r),a[r]=t[v](e,n),i?i(a[r]):a[r])}return s}function s(e,i,s,n,r){return r?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+r,i,s-2*r,r,-r,n-2*r,2*r-s,2*r-n):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,i,s,n,-s)}function n(){return this.x+k+this.y}function r(e){return function(i,s,n,r){var a={back:e};return t.is(n,"function")?r=n:a.rot=n,i&&i.constructor==We&&(i=i.attrs.path),i&&(a.along=i),this.animate(a,s,r)}}function a(t,e,i,s,n,r){function a(t){return((u*t+c)*t+l)*t}function o(t,e){var i=h(t,e);return((p*i+d)*i+f)*i}function h(t,e){var i,s,n,r,o,h;for(n=t,h=0;8>h;h++){if(r=a(n)-t,_(r)<e)return n;if(o=(3*u*n+2*c)*n+l,_(o)<1e-6)break;n-=r/o}if(i=0,s=1,n=t,i>n)return i;if(n>s)return s;for(;s>i;){if(r=a(n),_(r-t)<e)return n;t>r?i=n:s=n,n=(s-i)/2+i}return n}var l=3*e,c=3*(s-e)-l,u=1-l-c,f=3*i,d=3*(n-i)-f,p=1-f-d;return o(t,1/(200*r))}t.version="1.5.2";var o,h=/[, ]+/,l={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},c=/\{(\d+)\}/g,u="prototype",f="hasOwnProperty",d=document,p=window,m={was:Object[u][f].call(p,"Raphael"),is:p.Raphael},g=function(){this.customAttributes={}},y="appendChild",v="apply",w="concat",x="createTouch"in d,b="",k=" ",C=String,E="split",S="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[E](k),M={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},T="join",z="length",P=C[u].toLowerCase,B=Math,A=B.max,N=B.min,_=B.abs,R=B.pow,O=B.PI,I="number",L="string",G="array",F="toString",D="fill",V=Object[u][F],W="push",H=/^url\(['"]?([^\)]+?)['"]?\)$/i,K=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,j={NaN:1,Infinity:1,"-Infinity":1},q=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,U=B.round,Y="setAttribute",X=parseFloat,$=parseInt,J=" progid:DXImageTransform.Microsoft",Q=C[u].toUpperCase,Z={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},te={along:"along",blur:I,"clip-rect":"csv",cx:I,cy:I,fill:"colour","fill-opacity":I,"font-size":I,height:I,opacity:I,path:"path",r:I,rotation:"csv",rx:I,ry:I,scale:"csv",stroke:"colour","stroke-opacity":I,"stroke-width":I,translation:"csv",width:I,x:I,y:I},ee="replace",ie=/^(from|to|\d+%?)$/,se=/\s*,\s*/,ne={hs:1,rg:1},re=/,?([achlmqrstvxz]),?/gi,ae=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,oe=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,he=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,le=function(t,e){return t.key-e.key};if(t.type=p.SVGAngle||d.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ce,ue=d.createElement("div");if(ue.innerHTML='<v:shape adj="1"/>',ce=ue.firstChild,ce.style.behavior="url(#default#VML)",!ce||"object"!=typeof ce.adj)return t.type=null;ue=null}t.svg=!(t.vml="VML"==t.type),g[u]=t[u],o=g[u],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=P.call(e),"finite"==e?!j[f](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||V.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,i,s,n,r,a){if(null==r){var o=e-s,h=i-n;return o||h?(180*(0>o)+180*B.atan(-h/-o)/O+360)%360:0}return t.angle(e,i,r,a)-t.angle(s,n,r,a)},t.rad=function(t){return t%360*O/180},t.deg=function(t){return 180*t/O%360},t.snapTo=function(e,i,s){if(s=t.is(s,"finite")?s:10,t.is(e,G)){for(var n=e.length;n--;)if(_(e[n]-i)<=s)return e[n]}else{e=+e;var r=i%e;if(s>r)return i-r;if(r>e-s)return i-r+e}return i},t.setWindow=function(t){p=t,d=p.document};var fe=function(e){if(t.vml){var s,n=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),s=r.body}catch(a){s=createPopup().document.body}var o=s.createTextRange();fe=i(function(t){try{s.style.color=C(t)[ee](n,b);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e[F](16)).slice(-6)}catch(i){return"none"}})}else{var h=d.createElement("i");h.title="Raphaël Colour Picker",h.style.display="none",d.body[y](h),fe=i(function(t){return h.style.color=t,d.defaultView.getComputedStyle(h,b).getPropertyValue("color")})}return fe(e)},de=function(){return"hsb("+[this.h,this.s,this.b]+")"},pe=function(){return"hsl("+[this.h,this.s,this.l]+")"},me=function(){return this.hex};t.hsb2rgb=function(e,i,s,n){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(s=e.b,i=e.s,e=e.h,n=e.o),t.hsl2rgb(e,i,s/2,n)},t.hsl2rgb=function(e,i,s,n){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(s=e.l,i=e.s,e=e.h),(e>1||i>1||s>1)&&(e/=360,i/=100,s/=100);var r,a,o,h={},l=["r","g","b"];if(i){r=.5>s?s*(1+i):s+i-s*i,a=2*s-r;for(var c=0;3>c;c++)o=e+1/3*-(c-1),0>o&&o++,o>1&&o--,h[l[c]]=1>6*o?a+6*(r-a)*o:1>2*o?r:2>3*o?a+6*(r-a)*(2/3-o):a}else h={r:s,g:s,b:s};return h.r*=255,h.g*=255,h.b*=255,h.hex="#"+(16777216|h.b|h.g<<8|h.r<<16).toString(16).slice(1),t.is(n,"finite")&&(h.opacity=n),h.toString=me,h},t.rgb2hsb=function(e,i,s){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,i=e.g,e=e.r),null==i&&t.is(e,L)){var n=t.getRGB(e);e=n.r,i=n.g,s=n.b}(e>1||i>1||s>1)&&(e/=255,i/=255,s/=255);var r,a,o=A(e,i,s),h=N(e,i,s),l=o;if(h==o)return{h:0,s:0,b:o,toString:de};var c=o-h;return a=c/o,r=e==o?(i-s)/c:i==o?2+(s-e)/c:4+(e-i)/c,r/=6,0>r&&r++,r>1&&r--,{h:r,s:a,b:l,toString:de}},t.rgb2hsl=function(e,i,s){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,i=e.g,e=e.r),null==i&&t.is(e,L)){var n=t.getRGB(e);e=n.r,i=n.g,s=n.b}(e>1||i>1||s>1)&&(e/=255,i/=255,s/=255);var r,a,o,h=A(e,i,s),l=N(e,i,s),c=(h+l)/2;if(l==h)o={h:0,s:0,l:c};else{var u=h-l;a=.5>c?u/(h+l):u/(2-h-l),r=e==h?(i-s)/u:i==h?2+(s-e)/u:4+(e-i)/u,r/=6,0>r&&r++,r>1&&r--,o={h:r,s:a,l:c}}return o.toString=pe,o},t._path2string=function(){return this.join(",")[ee](re,"$1")},t.getRGB=i(function(e){if(!e||(e=C(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(ne[f](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=fe(e));var i,s,n,r,a,o,h=e.match(K);return h?(h[2]&&(n=$(h[2].substring(5),16),s=$(h[2].substring(3,5),16),i=$(h[2].substring(1,3),16)),h[3]&&(n=$((a=h[3].charAt(3))+a,16),s=$((a=h[3].charAt(2))+a,16),i=$((a=h[3].charAt(1))+a,16)),h[4]&&(o=h[4][E](se),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),s=X(o[1]),"%"==o[1].slice(-1)&&(s*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),"rgba"==h[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100)),h[5]?(o=h[5][E](se),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),s=X(o[1]),"%"==o[1].slice(-1)&&(s*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsba"==h[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100),t.hsb2rgb(i,s,n,r)):h[6]?(o=h[6][E](se),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),s=X(o[1]),"%"==o[1].slice(-1)&&(s*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsla"==h[1].toLowerCase().slice(0,4)&&(r=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(r/=100),t.hsl2rgb(i,s,n,r)):(h={r:i,g:s,b:n},h.hex="#"+(16777216|n|s<<8|i<<16).toString(16).slice(1),t.is(r,"finite")&&(h.opacity=r),h)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=i(function(e){if(!e)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return t.is(e,G)&&t.is(e[0],G)&&(s=ye(e)),s[z]||C(e)[ee](ae,function(t,e,n){var r=[],a=P.call(e);for(n[ee](oe,function(t,e){e&&r[W](+e)}),"m"==a&&r[z]>2&&(s[W]([e][w](r.splice(0,2))),a="l",e="m"==e?"l":"L");r[z]>=i[a]&&(s[W]([e][w](r.splice(0,i[a]))),i[a]););}),s[F]=t._path2string,s}),t.findDotsAtSegment=function(t,e,i,s,n,r,a,o,h){var l=1-h,c=R(l,3)*t+3*R(l,2)*h*i+3*l*h*h*n+R(h,3)*a,u=R(l,3)*e+3*R(l,2)*h*s+3*l*h*h*r+R(h,3)*o,f=t+2*h*(i-t)+h*h*(n-2*i+t),d=e+2*h*(s-e)+h*h*(r-2*s+e),p=i+2*h*(n-i)+h*h*(a-2*n+i),m=s+2*h*(r-s)+h*h*(o-2*r+s),g=(1-h)*t+h*i,y=(1-h)*e+h*s,v=(1-h)*n+h*a,w=(1-h)*r+h*o,x=90-180*B.atan((f-p)/(d-m))/O;return(f>p||m>d)&&(x+=180),{x:c,y:u,m:{x:f,y:d},n:{x:p,y:m},start:{x:g,y:y},end:{x:v,y:w},alpha:x}};var ge=i(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=Se(t);for(var e,i=0,s=0,n=[],r=[],a=0,o=t[z];o>a;a++)if(e=t[a],"M"==e[0])i=e[1],s=e[2],n[W](i),r[W](s);else{var h=Ee(i,s,e[1],e[2],e[3],e[4],e[5],e[6]);n=n[w](h.min.x,h.max.x),r=r[w](h.min.y,h.max.y),i=e[5],s=e[6]}var l=N[v](0,n),c=N[v](0,r);return{x:l,y:c,width:A[v](0,n)-l,height:A[v](0,r)-c}}),ye=function(e){var i=[];t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));for(var s=0,n=e[z];n>s;s++){i[s]=[];for(var r=0,a=e[s][z];a>r;r++)i[s][r]=e[s][r]}return i[F]=t._path2string,i},ve=i(function(e){t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));var i=[],s=0,n=0,r=0,a=0,o=0;"M"==e[0][0]&&(s=e[0][1],n=e[0][2],r=s,a=n,o++,i[W](["M",s,n]));for(var h=o,l=e[z];l>h;h++){var c=i[h]=[],u=e[h];if(u[0]!=P.call(u[0]))switch(c[0]=P.call(u[0]),c[0]){case"a":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]-s).toFixed(3),c[7]=+(u[7]-n).toFixed(3);break;case"v":c[1]=+(u[1]-n).toFixed(3);break;case"m":r=u[1],a=u[2];default:for(var f=1,d=u[z];d>f;f++)c[f]=+(u[f]-(f%2?s:n)).toFixed(3)}else{c=i[h]=[],"m"==u[0]&&(r=u[1]+s,a=u[2]+n);for(var p=0,m=u[z];m>p;p++)i[h][p]=u[p]}var g=i[h][z];switch(i[h][0]){case"z":s=r,n=a;break;case"h":s+=+i[h][g-1];break;case"v":n+=+i[h][g-1];break;default:s+=+i[h][g-2],n+=+i[h][g-1]}}return i[F]=t._path2string,i},0,ye),we=i(function(e){t.is(e,G)&&t.is(e&&e[0],G)||(e=t.parsePathString(e));var i=[],s=0,n=0,r=0,a=0,o=0;"M"==e[0][0]&&(s=+e[0][1],n=+e[0][2],r=s,a=n,o++,i[0]=["M",s,n]);for(var h=o,l=e[z];l>h;h++){var c=i[h]=[],u=e[h];if(u[0]!=Q.call(u[0]))switch(c[0]=Q.call(u[0]),c[0]){case"A":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]+s),c[7]=+(u[7]+n);break;case"V":c[1]=+u[1]+n;break;case"H":c[1]=+u[1]+s;break;case"M":r=+u[1]+s,a=+u[2]+n;default:for(var f=1,d=u[z];d>f;f++)c[f]=+u[f]+(f%2?s:n)}else for(var p=0,m=u[z];m>p;p++)i[h][p]=u[p];switch(c[0]){case"Z":s=r,n=a;break;case"H":s=c[1];break;case"V":n=c[1];break;case"M":r=i[h][i[h][z]-2],a=i[h][i[h][z]-1];default:s=i[h][i[h][z]-2],n=i[h][i[h][z]-1]}}return i[F]=t._path2string,i},null,ye),xe=function(t,e,i,s){return[t,e,i,s,i,s]},be=function(t,e,i,s,n,r){var a=1/3,o=2/3;return[a*t+o*i,a*e+o*s,a*n+o*i,a*r+o*s,n,r]},ke=function(t,e,s,n,r,a,o,h,l,c){var u,f=120*O/180,d=O/180*(+r||0),p=[],m=i(function(t,e,i){var s=t*B.cos(i)-e*B.sin(i),n=t*B.sin(i)+e*B.cos(i);return{x:s,y:n}});if(c)M=c[0],P=c[1],C=c[2],S=c[3];else{u=m(t,e,-d),t=u.x,e=u.y,u=m(h,l,-d),h=u.x,l=u.y;var g=(B.cos(O/180*r),B.sin(O/180*r),(t-h)/2),y=(e-l)/2,v=g*g/(s*s)+y*y/(n*n);v>1&&(v=B.sqrt(v),s=v*s,n=v*n);var x=s*s,b=n*n,k=(a==o?-1:1)*B.sqrt(_((x*b-x*y*y-b*g*g)/(x*y*y+b*g*g))),C=k*s*y/n+(t+h)/2,S=k*-n*g/s+(e+l)/2,M=B.asin(((e-S)/n).toFixed(9)),P=B.asin(((l-S)/n).toFixed(9));M=C>t?O-M:M,P=C>h?O-P:P,0>M&&(M=2*O+M),0>P&&(P=2*O+P),o&&M>P&&(M-=2*O),!o&&P>M&&(P-=2*O)}var A=P-M;if(_(A)>f){var N=P,R=h,I=l;P=M+f*(o&&P>M?1:-1),h=C+s*B.cos(P),l=S+n*B.sin(P),p=ke(h,l,s,n,r,0,o,R,I,[P,N,C,S])}A=P-M;var L=B.cos(M),G=B.sin(M),F=B.cos(P),D=B.sin(P),V=B.tan(A/4),W=4/3*s*V,H=4/3*n*V,K=[t,e],j=[t+W*G,e-H*L],q=[h+W*D,l-H*F],U=[h,l];if(j[0]=2*K[0]-j[0],j[1]=2*K[1]-j[1],c)return[j,q,U][w](p);p=[j,q,U][w](p)[T]()[E](",");for(var Y=[],X=0,$=p[z];$>X;X++)Y[X]=X%2?m(p[X-1],p[X],d).y:m(p[X],p[X+1],d).x;return Y},Ce=function(t,e,i,s,n,r,a,o,h){var l=1-h;return{x:R(l,3)*t+3*R(l,2)*h*i+3*l*h*h*n+R(h,3)*a,y:R(l,3)*e+3*R(l,2)*h*s+3*l*h*h*r+R(h,3)*o}},Ee=i(function(t,e,i,s,n,r,a,o){var h,l=n-2*i+t-(a-2*n+i),c=2*(i-t)-2*(n-i),u=t-i,f=(-c+B.sqrt(c*c-4*l*u))/2/l,d=(-c-B.sqrt(c*c-4*l*u))/2/l,p=[e,o],m=[t,a];return _(f)>"1e12"&&(f=.5),_(d)>"1e12"&&(d=.5),f>0&&1>f&&(h=Ce(t,e,i,s,n,r,a,o,f),m[W](h.x),p[W](h.y)),d>0&&1>d&&(h=Ce(t,e,i,s,n,r,a,o,d),m[W](h.x),p[W](h.y)),l=r-2*s+e-(o-2*r+s),c=2*(s-e)-2*(r-s),u=e-s,f=(-c+B.sqrt(c*c-4*l*u))/2/l,d=(-c-B.sqrt(c*c-4*l*u))/2/l,_(f)>"1e12"&&(f=.5),_(d)>"1e12"&&(d=.5),f>0&&1>f&&(h=Ce(t,e,i,s,n,r,a,o,f),m[W](h.x),p[W](h.y)),d>0&&1>d&&(h=Ce(t,e,i,s,n,r,a,o,d),m[W](h.x),p[W](h.y)),{min:{x:N[v](0,m),y:N[v](0,p)},max:{x:A[v](0,m),y:A[v](0,p)}}}),Se=i(function(t,e){for(var i=we(t),s=e&&we(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var i,s;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][w](ke[v](0,[e.x,e.y][w](t.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),s=e.y+(e.y-(e.by||e.y)),t=["C",i,s][w](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][w](be(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][w](be(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][w](xe(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][w](xe(e.x,e.y,t[1],e.y));break;case"V":t=["C"][w](xe(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][w](xe(e.x,e.y,e.X,e.Y))}return t}),o=function(t,e){if(t[e][z]>7){t[e].shift();for(var n=t[e];n[z];)t.splice(e++,0,["C"][w](n.splice(0,6)));t.splice(e,1),c=A(i[z],s&&s[z]||0)}},h=function(t,e,n,r,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",r.x,r.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],c=A(i[z],s&&s[z]||0))},l=0,c=A(i[z],s&&s[z]||0);c>l;l++){i[l]=a(i[l],n),o(i,l),s&&(s[l]=a(s[l],r)),s&&o(s,l),h(i,s,n,r,l),h(s,i,r,n,l);var u=i[l],f=s&&s[l],d=u[z],p=s&&f[z];n.x=u[d-2],n.y=u[d-1],n.bx=X(u[d-4])||n.x,n.by=X(u[d-3])||n.y,r.bx=s&&(X(f[p-4])||r.x),r.by=s&&(X(f[p-3])||r.y),r.x=s&&f[p-2],r.y=s&&f[p-1]}return s?[i,s]:i},null,ye),Me=i(function(e){for(var i=[],s=0,n=e[z];n>s;s++){var r={},a=e[s].match(/^([^:]*):?([\d\.]*)/);if(r.color=t.getRGB(a[1]),r.color.error)return null;r.color=r.color.hex,a[2]&&(r.offset=a[2]+"%"),i[W](r)}for(s=1,n=i[z]-1;n>s;s++)if(!i[s].offset){for(var o=X(i[s-1].offset||0),h=0,l=s+1;n>l;l++)if(i[l].offset){h=i[l].offset;break}h||(h=100,l=n),h=X(h);for(var c=(h-o)/(l-s+1);l>s;s++)o+=c,i[s].offset=o+"%"}return i}),Te=function(e,i,s,n){var r;return t.is(e,L)||t.is(e,"object")?(r=t.is(e,L)?d.getElementById(e):e,r.tagName?null==i?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:i,height:s}:void 0):{container:1,x:e,y:i,width:s,height:n}},ze=function(t,e){var i=this;for(var s in e)if(e[f](s)&&!(s in t))switch(typeof e[s]){case"function":!function(e){t[s]=t===i?e:function(){return e[v](i,arguments)}}(e[s]);break;case"object":t[s]=t[s]||{},ze.call(this,t[s],e[s]);break;default:t[s]=e[s]}},Pe=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},Be=function(t,e){e.top!==t&&(Pe(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},Ae=function(t,e){e.bottom!==t&&(Pe(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},Ne=function(t,e,i){Pe(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},_e=function(t,e,i){Pe(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},Re=function(t){return function(){throw new Error("Raphaël: you are calling to method “"+t+"” of removed object")}};if(t.pathToRelative=ve,t.svg){o.svgns="http://www.w3.org/2000/svg",o.xlink="http://www.w3.org/1999/xlink",U=function(t){return+t+.5*(~~t===t)};var Oe=function(t,e){if(!e)return t=d.createElementNS(o.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in e)e[f](i)&&t[Y](i,C(e[i]))};t[F]=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var Ie=function(t,e){var i=Oe("path");e.canvas&&e.canvas[y](i);var s=new We(i,e);return s.type="path",Fe(s,{fill:"none",stroke:"#000",path:t}),s},Le=function(t,i,s){var n="linear",r=.5,a=.5,o=t.style;if(i=C(i)[ee](he,function(t,e,i){if(n="radial",e&&i){r=X(e),a=X(i);var s=2*(a>.5)-1;R(r-.5,2)+R(a-.5,2)>.25&&(a=B.sqrt(.25-R(r-.5,2))*s+.5)&&.5!=a&&(a=a.toFixed(5)-1e-5*s)}return b}),i=i[E](/\s*\-\s*/),"linear"==n){var h=i.shift();if(h=-X(h),isNaN(h))return null;var l=[0,0,B.cos(h*O/180),B.sin(h*O/180)],c=1/(A(_(l[2]),_(l[3]))||1);l[2]*=c,l[3]*=c,l[2]<0&&(l[0]=-l[2],l[2]=0),l[3]<0&&(l[1]=-l[3],l[3]=0)}var u=Me(i);if(!u)return null;var f=t.getAttribute(D);f=f.match(/^url\(#(.*)\)$/),f&&s.defs.removeChild(d.getElementById(f[1]));var p=Oe(n+"Gradient");p.id=e(),Oe(p,"radial"==n?{fx:r,fy:a}:{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),s.defs[y](p);for(var m=0,g=u[z];g>m;m++){var v=Oe("stop");Oe(v,{offset:u[m].offset?u[m].offset:m?"100%":"0%","stop-color":u[m].color||"#fff"}),p[y](v)}return Oe(t,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1}),o.fill=b,o.opacity=1,o.fillOpacity=1,1},Ge=function(e){var i=e.getBBox();Oe(e.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Fe=function(i,s){var n={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},r=i.node,a=i.attrs,o=i.rotate(),l=function(t,e){if(e=n[P.call(e)]){for(var i=t.attrs["stroke-width"]||"1",a={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||s["stroke-linecap"]]||0,o=[],h=e[z];h--;)o[h]=e[h]*i+(h%2?1:-1)*a;Oe(r,{"stroke-dasharray":o[T](",")})}};s[f]("rotation")&&(o=s.rotation);var c=C(o)[E](h);c.length-1?(c[1]=+c[1],c[2]=+c[2]):c=null,X(o)&&i.rotate(0,!0);for(var u in s)if(s[f](u)){if(!Z[f](u))continue;var p=s[u];switch(a[u]=p,u){case"blur":i.blur(p);break;case"rotation":i.rotate(p,!0);break;case"href":case"title":case"target":var m=r.parentNode;if("a"!=P.call(m.tagName)){var g=Oe("a");m.insertBefore(g,r),g[y](r),m=g}"target"==u&&"blank"==p?m.setAttributeNS(i.paper.xlink,"show","new"):m.setAttributeNS(i.paper.xlink,u,p);break;case"cursor":r.style.cursor=p;break;case"clip-rect":var v=C(p)[E](h);if(4==v[z]){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var w=Oe("clipPath"),x=Oe("rect");w.id=e(),Oe(x,{x:v[0],y:v[1],width:v[2],height:v[3]}),w[y](x),i.paper.defs[y](w),Oe(r,{"clip-path":"url(#"+w.id+")"}),i.clip=x}if(!p){var S=d.getElementById(r.getAttribute("clip-path")[ee](/(^url\(#|\)$)/g,b));S&&S.parentNode.removeChild(S),Oe(r,{"clip-path":b}),delete i.clip}break;case"path":"path"==i.type&&Oe(r,{d:p?a.path=we(p):"M0,0"});break;case"width":if(r[Y](u,p),!a.fx)break;u="x",p=a.x;case"x":a.fx&&(p=-a.x-(a.width||0));case"rx":if("rx"==u&&"rect"==i.type)break;case"cx":c&&("x"==u||"cx"==u)&&(c[1]+=p-a[u]),r[Y](u,p),i.pattern&&Ge(i);break;case"height":if(r[Y](u,p),!a.fy)break;u="y",p=a.y;case"y":a.fy&&(p=-a.y-(a.height||0));case"ry":if("ry"==u&&"rect"==i.type)break;case"cy":c&&("y"==u||"cy"==u)&&(c[2]+=p-a[u]),r[Y](u,p),i.pattern&&Ge(i);break;case"r":"rect"==i.type?Oe(r,{rx:p,ry:p}):r[Y](u,p);break;case"src":"image"==i.type&&r.setAttributeNS(i.paper.xlink,"href",p);break;case"stroke-width":r.style.strokeWidth=p,r[Y](u,p),a["stroke-dasharray"]&&l(i,a["stroke-dasharray"]);break;case"stroke-dasharray":l(i,p);break;case"translation":var M=C(p)[E](h);M[0]=+M[0]||0,M[1]=+M[1]||0,c&&(c[1]+=M[0],c[2]+=M[1]),zi.call(i,M[0],M[1]);break;case"scale":M=C(p)[E](h),i.scale(+M[0]||1,+M[1]||+M[0]||1,isNaN(X(M[2]))?null:+M[2],isNaN(X(M[3]))?null:+M[3]);break;case D:var B=C(p).match(H);if(B){w=Oe("pattern");var A=Oe("image");w.id=e(),Oe(w,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Oe(A,{x:0,y:0}),A.setAttributeNS(i.paper.xlink,"href",B[1]),w[y](A);var N=d.createElement("img");N.style.cssText="position:absolute;left:-9999em;top-9999em",N.onload=function(){Oe(w,{width:this.offsetWidth,height:this.offsetHeight}),Oe(A,{width:this.offsetWidth,height:this.offsetHeight}),d.body.removeChild(this),i.paper.safari()},d.body[y](N),N.src=B[1],i.paper.defs[y](w),r.style.fill="url(#"+w.id+")",Oe(r,{fill:"url(#"+w.id+")"}),i.pattern=w,i.pattern&&Ge(i);break}var _=t.getRGB(p);if(_.error){if(({circle:1,ellipse:1}[f](i.type)||"r"!=C(p).charAt())&&Le(r,p,i.paper)){a.gradient=p,a.fill="none";break}}else delete s.gradient,delete a.gradient,!t.is(a.opacity,"undefined")&&t.is(s.opacity,"undefined")&&Oe(r,{opacity:a.opacity}),!t.is(a["fill-opacity"],"undefined")&&t.is(s["fill-opacity"],"undefined")&&Oe(r,{"fill-opacity":a["fill-opacity"]});_[f]("opacity")&&Oe(r,{"fill-opacity":_.opacity>1?_.opacity/100:_.opacity});case"stroke":_=t.getRGB(p),r[Y](u,_.hex),"stroke"==u&&_[f]("opacity")&&Oe(r,{"stroke-opacity":_.opacity>1?_.opacity/100:_.opacity});break;case"gradient":(({circle:1,ellipse:1})[f](i.type)||"r"!=C(p).charAt())&&Le(r,p,i.paper);break;case"opacity":a.gradient&&!a[f]("stroke-opacity")&&Oe(r,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(a.gradient){var R=d.getElementById(r.getAttribute(D)[ee](/^url\(#|\)$/g,b));if(R){var O=R.getElementsByTagName("stop");O[O[z]-1][Y]("stop-opacity",p)}break}default:"font-size"==u&&(p=$(p,10)+"px");var I=u[ee](/(\-.)/g,function(t){return Q.call(t.substring(1))});r.style[I]=p,r[Y](u,p)}}Ve(i,s),c?i.rotate(c.join(k)):X(o)&&i.rotate(o,!0)},De=1.2,Ve=function(e,i){if("text"==e.type&&(i[f]("text")||i[f]("font")||i[f]("font-size")||i[f]("x")||i[f]("y"))){var s=e.attrs,n=e.node,r=n.firstChild?$(d.defaultView.getComputedStyle(n.firstChild,b).getPropertyValue("font-size"),10):10;if(i[f]("text")){for(s.text=i.text;n.firstChild;)n.removeChild(n.firstChild);for(var a=C(i.text)[E]("\n"),o=0,h=a[z];h>o;o++)if(a[o]){var l=Oe("tspan");o&&Oe(l,{dy:r*De,x:s.x}),l[y](d.createTextNode(a[o])),n[y](l)}}else for(a=n.getElementsByTagName("tspan"),o=0,h=a[z];h>o;o++)o&&Oe(a[o],{dy:r*De,x:s.x});Oe(n,{y:s.y});var c=e.getBBox(),u=s.y-(c.y+c.height/2);u&&t.is(u,"finite")&&Oe(n,{y:s.y+u})}},We=function(e,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},He=We[u];We[u].rotate=function(e,i,s){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](k):this._.rt.deg;var n=this.getBBox();return e=C(e)[E](h),e[z]-1&&(i=X(e[1]),s=X(e[2])),e=X(e[0]),null!=i&&i!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==s&&(i=null),this._.rt.cx=i,this._.rt.cy=s,i=null==i?n.x+n.width/2:i,s=null==s?n.y+n.height/2:s,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,s),this.clip&&Oe(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,s)})):(this.transformations[0]=b,this.clip&&Oe(this.clip,{transform:b})),Oe(this.node,{transform:this.transformations[T](k)}),this},We[u].hide=function(){return!this.removed&&(this.node.style.display="none"),this},We[u].show=function(){return!this.removed&&(this.node.style.display=""),this},We[u].remove=function(){if(!this.removed){Pe(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},We[u].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ge(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(i){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var s=0,n=this.node.getNumberOfChars();n>s;s++){var r=this.node.getExtentOfChar(s);r.y<e.y&&(e.y=r.y),r.y+r.height-e.y>e.height&&(e.height=r.y+r.height-e.y),r.x+r.width-e.x>e.width&&(e.width=r.x+r.width-e.x)}}return t&&this.hide(),e},We[u].attr=function(e,i){if(this.removed)return this;if(null==e){var s={};for(var n in this.attrs)this.attrs[f](n)&&(s[n]=this.attrs[n]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==i&&t.is(e,L))return"translation"==e?zi.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==D&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==i&&t.is(e,G)){for(var r={},a=0,o=e.length;o>a;a++)r[e[a]]=this.attr(e[a]);return r}if(null!=i){var h={};h[e]=i}else null!=e&&t.is(e,"object")&&(h=e);for(var l in this.paper.customAttributes)if(this.paper.customAttributes[f](l)&&h[f](l)&&t.is(this.paper.customAttributes[l],"function")){var c=this.paper.customAttributes[l].apply(this,[][w](h[l]));this.attrs[l]=h[l];for(var u in c)c[f](u)&&(h[u]=c[u])}return Fe(this,h),this},We[u].toFront=function(){if(this.removed)return this;this.node.parentNode[y](this.node);var t=this.paper;return t.top!=this&&Be(this,t),this},We[u].toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Ae(this,this.paper),this.paper),this)},We[u].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[y](this.node),Ne(this,t,this.paper),this},We[u].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),_e(this,t,this.paper),this},We[u].blur=function(t){var i=this;if(0!==+t){var s=Oe("filter"),n=Oe("feGaussianBlur");i.attrs.blur=t,s.id=e(),Oe(n,{stdDeviation:+t||1.5}),s.appendChild(n),i.paper.defs.appendChild(s),i._blur=s,Oe(i.node,{filter:"url(#"+s.id+")"})}else i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")};var Ke=function(t,e,i,s){var n=Oe("circle");t.canvas&&t.canvas[y](n);var r=new We(n,t);return r.attrs={cx:e,cy:i,r:s,fill:"none",stroke:"#000"},r.type="circle",Oe(n,r.attrs),r},je=function(t,e,i,s,n,r){var a=Oe("rect");t.canvas&&t.canvas[y](a);var o=new We(a,t);return o.attrs={x:e,y:i,width:s,height:n,r:r||0,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},o.type="rect",Oe(a,o.attrs),o},qe=function(t,e,i,s,n){var r=Oe("ellipse");t.canvas&&t.canvas[y](r);var a=new We(r,t);return a.attrs={cx:e,cy:i,rx:s,ry:n,fill:"none",stroke:"#000"},a.type="ellipse",Oe(r,a.attrs),a},Ue=function(t,e,i,s,n,r){var a=Oe("image");Oe(a,{x:i,y:s,width:n,height:r,preserveAspectRatio:"none"}),a.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[y](a);var o=new We(a,t);return o.attrs={x:i,y:s,width:n,height:r,src:e},o.type="image",o},Ye=function(t,e,i,s){var n=Oe("text");Oe(n,{x:e,y:i,"text-anchor":"middle"}),t.canvas&&t.canvas[y](n);var r=new We(n,t);return r.attrs={x:e,y:i,"text-anchor":"middle",text:s,font:Z.font,stroke:"none",fill:"#000"},r.type="text",Fe(r,r.attrs),r},Xe=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas[Y]("width",this.width),this.canvas[Y]("height",this.height),this},$e=function(){var e=Te[v](0,arguments),i=e&&e.container,s=e.x,n=e.y,r=e.width,a=e.height;if(!i)throw new Error("SVG container not found.");var o=Oe("svg");return s=s||0,n=n||0,r=r||512,a=a||342,Oe(o,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:r,height:a}),1==i?(o.style.cssText="position:absolute;left:"+s+"px;top:"+n+"px",d.body[y](o)):i.firstChild?i.insertBefore(o,i.firstChild):i[y](o),i=new g,i.width=r,i.height=a,i.canvas=o,ze.call(i,i,t.fn),i.clear(),i};o.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=Oe("desc"))[y](d.createTextNode("Created with Raphaël")),t[y](this.desc),t[y](this.defs=Oe("defs"))},o.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Re(t)}}if(t.vml){var Je={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Qe=/([clmz]),?([^clmz]*)/gi,Ze=/ progid:\S+Blur\([^\)]+\)/g,ti=/-?[^,\s-]+/g,ei=1e3+k+1e3,si=10,ni={path:1,rect:1},ri=function(t){var e=/[ahqstv]/gi,i=we;if(C(t).match(e)&&(i=Se),e=/[clmz]/g,i==we&&!C(t).match(e)){var s=C(t)[ee](Qe,function(t,e,i){var s=[],n="m"==P.call(e),r=Je[e];return i[ee](ti,function(t){n&&2==s[z]&&(r+=s+Je["m"==e?"l":"L"],s=[]),s[W](U(t*si))}),r+s});return s}var n,r,a=i(t);s=[];for(var o=0,h=a[z];h>o;o++){n=a[o],r=P.call(a[o][0]),"z"==r&&(r="x");for(var l=1,c=n[z];c>l;l++)r+=U(n[l]*si)+(l!=c-1?",":b);s[W](r)}return s[T](k)};t[F]=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version},Ie=function(t,e){var i=ai("group");i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=e.coordsize,i.coordorigin=e.coordorigin;var s=ai("shape"),n=s.style;
n.width=e.width+"px",n.height=e.height+"px",s.coordsize=ei,s.coordorigin=e.coordorigin,i[y](s);var r=new We(s,i,e),a={fill:"none",stroke:"#000"};return t&&(a.path=t),r.type="path",r.path=[],r.Path=b,Fe(r,a),e.canvas[y](i),r},Fe=function(e,i){e.attrs=e.attrs||{};var n,r=e.node,a=e.attrs,o=r.style,l=(i.x!=a.x||i.y!=a.y||i.width!=a.width||i.height!=a.height||i.r!=a.r)&&"rect"==e.type,c=e;for(var u in i)i[f](u)&&(a[u]=i[u]);if(l&&(a.path=s(a.x,a.y,a.width,a.height,a.r),e.X=a.x,e.Y=a.y,e.W=a.width,e.H=a.height),i.href&&(r.href=i.href),i.title&&(r.title=i.title),i.target&&(r.target=i.target),i.cursor&&(o.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||l)&&(r.path=ri(a.path)),null!=i.rotation&&e.rotate(i.rotation,!0),i.translation&&(n=C(i.translation)[E](h),zi.call(e,n[0],n[1]),null!=e._.rt.cx&&(e._.rt.cx+=+n[0],e._.rt.cy+=+n[1],e.setBox(e.attrs,n[0],n[1]))),i.scale&&(n=C(i.scale)[E](h),e.scale(+n[0]||1,+n[1]||+n[0]||1,+n[2]||null,+n[3]||null)),"clip-rect"in i){var p=C(i["clip-rect"])[E](h);if(4==p[z]){p[2]=+p[2]+ +p[0],p[3]=+p[3]+ +p[1];var m=r.clipRect||d.createElement("div"),g=m.style,v=r.parentNode;g.clip=t.format("rect({1}px {2}px {3}px {0}px)",p),r.clipRect||(g.position="absolute",g.top=0,g.left=0,g.width=e.paper.width+"px",g.height=e.paper.height+"px",v.parentNode.insertBefore(m,v),m[y](v),r.clipRect=m)}i["clip-rect"]||r.clipRect&&(r.clipRect.style.clip=b)}if("image"==e.type&&i.src&&(r.src=i.src),"image"==e.type&&i.opacity&&(r.filterOpacity=J+".Alpha(opacity="+100*i.opacity+")",o.filter=(r.filterMatrix||b)+(r.filterOpacity||b)),i.font&&(o.font=i.font),i["font-family"]&&(o.fontFamily='"'+i["font-family"][E](",")[0][ee](/^['"]+|['"]+$/g,b)+'"'),i["font-size"]&&(o.fontSize=i["font-size"]),i["font-weight"]&&(o.fontWeight=i["font-weight"]),i["font-style"]&&(o.fontStyle=i["font-style"]),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){r=e.shape||r;var w=r.getElementsByTagName(D)&&r.getElementsByTagName(D)[0],x=!1;if(!w&&(x=w=ai(D)),"fill-opacity"in i||"opacity"in i){var k=((+a["fill-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+t.getRGB(i.fill).o+1||2)-1);k=N(A(k,0),1),w.opacity=k}if(i.fill&&(w.on=!0),(null==w.on||"none"==i.fill)&&(w.on=!1),w.on&&i.fill){var S=i.fill.match(H);S?(w.src=S[1],w.type="tile"):(w.color=t.getRGB(i.fill).hex,w.src=b,w.type="solid",t.getRGB(i.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=C(i.fill).charAt())&&Le(c,i.fill)&&(a.fill="none",a.gradient=i.fill))}x&&r[y](w);var M=r.getElementsByTagName("stroke")&&r.getElementsByTagName("stroke")[0],T=!1;!M&&(T=M=ai("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(M.on=!0),("none"==i.stroke||null==M.on||0==i.stroke||0==i["stroke-width"])&&(M.on=!1);var P=t.getRGB(i.stroke);M.on&&i.stroke&&(M.color=P.hex),k=((+a["stroke-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+P.o+1||2)-1);var B=.75*(X(i["stroke-width"])||1);if(k=N(A(k,0),1),null==i["stroke-width"]&&(B=a["stroke-width"]),i["stroke-width"]&&(M.weight=B),B&&1>B&&(k*=B)&&(M.weight=1),M.opacity=k,i["stroke-linejoin"]&&(M.joinstyle=i["stroke-linejoin"]||"miter"),M.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(M.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var _={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};M.dashstyle=_[f](i["stroke-dasharray"])?_[i["stroke-dasharray"]]:b}T&&r[y](M)}if("text"==c.type)switch(o=c.paper.span.style,a.font&&(o.font=a.font),a["font-family"]&&(o.fontFamily=a["font-family"]),a["font-size"]&&(o.fontSize=a["font-size"]),a["font-weight"]&&(o.fontWeight=a["font-weight"]),a["font-style"]&&(o.fontStyle=a["font-style"]),c.node.string&&(c.paper.span.innerHTML=C(c.node.string)[ee](/</g,"&#60;")[ee](/&/g,"&#38;")[ee](/\n/g,"<br>")),c.W=a.w=c.paper.span.offsetWidth,c.H=a.h=c.paper.span.offsetHeight,c.X=a.x,c.Y=a.y+U(c.H/2),a["text-anchor"]){case"start":c.node.style["v-text-align"]="left",c.bbx=U(c.W/2);break;case"end":c.node.style["v-text-align"]="right",c.bbx=-U(c.W/2);break;default:c.node.style["v-text-align"]="center"}},Le=function(t,e){t.attrs=t.attrs||{};var i,s=(t.attrs,"linear"),n=".5 .5";if(t.attrs.gradient=e,e=C(e)[ee](he,function(t,e,i){return s="radial",e&&i&&(e=X(e),i=X(i),R(e-.5,2)+R(i-.5,2)>.25&&(i=B.sqrt(.25-R(e-.5,2))*(2*(i>.5)-1)+.5),n=e+k+i),b}),e=e[E](/\s*\-\s*/),"linear"==s){var r=e.shift();if(r=-X(r),isNaN(r))return null}var a=Me(e);if(!a)return null;if(t=t.shape||t.node,i=t.getElementsByTagName(D)[0]||ai(D),!i.parentNode&&t.appendChild(i),a[z]){i.on=!0,i.method="none",i.color=a[0].color,i.color2=a[a[z]-1].color;for(var o=[],h=0,l=a[z];l>h;h++)a[h].offset&&o[W](a[h].offset+k+a[h].color);i.colors&&(i.colors.value=o[z]?o[T]():"0% "+i.color),"radial"==s?(i.type="gradientradial",i.focus="100%",i.focussize=n,i.focusposition=n):(i.type="gradient",i.angle=(270-r)%360)}return 1},We=function(e,i,s){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=i,this.paper=s,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!s.bottom&&(s.bottom=this),this.prev=s.top,s.top&&(s.top.next=this),s.top=this,this.next=null},He=We[u],He.rotate=function(t,e,i){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](k):this._.rt.deg:(t=C(t)[E](h),t[z]-1&&(e=X(t[1]),i=X(t[2])),t=X(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==i&&(e=null),this._.rt.cx=e,this._.rt.cy=i,this.setBox(this.attrs,e,i),this.Group.style.rotation=this._.rt.deg,this)},He.setBox=function(t,e,i){if(this.removed)return this;var s=this.Group.style,n=this.shape&&this.shape.style||this.node.style;t=t||{};for(var r in t)t[f](r)&&(this.attrs[r]=t[r]);e=e||this._.rt.cx,i=i||this._.rt.cy;var a,o,h,l,c=this.attrs;switch(this.type){case"circle":a=c.cx-c.r,o=c.cy-c.r,h=l=2*c.r;break;case"ellipse":a=c.cx-c.rx,o=c.cy-c.ry,h=2*c.rx,l=2*c.ry;break;case"image":a=+c.x,o=+c.y,h=c.width||0,l=c.height||0;break;case"text":this.textpath.v=["m",U(c.x),", ",U(c.y-2),"l",U(c.x)+1,", ",U(c.y-2)][T](b),a=c.x-U(this.W/2),o=c.y-this.H/2,h=this.W,l=this.H;break;case"rect":case"path":if(this.attrs.path){var u=ge(this.attrs.path);a=u.x,o=u.y,h=u.width,l=u.height}else a=0,o=0,h=this.paper.width,l=this.paper.height;break;default:a=0,o=0,h=this.paper.width,l=this.paper.height}e=null==e?a+h/2:e,i=null==i?o+l/2:i;var d,p=e-this.paper.width/2,m=i-this.paper.height/2;s.left!=(d=p+"px")&&(s.left=d),s.top!=(d=m+"px")&&(s.top=d),this.X=ni[f](this.type)?-p:a,this.Y=ni[f](this.type)?-m:o,this.W=h,this.H=l,ni[f](this.type)?(n.left!=(d=-p*si+"px")&&(n.left=d),n.top!=(d=-m*si+"px")&&(n.top=d)):"text"==this.type?(n.left!=(d=-p+"px")&&(n.left=d),n.top!=(d=-m+"px")&&(n.top=d)):(s.width!=(d=this.paper.width+"px")&&(s.width=d),s.height!=(d=this.paper.height+"px")&&(s.height=d),n.left!=(d=a-p+"px")&&(n.left=d),n.top!=(d=o-m+"px")&&(n.top=d),n.width!=(d=h+"px")&&(n.width=d),n.height!=(d=l+"px")&&(n.height=d))},He.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},He.show=function(){return!this.removed&&(this.Group.style.display="block"),this},He.getBBox=function(){return this.removed?this:ni[f](this.type)?ge(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},He.remove=function(){if(!this.removed){Pe(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},He.attr=function(e,i){if(this.removed)return this;if(null==e){var s={};for(var n in this.attrs)this.attrs[f](n)&&(s[n]=this.attrs[n]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==i&&t.is(e,"string"))return"translation"==e?zi.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==D&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==i&&t.is(e,G)){var r,a={};for(n=0,r=e[z];r>n;n++)a[e[n]]=this.attr(e[n]);return a}var o;if(null!=i&&(o={},o[e]=i),null==i&&t.is(e,"object")&&(o=e),o){for(var h in this.paper.customAttributes)if(this.paper.customAttributes[f](h)&&o[f](h)&&t.is(this.paper.customAttributes[h],"function")){var l=this.paper.customAttributes[h].apply(this,[][w](o[h]));this.attrs[h]=o[h];for(var c in l)l[f](c)&&(o[c]=l[c])}o.text&&"text"==this.type&&(this.node.string=o.text),Fe(this,o),o.gradient&&({circle:1,ellipse:1}[f](this.type)||"r"!=C(o.gradient).charAt())&&Le(this,o.gradient),(!ni[f](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},He.toFront=function(){return!this.removed&&this.Group.parentNode[y](this.Group),this.paper.top!=this&&Be(this,this.paper),this},He.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Ae(this,this.paper)),this)},He.insertAfter=function(t){return this.removed?this:(t.constructor==Pi&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[y](this.Group),Ne(this,t,this.paper),this)},He.insertBefore=function(t){return this.removed?this:(t.constructor==Pi&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),_e(this,t,this.paper),this)},He.blur=function(e){var i=this.node.runtimeStyle,s=i.filter;s=s.replace(Ze,b),0!==+e?(this.attrs.blur=e,i.filter=s+k+J+".Blur(pixelradius="+(+e||1.5)+")",i.margin=t.format("-{0}px 0 0 -{0}px",U(+e||1.5))):(i.filter=s,i.margin=0,delete this.attrs.blur)},Ke=function(t,e,i,s){var n=ai("group"),r=ai("oval");r.style,n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=ei,n.coordorigin=t.coordorigin,n[y](r);var a=new We(r,n,t);return a.type="circle",Fe(a,{stroke:"#000",fill:"none"}),a.attrs.cx=e,a.attrs.cy=i,a.attrs.r=s,a.setBox({x:e-s,y:i-s,width:2*s,height:2*s}),t.canvas[y](n),a},je=function(t,e,i,n,r,a){var o=s(e,i,n,r,a),h=t.path(o),l=h.attrs;return h.X=l.x=e,h.Y=l.y=i,h.W=l.width=n,h.H=l.height=r,l.r=a,l.path=o,h.type="rect",h},qe=function(t,e,i,s,n){var r=ai("group"),a=ai("oval");a.style,r.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",r.coordsize=ei,r.coordorigin=t.coordorigin,r[y](a);var o=new We(a,r,t);return o.type="ellipse",Fe(o,{stroke:"#000"}),o.attrs.cx=e,o.attrs.cy=i,o.attrs.rx=s,o.attrs.ry=n,o.setBox({x:e-s,y:i-n,width:2*s,height:2*n}),t.canvas[y](r),o},Ue=function(t,e,i,s,n,r){var a=ai("group"),o=ai("image");a.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",a.coordsize=ei,a.coordorigin=t.coordorigin,o.src=e,a[y](o);var h=new We(o,a,t);return h.type="image",h.attrs.src=e,h.attrs.x=i,h.attrs.y=s,h.attrs.w=n,h.attrs.h=r,h.setBox({x:i,y:s,width:n,height:r}),t.canvas[y](a),h},Ye=function(e,i,s,n){var r=ai("group"),a=ai("shape"),o=a.style,h=ai("path"),l=(h.style,ai("textpath"));r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=ei,r.coordorigin=e.coordorigin,h.v=t.format("m{0},{1}l{2},{1}",U(10*i),U(10*s),U(10*i)+1),h.textpathok=!0,o.width=e.width,o.height=e.height,l.string=C(n),l.on=!0,a[y](l),a[y](h),r[y](a);var c=new We(l,r,e);return c.shape=a,c.textpath=h,c.type="text",c.attrs.text=n,c.attrs.x=i,c.attrs.y=s,c.attrs.w=1,c.attrs.h=1,Fe(c,{font:Z.font,stroke:"none",fill:"#000"}),c.setBox(),e.canvas[y](r),c},Xe=function(t,e){var i=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),i.width=t,i.height=e,i.clip="rect(0 "+t+" "+e+" 0)",this};var ai;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ai=function(t){return d.createElement("<rvml:"+t+' class="rvml">')}}catch(oi){ai=function(t){return d.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}$e=function(){var e=Te[v](0,arguments),i=e.container,s=e.height,n=e.width,r=e.x,a=e.y;if(!i)throw new Error("VML container not found.");var o=new g,h=o.canvas=d.createElement("div"),l=h.style;return r=r||0,a=a||0,n=n||512,s=s||342,n==+n&&(n+="px"),s==+s&&(s+="px"),o.width=1e3,o.height=1e3,o.coordsize=1e3*si+k+1e3*si,o.coordorigin="0 0",o.span=d.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",h[y](o.span),l.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,s),1==i?(d.body[y](h),l.left=r+"px",l.top=a+"px",l.position="absolute"):i.firstChild?i.insertBefore(h,i.firstChild):i[y](h),ze.call(o,o,t.fn),o},o.clear=function(){this.canvas.innerHTML=b,this.span=d.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[y](this.span),this.bottom=this.top=null},o.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Re(t);return!0}}var hi=navigator.userAgent.match(/Version\/(.*?)\s/);o.safari="Apple Computer, Inc."==navigator.vendor&&(hi&&hi[1]<4||"iP"==navigator.platform.slice(0,2))?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});p.setTimeout(function(){t.remove()})}:function(){};for(var li=function(){this.returnValue=!1},ci=function(){return this.originalEvent.preventDefault()},ui=function(){this.cancelBubble=!0},fi=function(){return this.originalEvent.stopPropagation()},di=function(){return d.addEventListener?function(t,e,i,s){var n=x&&M[e]?M[e]:e,r=function(n){if(x&&M[f](e))for(var r=0,a=n.targetTouches&&n.targetTouches.length;a>r;r++)if(n.targetTouches[r].target==t){var o=n;n=n.targetTouches[r],n.originalEvent=o,n.preventDefault=ci,n.stopPropagation=fi;break}return i.call(s,n)};return t.addEventListener(n,r,!1),function(){return t.removeEventListener(n,r,!1),!0}}:d.attachEvent?function(t,e,i,s){var n=function(t){return t=t||p.event,t.preventDefault=t.preventDefault||li,t.stopPropagation=t.stopPropagation||ui,i.call(s,t)};t.attachEvent("on"+e,n);var r=function(){return t.detachEvent("on"+e,n),!0};return r}:void 0}(),pi=[],mi=function(t){for(var e,i=t.clientX,s=t.clientY,n=d.documentElement.scrollTop||d.body.scrollTop,r=d.documentElement.scrollLeft||d.body.scrollLeft,a=pi.length;a--;){if(e=pi[a],x){for(var o,h=t.touches.length;h--;)if(o=t.touches[h],o.identifier==e.el._drag.id){i=o.clientX,s=o.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();i+=r,s+=n,e.move&&e.move.call(e.move_scope||e.el,i-e.el._drag.x,s-e.el._drag.y,i,s,t)}},gi=function(e){t.unmousemove(mi).unmouseup(gi);for(var i,s=pi.length;s--;)i=pi[s],i.el._drag={},i.end&&i.end.call(i.end_scope||i.start_scope||i.move_scope||i.el,e);pi=[]},yi=S[z];yi--;)!function(e){t[e]=We[u][e]=function(i,s){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:e,f:i,unbind:di(this.shape||this.node||d,e,i,s||this)})),this},t["un"+e]=We[u]["un"+e]=function(t){for(var i=this.events,s=i[z];s--;)if(i[s].name==e&&i[s].f==t)return i[s].unbind(),i.splice(s,1),!i.length&&delete this.events,this;return this}}(S[yi]);He.hover=function(t,e,i,s){return this.mouseover(t,i).mouseout(e,s||i)},He.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},He.drag=function(e,i,s,n,r,a){return this._drag={},this.mousedown(function(o){(o.originalEvent||o).preventDefault();var h=d.documentElement.scrollTop||d.body.scrollTop,l=d.documentElement.scrollLeft||d.body.scrollLeft;this._drag.x=o.clientX+l,this._drag.y=o.clientY+h,this._drag.id=o.identifier,i&&i.call(r||n||this,o.clientX+l,o.clientY+h,o),!pi.length&&t.mousemove(mi).mouseup(gi),pi.push({el:this,move:e,end:s,move_scope:n,start_scope:r,end_scope:a})}),this},He.undrag=function(e,i,s){for(var n=pi.length;n--;)pi[n].el==this&&pi[n].move==e&&pi[n].end==s&&pi.splice(n++,1);!pi.length&&t.unmousemove(mi).unmouseup(gi)},o.circle=function(t,e,i){return Ke(this,t||0,e||0,i||0)},o.rect=function(t,e,i,s,n){return je(this,t||0,e||0,i||0,s||0,n||0)},o.ellipse=function(t,e,i,s){return qe(this,t||0,e||0,i||0,s||0)},o.path=function(e){return e&&!t.is(e,L)&&!t.is(e[0],G)&&(e+=b),Ie(t.format[v](t,arguments),this)},o.image=function(t,e,i,s,n){return Ue(this,t||"about:blank",e||0,i||0,s||0,n||0)},o.text=function(t,e,i){return Ye(this,t||0,e||0,C(i))},o.set=function(t){return arguments[z]>1&&(t=Array[u].splice.call(arguments,0,arguments[z])),new Pi(t)},o.setSize=Xe,o.top=o.bottom=null,o.raphael=t,He.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,this.attrs.scale="1 1",void 0)},He.scale=function(t,e,i,s){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:n};e=e||t,!+e&&(e=t);var r,a,o=this.attrs;if(0!=t){var h=this.getBBox(),l=h.x+h.width/2,c=h.y+h.height/2,u=_(t/this._.sx),f=_(e/this._.sy);i=+i||0==i?i:l,s=+s||0==s?s:c;var d=this._.sx>0,p=this._.sy>0,m=~~(t/_(t)),g=~~(e/_(e)),y=u*m,v=f*g,x=this.node.style,C=i+_(l-i)*y*(l>i==d?1:-1),E=s+_(c-s)*v*(c>s==p?1:-1),S=t*m>e*g?f:u;switch(this.type){case"rect":case"image":var M=o.width*u,P=o.height*f;this.attr({height:P,r:o.r*S,width:M,x:C-M/2,y:E-P/2});break;case"circle":case"ellipse":this.attr({rx:o.rx*u,ry:o.ry*f,r:o.r*S,cx:C,cy:E});break;case"text":this.attr({x:C,y:E});break;case"path":for(var B=ve(o.path),A=!0,N=d?y:u,R=p?v:f,O=0,I=B[z];I>O;O++){var L=B[O],G=Q.call(L[0]);if("M"!=G||!A)if(A=!1,"A"==G)L[B[O][z]-2]*=N,L[B[O][z]-1]*=R,L[1]*=u,L[2]*=f,L[5]=+(m+g?!!+L[5]:!+L[5]);else if("H"==G)for(var F=1,D=L[z];D>F;F++)L[F]*=N;else if("V"==G)for(F=1,D=L[z];D>F;F++)L[F]*=R;else for(F=1,D=L[z];D>F;F++)L[F]*=F%2?N:R}var V=ge(B);r=C-V.x-V.width/2,a=E-V.y-V.height/2,B[0][1]+=r,B[0][2]+=a,this.attr({path:B})}this.type in{text:1,image:1}&&(1!=m||1!=g)?this.transformations?(this.transformations[2]="scale("[w](m,",",g,")"),this.node[Y]("transform",this.transformations[T](k)),r=-1==m?-o.x-(M||0):o.x,a=-1==g?-o.y-(P||0):o.y,this.attr({x:r,y:a}),o.fx=m-1,o.fy=g-1):(this.node.filterMatrix=J+".Matrix(M11="[w](m,", M12=0, M21=0, M22=",g,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),x.filter=(this.node.filterMatrix||b)+(this.node.filterOpacity||b)):this.transformations?(this.transformations[2]=b,this.node[Y]("transform",this.transformations[T](k)),o.fx=0,o.fy=0):(this.node.filterMatrix=b,x.filter=(this.node.filterMatrix||b)+(this.node.filterOpacity||b)),o.scale=[t,e,i,s][T](k),this._.sx=t,this._.sy=e}return this},He.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var vi={},wi=function(e,i,s,n,r,a,o,h,l){var c,u,f=0,d=100,p=[e,i,s,n,r,a,o,h].join(),m=vi[p];if(!m&&(vi[p]=m={data:[]}),m.timer&&clearTimeout(m.timer),m.timer=setTimeout(function(){delete vi[p]},2e3),null!=l){var g=wi(e,i,s,n,r,a,o,h);d=10*~~g}for(var y=0;d+1>y;y++){if(m.data[l]>y?u=m.data[y*d]:(u=t.findDotsAtSegment(e,i,s,n,r,a,o,h,y/d),m.data[y]=u),y&&(f+=R(R(c.x-u.x,2)+R(c.y-u.y,2),.5)),null!=l&&f>=l)return u;c=u}return null==l?f:void 0},xi=function(e,i){return function(s,n,r){s=Se(s);for(var a,o,h,l,c,u="",f={},d=0,p=0,m=s.length;m>p;p++){if(h=s[p],"M"==h[0])a=+h[1],o=+h[2];else{if(l=wi(a,o,h[1],h[2],h[3],h[4],h[5],h[6]),d+l>n){if(i&&!f.start){if(c=wi(a,o,h[1],h[2],h[3],h[4],h[5],h[6],n-d),u+=["C",c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y],r)return u;f.start=u,u=["M",c.x,c.y+"C",c.n.x,c.n.y,c.end.x,c.end.y,h[5],h[6]][T](),d+=l,a=+h[5],o=+h[6];continue}if(!e&&!i)return c=wi(a,o,h[1],h[2],h[3],h[4],h[5],h[6],n-d),{x:c.x,y:c.y,alpha:c.alpha}}d+=l,a=+h[5],o=+h[6]}u+=h}return f.end=u,c=e?d:i?f:t.findDotsAtSegment(a,o,h[1],h[2],h[3],h[4],h[5],h[6],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},bi=xi(1),ki=xi(),Ci=xi(0,1);He.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():bi(this.attrs.path):void 0},He.getPointAtLength=function(t){return"path"==this.type?ki(this.attrs.path,t):void 0},He.getSubpath=function(t,e){if("path"==this.type){if(_(this.getTotalLength()-e)<"1e-6")return Ci(this.attrs.path,t).end;var i=Ci(this.attrs.path,e,1);return t?Ci(i,t).end:i}},t.easing_formulas={linear:function(t){return t},"<":function(t){return R(t,3)},">":function(t){return R(t-1,3)+1},"<>":function(t){return t=2*t,1>t?R(t,3)/2:(t-=2,(R(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,i=e/4;return R(2,-10*t)*B.sin((t-i)*2*O/e)+1},bounce:function(t){var e,i=7.5625,s=2.75;return 1/s>t?e=i*t*t:2/s>t?(t-=1.5/s,e=i*t*t+.75):2.5/s>t?(t-=2.25/s,e=i*t*t+.9375):(t-=2.625/s,e=i*t*t+.984375),e}};var Ei=[],Si=function(){for(var e=+new Date,i=0;i<Ei[z];i++){var s=Ei[i];if(!s.stop&&!s.el.removed){var n,r=e-s.start,a=s.ms,o=s.easing,h=s.from,l=s.diff,c=s.to,u=s.t,d=s.el,p={};if(a>r){var m=o(r/a);for(var g in h)if(h[f](g)){switch(te[g]){case"along":n=m*a*l[g],c.back&&(n=c.len-n);var y=ki(c[g],n);d.translate(l.sx-l.x||0,l.sy-l.y||0),l.x=y.x,l.y=y.y,d.translate(y.x-l.sx,y.y-l.sy),c.rot&&d.rotate(l.r+y.alpha,y.x,y.y);break;case I:n=+h[g]+m*a*l[g];break;case"colour":n="rgb("+[Ti(U(h[g].r+m*a*l[g].r)),Ti(U(h[g].g+m*a*l[g].g)),Ti(U(h[g].b+m*a*l[g].b))][T](",")+")";break;case"path":n=[];for(var v=0,w=h[g][z];w>v;v++){n[v]=[h[g][v][0]];for(var x=1,C=h[g][v][z];C>x;x++)n[v][x]=+h[g][v][x]+m*a*l[g][v][x];n[v]=n[v][T](k)}n=n[T](k);break;case"csv":switch(g){case"translation":var E=m*a*l[g][0]-u.x,S=m*a*l[g][1]-u.y;u.x+=E,u.y+=S,n=E+k+S;break;case"rotation":n=+h[g][0]+m*a*l[g][0],h[g][1]&&(n+=","+h[g][1]+","+h[g][2]);break;case"scale":n=[+h[g][0]+m*a*l[g][0],+h[g][1]+m*a*l[g][1],2 in c[g]?c[g][2]:b,3 in c[g]?c[g][3]:b][T](k);break;case"clip-rect":for(n=[],v=4;v--;)n[v]=+h[g][v]+m*a*l[g][v]}break;default:var M=[].concat(h[g]);for(n=[],v=d.paper.customAttributes[g].length;v--;)n[v]=+M[v]+m*a*l[g][v]}p[g]=n}d.attr(p),d._run&&d._run.call(d)}else c.along&&(y=ki(c.along,c.len*!c.back),d.translate(l.sx-(l.x||0)+y.x-l.sx,l.sy-(l.y||0)+y.y-l.sy),c.rot&&d.rotate(l.r+y.alpha,y.x,y.y)),(u.x||u.y)&&d.translate(-u.x,-u.y),c.scale&&(c.scale+=b),d.attr(c),Ei.splice(i--,1)}}t.svg&&d&&d.paper&&d.paper.safari(),Ei[z]&&setTimeout(Si)},Mi=function(e,i,s,n,r){var a=s-n;i.timeouts.push(setTimeout(function(){t.is(r,"function")&&r.call(i),i.animate(e,a,e.easing)},n))},Ti=function(t){return A(N(t,255),0)},zi=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:n};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var i=ve(this.attrs.path);i[0][1]+=+t,i[0][2]+=+e,this.attr({path:i})}return this};He.animateWith=function(t,e,i,s,n){for(var r=0,a=Ei.length;a>r;r++)Ei[r].el.id==t.id&&(e.start=Ei[r].start);return this.animate(e,i,s,n)},He.animateAlong=r(),He.animateAlongBack=r(1),He.onAnimation=function(t){return this._run=t||0,this},He.animate=function(e,i,s,n){var r=this;if(r.timeouts=r.timeouts||[],(t.is(s,"function")||!s)&&(n=s||null),r.removed)return n&&n.call(r),r;var o={},l={},c=!1,u={};for(var d in e)if(e[f](d)&&(te[f](d)||r.paper.customAttributes[f](d)))switch(c=!0,o[d]=r.attr(d),null==o[d]&&(o[d]=Z[d]),l[d]=e[d],te[d]){case"along":var p=bi(e[d]),m=ki(e[d],p*!!e.back),g=r.getBBox();u[d]=p/i,u.tx=g.x,u.ty=g.y,u.sx=m.x,u.sy=m.y,l.rot=e.rot,l.back=e.back,l.len=p,e.rot&&(u.r=X(r.rotate())||0);break;case I:u[d]=(l[d]-o[d])/i;break;case"colour":o[d]=t.getRGB(o[d]);var y=t.getRGB(l[d]);u[d]={r:(y.r-o[d].r)/i,g:(y.g-o[d].g)/i,b:(y.b-o[d].b)/i};break;case"path":var v=Se(o[d],l[d]);o[d]=v[0];var w=v[1];u[d]=[];for(var x=0,b=o[d][z];b>x;x++){u[d][x]=[0];for(var k=1,S=o[d][x][z];S>k;k++)u[d][x][k]=(w[x][k]-o[d][x][k])/i}break;case"csv":var M=C(e[d])[E](h),T=C(o[d])[E](h);switch(d){case"translation":o[d]=[0,0],u[d]=[M[0]/i,M[1]/i];break;case"rotation":o[d]=T[1]==M[1]&&T[2]==M[2]?T:[0,M[1],M[2]],u[d]=[(M[0]-o[d][0])/i,0,0];break;case"scale":e[d]=M,o[d]=C(o[d])[E](h),u[d]=[(M[0]-o[d][0])/i,(M[1]-o[d][1])/i,0,0];break;case"clip-rect":for(o[d]=C(o[d])[E](h),u[d]=[],x=4;x--;)u[d][x]=(M[x]-o[d][x])/i}l[d]=M;break;default:for(M=[].concat(e[d]),T=[].concat(o[d]),u[d]=[],x=r.paper.customAttributes[d][z];x--;)u[d][x]=((M[x]||0)-(T[x]||0))/i}if(c){var P=t.easing_formulas[s];if(!P)if(P=C(s).match(q),P&&5==P[z]){var B=P;P=function(t){return a(t,+B[1],+B[2],+B[3],+B[4],i)}}else P=function(t){return t};Ei.push({start:e.start||+new Date,ms:i,easing:P,from:o,diff:u,to:l,el:r,t:{x:0,y:0}}),t.is(n,"function")&&(r._ac=setTimeout(function(){n.call(r)},i)),1==Ei[z]&&setTimeout(Si)}else{var A,N=[];for(var _ in e)e[f](_)&&ie.test(_)&&(d={value:e[_]},"from"==_&&(_=0),"to"==_&&(_=100),d.key=$(_,10),N.push(d));for(N.sort(le),N[0].key&&N.unshift({key:0,value:r.attrs}),x=0,b=N[z];b>x;x++)Mi(N[x].value,r,i/100*N[x].key,i/100*(N[x-1]&&N[x-1].key||0),N[x-1]&&N[x-1].value.callback);A=N[N[z]-1].value.callback,A&&r.timeouts.push(setTimeout(function(){A.call(r)},i))}return this},He.stop=function(){for(var t=0;t<Ei.length;t++)Ei[t].el.id==this.id&&Ei.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;ii>t;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},He.translate=function(t,e){return this.attr({translation:t+" "+e})},He[F]=function(){return"Raphaël’s object"},t.ae=Ei;var Pi=function(t){if(this.items=[],this[z]=0,this.type="set",t)for(var e=0,i=t[z];i>e;e++)!t[e]||t[e].constructor!=We&&t[e].constructor!=Pi||(this[this.items[z]]=this.items[this.items[z]]=t[e],this[z]++)};Pi[u][W]=function(){for(var t,e,i=0,s=arguments[z];s>i;i++)t=arguments[i],!t||t.constructor!=We&&t.constructor!=Pi||(e=this.items[z],this[e]=this.items[e]=t,this[z]++);return this},Pi[u].pop=function(){return delete this[this[z]--],this.items.pop()};for(var Bi in He)He[f](Bi)&&(Pi[u][Bi]=function(t){return function(){for(var e=0,i=this.items[z];i>e;e++)this.items[e][t][v](this.items[e],arguments);return this}}(Bi));Pi[u].attr=function(e,i){if(e&&t.is(e,G)&&t.is(e[0],"object"))for(var s=0,n=e[z];n>s;s++)this.items[s].attr(e[s]);else for(var r=0,a=this.items[z];a>r;r++)this.items[r].attr(e,i);return this},Pi[u].animate=function(e,i,s,n){(t.is(s,"function")||!s)&&(n=s||null);var r,a,o=this.items[z],h=o,l=this;for(n&&(a=function(){!--o&&n.call(l)}),s=t.is(s,L)?s:a,r=this.items[--h].animate(e,i,s,a);h--;)this.items[h]&&!this.items[h].removed&&this.items[h].animateWith(r,e,i,s,a);return this},Pi[u].insertAfter=function(t){for(var e=this.items[z];e--;)this.items[e].insertAfter(t);return this},Pi[u].getBBox=function(){for(var t=[],e=[],i=[],s=[],n=this.items[z];n--;){var r=this.items[n].getBBox();t[W](r.x),e[W](r.y),i[W](r.x+r.width),s[W](r.y+r.height)}return t=N[v](0,t),e=N[v](0,e),{x:t,y:e,width:A[v](0,i)-t,height:A[v](0,s)-e}},Pi[u].clone=function(t){t=new Pi;for(var e=0,i=this.items[z];i>e;e++)t[W](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var s in t.face)t.face[f](s)&&(e.face[s]=t.face[s]);if(this.fonts[i]?this.fonts[i][W](e):this.fonts[i]=[e],!t.svg){e.face["units-per-em"]=$(t.face["units-per-em"],10);for(var n in t.glyphs)if(t.glyphs[f](n)){var r=t.glyphs[n];if(e.glyphs[n]={w:r.w,k:{},d:r.d&&"M"+r.d[ee](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},r.k)for(var a in r.k)r[f](a)&&(e.glyphs[n].k[a]=r.k[a])}}return t},o.getFont=function(e,i,s,n){if(n=n||"normal",s=s||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,t.fonts){var r=t.fonts[e];if(!r){var a=new RegExp("(^|\\s)"+e[ee](/[^\w\d\s+!~.:_-]/g,b)+"(\\s|$)","i");for(var o in t.fonts)if(t.fonts[f](o)&&a.test(o)){r=t.fonts[o];break}}var h;if(r)for(var l=0,c=r[z];c>l&&(h=r[l],h.face["font-weight"]!=i||h.face["font-style"]!=s&&h.face["font-style"]||h.face["font-stretch"]!=n);l++);return h}},o.print=function(e,i,s,n,r,a,o){a=a||"middle",o=A(N(o||0,1),-1);var l,c=this.set(),u=C(s)[E](b),f=0;if(t.is(n,s)&&(n=this.getFont(n)),n){l=(r||16)/n.face["units-per-em"];for(var d=n.face.bbox.split(h),p=+d[0],m=+d[1]+("baseline"==a?d[3]-d[1]+ +n.face.descent:(d[3]-d[1])/2),g=0,y=u[z];y>g;g++){var v=g&&n.glyphs[u[g-1]]||{},w=n.glyphs[u[g]];f+=g?(v.w||n.w)+(v.k&&v.k[u[g]]||0)+n.w*o:0,w&&w.d&&c[W](this.path(w.d).attr({fill:"#000",stroke:"none",translation:[f,0]}))}c.scale(l,l,p,m).translate(e-p,i-m)}return c},t.format=function(e,i){var s=t.is(i,G)?[0][w](i):arguments;return e&&t.is(e,L)&&s[z]-1&&(e=e[ee](c,function(t,e){return null==s[++e]?b:s[e]})),e||b},t.ninja=function(){return m.was?p.Raphael=m.is:delete Raphael,t},t.el=He,t.st=Pi[u],m.was?p.Raphael=t:Raphael=t}(),function(t,e,i,s,n,r){function a(t,e){var i=typeof t[e];return"function"==i||!("object"!=i||!t[e])||"unknown"==i}function o(t,e){return!("object"!=typeof t[e]||!t[e])}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function l(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return z=Array.prototype.slice.call(t.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),P=parseInt(z[0],10)>9&&parseInt(z[1],10)>0,t=null,!0}catch(e){return!1}}function c(){if(!K){K=!0;for(var t=0;t<j.length;t++)j[t]();j.length=0}}function u(t,e){return K?(t.call(e),void 0):(j.push(function(){t.call(e)}),void 0)}function f(){var t=parent;if(""!==G)for(var e=0,i=G.split(".");e<i.length;e++)t=t[i[e]];return t.easyXDM}function d(e){return t.easyXDM=D,G=e,G&&(V="easyXDM_"+G.replace(".","_")+"_"),F}function p(t){return t.match(O)[3]}function m(t){return t.match(O)[4]||""}function g(t){var e=t.toLowerCase().match(O),i=e[2],s=e[3],n=e[4]||"";return("http:"==i&&":80"==n||"https:"==i&&":443"==n)&&(n=""),i+"//"+s+n}function y(t){if(t=t.replace(L,"$1/"),!t.match(/^(http||https):\/\//)){var e="/"===t.substring(0,1)?"":i.pathname;"/"!==e.substring(e.length-1)&&(e=e.substring(0,e.lastIndexOf("/")+1)),t=i.protocol+"//"+i.host+e+t}for(;I.test(t);)t=t.replace(I,"");return t}function v(t,e){var i="",s=t.indexOf("#");-1!==s&&(i=t.substring(s),t=t.substring(0,s));var n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(a+"="+r(e[a]));return t+(W?"#":-1==t.indexOf("?")?"?":"&")+n.join("&")+i}function w(t){return"undefined"==typeof t}function x(t,e,i){var s;for(var n in e)e.hasOwnProperty(n)&&(n in t?(s=e[n],"object"==typeof s?x(t[n],s,i):i||(t[n]=e[n])):t[n]=e[n]);return t}function b(){var t=e.body.appendChild(e.createElement("form")),i=t.appendChild(e.createElement("input"));i.name=V+"TEST"+_,T=i!==t.elements[i.name],e.body.removeChild(t)}function k(t){w(T)&&b();var i;T?i=e.createElement('<iframe name="'+t.props.name+'"/>'):(i=e.createElement("IFRAME"),i.name=t.props.name),i.id=i.name=t.props.name,delete t.props.name,t.onLoad&&B(i,"load",t.onLoad),"string"==typeof t.container&&(t.container=e.getElementById(t.container)),t.container||(x(i.style,{position:"absolute",top:"-2000px"}),t.container=e.body);var s=t.props.src;return delete t.props.src,x(i,t.props),i.border=i.frameBorder=0,i.allowTransparency=!0,t.container.appendChild(i),i.src=s,t.props.src=s,i}function C(t,e){"string"==typeof t&&(t=[t]);for(var i,s=t.length;s--;)if(i=t[s],i=new RegExp("^"==i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(e))return!0;return!1}function E(s){var n,r=s.protocol;if(s.isHost=s.isHost||w(U.xdm_p),W=s.hash||!1,s.props||(s.props={}),s.isHost)s.remote=y(s.remote),s.channel=s.channel||"default"+_++,s.secret=Math.random().toString(16).substring(2),w(r)&&(g(i.href)==g(s.remote)?r="4":a(t,"postMessage")||a(e,"postMessage")?r="1":s.swf&&a(t,"ActiveXObject")&&l()?r="6":"Gecko"===navigator.product&&"frameElement"in t&&-1==navigator.userAgent.indexOf("WebKit")?r="5":s.remoteHelper?(s.remoteHelper=y(s.remoteHelper),r="2"):r="0");
else if(s.channel=U.xdm_c,s.secret=U.xdm_s,s.remote=U.xdm_e,r=U.xdm_p,s.acl&&!C(s.acl,s.remote))throw new Error("Access denied for "+s.remote);switch(s.protocol=r,r){case"0":if(x(s,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),s.isHost){if(!s.local){for(var o,h=i.protocol+"//"+i.host,c=e.body.getElementsByTagName("img"),u=c.length;u--;)if(o=c[u],o.src.substring(0,h.length)===h){s.local=o.src;break}s.local||(s.local=t)}var f={xdm_c:s.channel,xdm_p:0};s.local===t?(s.usePolling=!0,s.useParent=!0,s.local=i.protocol+"//"+i.host+i.pathname+i.search,f.xdm_e=s.local,f.xdm_pa=1):f.xdm_e=y(s.local),s.container&&(s.useResize=!1,f.xdm_po=1),s.remote=v(s.remote,f)}else x(s,{channel:U.xdm_c,remote:U.xdm_e,useParent:!w(U.xdm_pa),usePolling:!w(U.xdm_po),useResize:s.useParent?!1:s.useResize});n=[new F.stack.HashTransport(s),new F.stack.ReliableBehavior({}),new F.stack.QueueBehavior({encode:!0,maxLength:4e3-s.remote.length}),new F.stack.VerifyBehavior({initiate:s.isHost})];break;case"1":n=[new F.stack.PostMessageTransport(s)];break;case"2":n=[new F.stack.NameTransport(s),new F.stack.QueueBehavior,new F.stack.VerifyBehavior({initiate:s.isHost})];break;case"3":n=[new F.stack.NixTransport(s)];break;case"4":n=[new F.stack.SameOriginTransport(s)];break;case"5":n=[new F.stack.FrameElementTransport(s)];break;case"6":z||l(),n=[new F.stack.FlashTransport(s)]}return n.push(new F.stack.QueueBehavior({lazy:s.lazy,remove:!0})),n}function S(t){for(var e,i={incoming:function(t,e){this.up.incoming(t,e)},outgoing:function(t,e){this.down.outgoing(t,e)},callback:function(t){this.up.callback(t)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},s=0,n=t.length;n>s;s++)e=t[s],x(e,i,!0),0!==s&&(e.down=t[s-1]),s!==n-1&&(e.up=t[s+1]);return e}function M(t){t.up.down=t.down,t.down.up=t.up,t.up=t.down=null}var T,z,P,B,A,N=this,_=Math.floor(1e4*Math.random()),R=Function.prototype,O=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,I=/[\-\w]+\/\.\.\//,L=/([^:])\/\//g,G="",F={},D=t.easyXDM,V="easyXDM_",W=!1;if(a(t,"addEventListener"))B=function(t,e,i){t.addEventListener(e,i,!1)},A=function(t,e,i){t.removeEventListener(e,i,!1)};else{if(!a(t,"attachEvent"))throw new Error("Browser not supported");B=function(t,e,i){t.attachEvent("on"+e,i)},A=function(t,e,i){t.detachEvent("on"+e,i)}}var H,K=!1,j=[];if("readyState"in e?(H=e.readyState,K="complete"==H||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==H||"interactive"==H)):K=!!e.body,!K){if(a(t,"addEventListener"))B(e,"DOMContentLoaded",c);else if(B(e,"readystatechange",function(){"complete"==e.readyState&&c()}),e.documentElement.doScroll&&t===top){var q=function(){if(!K){try{e.documentElement.doScroll("left")}catch(t){return s(q,1),void 0}c()}};q()}B(t,"load",c)}var U=function(t){t=t.substring(1).split("&");for(var e,i={},s=t.length;s--;)e=t[s].split("="),i[e[0]]=n(e[1]);return i}(/xdm_e=/.test(i.search)?i.search:i.hash),Y=function(){var t={},e={a:[1,2,3]},i='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(e).replace(/\s/g,"")===i?JSON:(Object.toJSON&&Object.toJSON(e).replace(/\s/g,"")===i&&(t.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(e=i.evalJSON(),e.a&&3===e.a.length&&3===e.a[2]&&(t.parse=function(t){return t.evalJSON()})),t.stringify&&t.parse?(Y=function(){return t},t):null)};x(F,{version:"2.4.15.118",query:U,stack:{},apply:x,getJSONObject:Y,whenReady:u,noConflict:d}),F.DomHelper={on:B,un:A,requiresJSON:function(i){o(t,"JSON")||e.write('<script type="text/javascript" src="'+i+'"><'+"/script>")}},function(){var t={};F.Fn={set:function(e,i){t[e]=i},get:function(e,i){var s=t[e];return i&&delete t[e],s}}}(),F.Socket=function(t){var e=S(E(t).concat([{incoming:function(e,i){t.onMessage(e,i)},callback:function(e){t.onReady&&t.onReady(e)}}])),i=g(t.remote);this.origin=g(t.remote),this.destroy=function(){e.destroy()},this.postMessage=function(t){e.outgoing(t,i)},e.init()},F.Rpc=function(t,e){if(e.local)for(var i in e.local)if(e.local.hasOwnProperty(i)){var s=e.local[i];"function"==typeof s&&(e.local[i]={method:s})}var n=S(E(t).concat([new F.stack.RpcBehavior(this,e),{callback:function(e){t.onReady&&t.onReady(e)}}]));this.origin=g(t.remote),this.destroy=function(){n.destroy()},n.init()},F.stack.SameOriginTransport=function(t){var e,n,r,a;return e={outgoing:function(t,e,i){r(t),i&&i()},destroy:function(){n&&(n.parentNode.removeChild(n),n=null)},onDOMReady:function(){a=g(t.remote),t.isHost?(x(t.props,{src:v(t.remote,{xdm_e:i.protocol+"//"+i.host+i.pathname,xdm_c:t.channel,xdm_p:4}),name:V+t.channel+"_provider"}),n=k(t),F.Fn.set(t.channel,function(t){return r=t,s(function(){e.up.callback(!0)},0),function(t){e.up.incoming(t,a)}})):(r=f().Fn.get(t.channel,!0)(function(t){e.up.incoming(t,a)}),s(function(){e.up.callback(!0)},0))},init:function(){u(e.onDOMReady,e)}}},F.stack.FlashTransport=function(t){function n(t){s(function(){a.up.incoming(t,h)},0)}function r(i){var s=t.swf+"?host="+t.isHost,n="easyXDM_swf_"+Math.floor(1e4*Math.random());F.Fn.set("flash_loaded"+i.replace(/[\-.]/g,"_"),function(){F.stack.FlashTransport[i].swf=l=c.firstChild;for(var t=F.stack.FlashTransport[i].queue,e=0;e<t.length;e++)t[e]();t.length=0}),t.swfContainer?c="string"==typeof t.swfContainer?e.getElementById(t.swfContainer):t.swfContainer:(c=e.createElement("div"),x(c.style,P&&t.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),e.body.appendChild(c));var r="callback=flash_loaded"+i.replace(/[\-.]/g,"_")+"&proto="+N.location.protocol+"&domain="+p(N.location.href)+"&port="+m(N.location.href)+"&ns="+G;c.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+n+"' data='"+s+"'>"+"<param name='allowScriptAccess' value='always'></param>"+"<param name='wmode' value='transparent'>"+"<param name='movie' value='"+s+"'></param>"+"<param name='flashvars' value='"+r+"'></param>"+"<embed type='application/x-shockwave-flash' FlashVars='"+r+"' allowScriptAccess='always' wmode='transparent' src='"+s+"' height='1' width='1'></embed>"+"</object>"}var a,o,h,l,c;return a={outgoing:function(e,i,s){l.postMessage(t.channel,e.toString()),s&&s()},destroy:function(){try{l.destroyChannel(t.channel)}catch(e){}l=null,o&&(o.parentNode.removeChild(o),o=null)},onDOMReady:function(){h=t.remote,F.Fn.set("flash_"+t.channel+"_init",function(){s(function(){a.up.callback(!0)})}),F.Fn.set("flash_"+t.channel+"_onMessage",n),t.swf=y(t.swf);var e=p(t.swf),c=function(){F.stack.FlashTransport[e].init=!0,l=F.stack.FlashTransport[e].swf,l.createChannel(t.channel,t.secret,g(t.remote),t.isHost),t.isHost&&(P&&t.swfNoThrottle&&x(t.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),x(t.props,{src:v(t.remote,{xdm_e:g(i.href),xdm_c:t.channel,xdm_p:6,xdm_s:t.secret}),name:V+t.channel+"_provider"}),o=k(t))};F.stack.FlashTransport[e]&&F.stack.FlashTransport[e].init?c():F.stack.FlashTransport[e]?F.stack.FlashTransport[e].queue.push(c):(F.stack.FlashTransport[e]={queue:[c]},r(e))},init:function(){u(a.onDOMReady,a)}}},F.stack.PostMessageTransport=function(e){function n(t){if(t.origin)return g(t.origin);if(t.uri)return g(t.uri);if(t.domain)return i.protocol+"//"+t.domain;throw"Unable to retrieve the origin of the event"}function r(t){var i=n(t);i==l&&t.data.substring(0,e.channel.length+1)==e.channel+" "&&a.up.incoming(t.data.substring(e.channel.length+1),i)}var a,o,h,l;return a={outgoing:function(t,i,s){h.postMessage(e.channel+" "+t,i||l),s&&s()},destroy:function(){A(t,"message",r),o&&(h=null,o.parentNode.removeChild(o),o=null)},onDOMReady:function(){if(l=g(e.remote),e.isHost){var n=function(i){i.data==e.channel+"-ready"&&(h="postMessage"in o.contentWindow?o.contentWindow:o.contentWindow.document,A(t,"message",n),B(t,"message",r),s(function(){a.up.callback(!0)},0))};B(t,"message",n),x(e.props,{src:v(e.remote,{xdm_e:g(i.href),xdm_c:e.channel,xdm_p:1}),name:V+e.channel+"_provider"}),o=k(e)}else B(t,"message",r),h="postMessage"in t.parent?t.parent:t.parent.document,h.postMessage(e.channel+"-ready",l),s(function(){a.up.callback(!0)},0)},init:function(){u(a.onDOMReady,a)}}},F.stack.FrameElementTransport=function(n){var r,a,o,h;return r={outgoing:function(t,e,i){o.call(this,t),i&&i()},destroy:function(){a&&(a.parentNode.removeChild(a),a=null)},onDOMReady:function(){h=g(n.remote),n.isHost?(x(n.props,{src:v(n.remote,{xdm_e:g(i.href),xdm_c:n.channel,xdm_p:5}),name:V+n.channel+"_provider"}),a=k(n),a.fn=function(t){return delete a.fn,o=t,s(function(){r.up.callback(!0)},0),function(t){r.up.incoming(t,h)}}):(e.referrer&&g(e.referrer)!=U.xdm_e&&(t.top.location=U.xdm_e),o=t.frameElement.fn(function(t){r.up.incoming(t,h)}),r.up.callback(!0))},init:function(){u(r.onDOMReady,r)}}},F.stack.NameTransport=function(t){function e(e){var i=t.remoteHelper+(o?"#_3":"#_2")+t.channel;h.contentWindow.sendMessage(e,i)}function i(){o?2!==++c&&o||a.up.callback(!0):(e("ready"),a.up.callback(!0))}function n(t){a.up.incoming(t,d)}function r(){f&&s(function(){f(!0)},0)}var a,o,h,l,c,f,d,p;return a={outgoing:function(t,i,s){f=s,e(t)},destroy:function(){h.parentNode.removeChild(h),h=null,o&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){o=t.isHost,c=0,d=g(t.remote),t.local=y(t.local),o?(F.Fn.set(t.channel,function(e){o&&"ready"===e&&(F.Fn.set(t.channel,n),i())}),p=v(t.remote,{xdm_e:t.local,xdm_c:t.channel,xdm_p:2}),x(t.props,{src:p+"#"+t.channel,name:V+t.channel+"_provider"}),l=k(t)):(t.remoteHelper=t.remote,F.Fn.set(t.channel,n)),h=k({props:{src:t.local+"#_4"+t.channel},onLoad:function e(){var n=h||this;A(n,"load",e),F.Fn.set(t.channel+"_load",r),function a(){"function"==typeof n.contentWindow.sendMessage?i():s(a,50)}()}})},init:function(){u(a.onDOMReady,a)}}},F.stack.HashTransport=function(e){function i(t){if(m){var i=e.remote+"#"+d++ +"_"+t;(h||!y?m.contentWindow:m).location=i}}function n(t){f=t,o.up.incoming(f.substring(f.indexOf("_")+1),v)}function r(){if(p){var t=p.location.href,e="",i=t.indexOf("#");-1!=i&&(e=t.substring(i)),e&&e!=f&&n(e)}}function a(){l=setInterval(r,c)}var o,h,l,c,f,d,p,m,y,v;return o={outgoing:function(t){i(t)},destroy:function(){t.clearInterval(l),(h||!y)&&m.parentNode.removeChild(m),m=null},onDOMReady:function(){if(h=e.isHost,c=e.interval,f="#"+e.channel,d=0,y=e.useParent,v=g(e.remote),h){if(e.props={src:e.remote,name:V+e.channel+"_provider"},y)e.onLoad=function(){p=t,a(),o.up.callback(!0)};else{var i=0,n=e.delay/50;!function r(){if(++i>n)throw new Error("Unable to reference listenerwindow");try{p=m.contentWindow.frames[V+e.channel+"_consumer"]}catch(t){}p?(a(),o.up.callback(!0)):s(r,50)}()}m=k(e)}else p=t,a(),y?(m=parent,o.up.callback(!0)):(x(e,{props:{src:e.remote+"#"+e.channel+new Date,name:V+e.channel+"_consumer"},onLoad:function(){o.up.callback(!0)}}),m=k(e))},init:function(){u(o.onDOMReady,o)}}},F.stack.ReliableBehavior=function(){var t,e,i=0,s=0,n="";return t={incoming:function(r,a){var o=r.indexOf("_"),h=r.substring(0,o).split(",");r=r.substring(o+1),h[0]==i&&(n="",e&&e(!0)),r.length>0&&(t.down.outgoing(h[1]+","+i+"_"+n,a),s!=h[1]&&(s=h[1],t.up.incoming(r,a)))},outgoing:function(r,a,o){n=r,e=o,t.down.outgoing(s+","+ ++i+"_"+r,a)}}},F.stack.QueueBehavior=function(t){function e(){if(t.remove&&0===o.length)return M(i),void 0;if(!h&&0!==o.length&&!a){h=!0;var n=o.shift();i.down.outgoing(n.data,n.origin,function(t){h=!1,n.callback&&s(function(){n.callback(t)},0),e()})}}var i,a,o=[],h=!0,l="",c=0,u=!1,f=!1;return i={init:function(){w(t)&&(t={}),t.maxLength&&(c=t.maxLength,f=!0),t.lazy?u=!0:i.down.init()},callback:function(t){h=!1;var s=i.up;e(),s.callback(t)},incoming:function(e,s){if(f){var r=e.indexOf("_"),a=parseInt(e.substring(0,r),10);l+=e.substring(r+1),0===a&&(t.encode&&(l=n(l)),i.up.incoming(l,s),l="")}else i.up.incoming(e,s)},outgoing:function(s,n,a){t.encode&&(s=r(s));var h,l=[];if(f){for(;0!==s.length;)h=s.substring(0,c),s=s.substring(h.length),l.push(h);for(;h=l.shift();)o.push({data:l.length+"_"+h,origin:n,callback:0===l.length?a:null})}else o.push({data:s,origin:n,callback:a});u?i.down.init():e()},destroy:function(){a=!0,i.down.destroy()}}},F.stack.VerifyBehavior=function(t){function e(){s=Math.random().toString(16).substring(2),i.down.outgoing(s)}var i,s,n;return i={incoming:function(r,a){var o=r.indexOf("_");-1===o?r===s?i.up.callback(!0):n||(n=r,t.initiate||e(),i.down.outgoing(r)):r.substring(0,o)===n&&i.up.incoming(r.substring(o+1),a)},outgoing:function(t,e,n){i.down.outgoing(s+"_"+t,e,n)},callback:function(){t.initiate&&e()}}},F.stack.RpcBehavior=function(t,e){function i(t){t.jsonrpc="2.0",r.down.outgoing(a.stringify(t))}function s(t,e){var s=Array.prototype.slice;return function(){var n,r=arguments.length,a={method:e};r>0&&"function"==typeof arguments[r-1]?(r>1&&"function"==typeof arguments[r-2]?(n={success:arguments[r-2],error:arguments[r-1]},a.params=s.call(arguments,0,r-2)):(n={success:arguments[r-1]},a.params=s.call(arguments,0,r-1)),l[""+ ++o]=n,a.id=o):a.params=s.call(arguments,0),t.namedParams&&1===a.params.length&&(a.params=a.params[0]),i(a)}}function n(t,e,s,n){if(!s)return e&&i({id:e,error:{code:-32601,message:"Procedure not found."}}),void 0;var r,a;e?(r=function(t){r=R,i({id:e,result:t})},a=function(t,s){a=R;var n={id:e,error:{code:-32099,message:t}};s&&(n.error.data=s),i(n)}):r=a=R,h(n)||(n=[n]);try{var o=s.method.apply(s.scope,n.concat([r,a]));w(o)||r(o)}catch(l){a(l.message)}}var r,a=e.serializer||Y(),o=0,l={};return r={incoming:function(t){var s=a.parse(t);if(s.method)e.handle?e.handle(s,i):n(s.method,s.id,e.local[s.method],s.params);else{var r=l[s.id];s.error?r.error&&r.error(s.error):r.success&&r.success(s.result),delete l[s.id]}},init:function(){if(e.remote)for(var i in e.remote)e.remote.hasOwnProperty(i)&&(t[i]=s(e.remote[i],i));r.down.init()},destroy:function(){for(var i in e.remote)e.remote.hasOwnProperty(i)&&t.hasOwnProperty(i)&&delete t[i];r.down.destroy()}}},N.easyXDM=F}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);var JSONP=function(){function t(t){var e=document.createElement("script"),s=!1;e.src=t,e.async=!0,e.onload=e.onreadystatechange=function(){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,e.onload=e.onreadystatechange=null,e&&e.parentNode&&e.parentNode.removeChild(e))},i||(i=document.getElementsByTagName("head")[0],i||(i=document.body)),i.appendChild(e)}function e(e,i,o){s="?",i=i||{};for(n in i)i.hasOwnProperty(n)&&(s+=encodeURIComponent(n)+"="+encodeURIComponent(i[n])+"&");var h="json"+ ++r;return a[h]=function(t){o(t);try{delete a[h]}catch(e){}a[h]=null},t(e+s+"callback="+h),h}var i,s,n,r=0,a=this;return{get:e}}(),Class=function(t){var e=function(){return e.$prototyping?this:"function"==typeof this.initialize?this.initialize.apply(this,arguments):void 0};t.Extends&&(e.parent=t.Extends,t.Extends.$prototyping=!0,e.prototype=new t.Extends,t.Extends.$prototyping=!1);for(var i in t)t.hasOwnProperty(i)&&(e.prototype[i]=t[i]);return e};"undefined"!=typeof exports&&(exports.Class=Class);var Vector=new Class({initialize:function(t,e){"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)},cp:function(){return new Vector(this.x,this.y)},mul:function(t){return this.x*=t,this.y*=t,this},mulNew:function(t){return new Vector(this.x*t,this.y*t)},div:function(t){return this.x/=t,this.y/=t,this},divNew:function(t){return new Vector(this.x/t,this.y/t)},add:function(t){return this.x+=t.x,this.y+=t.y,this},addNew:function(t){return new Vector(this.x+t.x,this.y+t.y)},sub:function(t){return this.x-=t.x,this.y-=t.y,this},subNew:function(t){return new Vector(this.x-t.x,this.y-t.y)},rotate:function(t){var e=this.x,i=this.y;return this.x=e*Math.cos(t)-Math.sin(t)*i,this.y=e*Math.sin(t)+Math.cos(t)*i,this},rotateNew:function(t){return this.cp().rotate(t)},setAngle:function(t){var e=this.len();return this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},setAngleNew:function(t){return this.cp().setAngle(t)},setLength:function(t){var e=this.len();return e?this.mul(t/e):this.x=this.y=t,this},setLengthNew:function(t){return this.cp().setLength(t)},normalize:function(){var t=this.len();return 0==t?this:(this.x/=t,this.y/=t,this)},normalizeNew:function(){return this.cp().normalize()},angle:function(){return Math.atan2(this.y,this.x)},collidesWith:function(t){return this.x>t.x&&this.y>t.y&&this.x<t.x+t.width&&this.y<t.y+t.height},len:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return.005>t&&t>-.005?0:t},is:function(t){return"object"==typeof t&&this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y},inTriangle:function(t,e,i){var s=i.subNew(t),n=e.subNew(t),r=p.subNew(t),a=s.dot(s),o=s.dot(n),h=s.dot(r),l=n.dot(n),c=n.dot(r),u=1/(a*l-o*o),f=(l*h-o*c)*u,d=(a*c-o*h)*u;return f>0&&d>0&&1>f+d},distanceFrom:function(t){return Math.sqrt(Math.pow(this.x-t.x,2),Math.pow(this.y-t.y,2))},toString:function(){return"[Vector("+this.x+", "+this.y+") angle: "+this.angle()+", length: "+this.len()+"]"}});"undefined"!=typeof exports&&(exports.Vector=Vector);var Rect=new Class({initialize:function(t,e,i,s){this.pos=new Vector(t,e),this.size={width:i,height:s}},hasPoint:function(t){return t.x>this.getLeft()&&t.x<this.getRight()&&t.y>this.getTop()&&t.y<this.getBottom()},setLeft:function(t){this.pos.x=t+this.size.width/2},setTop:function(t){this.pos.y=t+this.size.height/2},getLeft:function(){return this.pos.x-this.size.width/2},getTop:function(){return this.pos.y-this.size.height/2},getRight:function(){return this.pos.x+this.size.width/2},getBottom:function(){return this.pos.y+this.size.height/2},cp:function(){return new Rect(this.pos.x,this.pos.y,this.size.width,this.size.height)}});"undefined"!=typeof exports&&(exports.Rect=Rect);var Fx=new Class({initialize:function(){this.listeners=[],this.tweens={},this.running={}},addListener:function(t){this.listeners.push(t)},add:function(t,e){if(e=e||{},e.duration=e.duration||500,e.transition=e.transition||Tween.Linear,e.repeats="undefined"==typeof e.repeats?!1:e.repeats,!e.tweens){var i=e.start||0,s="undefined"==typeof e.end?1:e.end;e.tweens=[[i,s]]}this.tweens[t]=e},update:function(t){t="number"==typeof t?t:now();for(var e in this.tweens)if(this.tweens.hasOwnProperty(e)){if(!this.running[e]){this.tweenStart(e,t);continue}var i=this.tweens[e],s=t-this.running[e].startTime;if(s>i.duration){this.tweenFinished(i,e);continue}for(var n,r=i.transition(s/i.duration),a=[],o=0;n=i.tweens[o];o++){var h=r*(n[1]-n[0])+n[0];a.push(h)}this.fire(e,a,r)}},tweenStart:function(t,e){this.running[t]={startTime:e};for(var i,s=[],n=0;i=this.tweens[t].tweens[n];n++)s.push(i[0]);this.fire(t,s,0)},tweenFinished:function(t,e){for(var i,s=[],n=0;i=t.tweens[n];n++)s.push(i[1]);return this.fire(e,s,1),t.repeats?(this.tweenStart(e,now()),void 0):(delete this.running[e],delete this.tweens[e],void 0)},fire:function(t,e,i){for(var s,n=0;s=this.listeners[n];n++)s.set.call(s,t,e,i)}}),Tween={Linear:function(t){return t},Quadratic:function(t){return t*t},Quintic:function(t){return t*t*t},Shake:function(t){return Math.sin(t)}},GameGlobals={FPS:60,useAnimationFrame:!1,boids:{flockRadius:400,size:100},path:function(){return document.location.protocol+"//kickassapp.com/"+Array.prototype.slice.call(arguments).join("")},hasCanvas:"undefined"!=typeof document.createElement("canvas").getContext,bulletColor:"white"};GameGlobals.easyXDMFlash=GameGlobals.path("easyxdm.swf"),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var s=0;if(arguments.length>0&&(s=Number(arguments[1]),s!==s?s=0:0!==s&&s!==1/0&&s!==-(1/0)&&(s=(s>0||-1)*Math.floor(Math.abs(s)))),s>=i)return-1;for(var n=s>=0?s:Math.max(i-Math.abs(s),0);i>n;n++)if(n in e&&e[n]===t)return n;return-1});var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),KickAss=new Class({initialize:function(){this.players=[],this.elements=[],this.weaponClass=Weapons[1].cannonClass,this.scrollPos=new Vector(0,0),this.scrollSize=new Vector(0,0),this.windowSize={width:0,height:0},this.updateWindowInfo(),this.world=new World(this),this.bulletManager=new BulletManager,this.bulletManager.game=this,this.bulletManager.updateEnemyIndex(),this.explosionManager=new ExplosionManager,this.explosionManager.game=this,this.ui=new UIManager,this.ui.game=this,this.bombManager=new BombManager,this.bombManager.game=this,this.statisticsManager=new StatisticsManager,this.statisticsManager.game=this,GameGlobals.stats=this.statisticsManager,this.sessionManager=new SessionManager,this.sessionManager.game=this,this.alienManager=new AlienManager(this),this.lastUpdate=now(),this.keyMap={},this.keydownEvent=bind(this,this.keydown),this.keyupEvent=bind(this,this.keyup),this.multiplier=10,window.KickAssStyle&&"white"===window.KickAssStyle&&(GameGlobals.bulletColor="white"),addEvent(document,"keydown",this.keydownEvent),addEvent(document,"keyup",this.keyupEvent),addEvent(document,"keypress",this.keydownEvent)},begin:function(){this.addPlayer(),this.sessionManager.isPlaying=!0,GameGlobals.useAnimationFrame||(this.loopTimer=window.setInterval(bind(this,this.loop),1e3/GameGlobals.FPS)),GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},keydown:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!0,e){case"left":case"right":case"up":case"down":case"esc":case" ":stopEvent(t)}switch(e){case"esc":this.destroy()}},keyup:function(t){var e=code(t.keyCode);switch(this.keyMap[e]=!1,e){case"left":case"right":case"up":case"down":case"esc":case" ":t.stopPropogation&&t.stopPropogation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}},loop:function(){var t=now(),e=(t-this.lastUpdate)/1e3;this.updateWindowInfo();for(var i,s=0;i=this.players[s];s++)i.update(e);this.world.update(e),this.bulletManager.update(e),this.bombManager.update(e),this.explosionManager.update(e),this.alienManager.update(e),this.ui.update(e),this.statisticsManager.update(e),this.sessionManager.update(e),this.lastUpdate=t,GameGlobals.useAnimationFrame&&requestAnimFrame(bind(this,this.loop))},addPlayer:function(){var t=Ships.Standard;window.KICKASSSHIP&&KICKASSSHIP.points&&(t=KICKASSSHIP);var e=new Player;e.game=this,e.setShip(t),this.players.push(e),this.explosionManager.addExplosion(e.pos)},registerElement:function(t){if(!t)throw new Error("Can't register unexisting element.");this.elements.push(t)},unregisterElement:function(t){this.elements.splice(this.elements.indexOf(t),1)},isKickAssElement:function(t){for(var e,i=0;e=this.elements[i];i++)if(t===e||elementIsContainedIn(e,t))return!0;return!1},isKeyPressed:function(t){return!!this.keyMap[t]},updateWindowInfo:function(){var t=!!window.ActiveXObject&&"BackCompat"==document.compatMode;this.windowSize={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight},t&&(this.windowSize.width=document.body.clientWidth,this.windowSize.height=document.body.clientHeight),this.scrollPos.x=window.pageXOffset||document.documentElement.scrollLeft,this.scrollPos.y=window.pageYOffset||document.documentElement.scrollTop,this.scrollSize=getScrollSize()},hideAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="hidden"},showAll:function(){for(var t,e=0;t=this.elements[e];e++)t.style.visibility="visible"},updateShips:function(t,e){e||this.ui.showMessage("You're now flying<br /><em>"+t.name+"<em>!!");for(var i,s=0;i=this.players[s];s++)i.setShip(t)},changeWeapon:function(t,e){this.weaponClass=t.cannonClass,e||this.ui.showMessage("Changed to "+t.name.toUpperCase()+"!!!!");for(var i,s=0;i=this.players[s];s++)i.setCannons(t.cannonClass)},changeWeaponById:function(t,e){Weapons[t]&&this.changeWeapon(Weapons[t],e)},flyOutPlayers:function(t){for(var e,i=0;e=this.players[i];i++)e.flyTo(t,-e.size.height),e.isBound=!1},flyInPlayers:function(){for(var t,e=0;t=this.players[e];e++)t.flyTo(t.pos.x,100,function(){this.isBound=!0})},newRank:function(t){this.ui.showMessage("OMG. You leveled up to: <strong>"+t+"</strong>!<br /><small>Be sure to check what cool new stuff you get in the menu.</small>")},fireBomb:function(){this.bombManager.blow()},destroy:function(){removeEvent(document,"keydown",this.keydownEvent),removeEvent(document,"keypress",this.keydownEvent),removeEvent(document,"keyup",this.keyupEvent);for(var t,e=0;t=this.players[e];e++)t.destroy();this.bulletManager.destroy(),this.explosionManager.destroy(),GameGlobals.useAnimationFrame||clearInterval(this.loopTimer),window.KICKASSGAME=!1}}),StatisticsManager=new Class({initialize:function(){this.data={},this.data.startedPlaying=now(),this.data.elementsDestroyed=0,this.data.shotsFired=0,this.data.distanceFlownInPixels=0,this.data.totalPointsThisSession=0,this.data.usedThrusters=0,this.lastUpdate=0},usedThrusters:function(){this.data.usedThrusters=1},increaseDistanceWithPixels:function(t){this.data.distanceFlownInPixels+=t},increasePointsGainedWithPoints:function(t){this.data.totalPointsThisSession+=t},addShotFired:function(){this.data.shotsFired++},addElementsDestroyed:function(){this.data.elementsDestroyed++},update:function(t){this.lastUpdate+=t,this.lastUpdate>.25&&(this.syncWithServer(),this.lastUpdate=0)},syncWithServer:function(){var t=[];for(var e in this.data)this.data.hasOwnProperty(e)&&t.push(e+":"+this.data[e])}});new Class({initialize:function(){this.size={height:300},this.url=GameGlobals.path("intermediate.html?url="+encodeURIComponent(window.KICKASSURL||document.location.href))},generate:function(t){this.container=document.createElement("div"),this.container.className="KICKASSELEMENT",this.container.id="kickass-profile-menu",t.appendChild(this.container),this.isSocketReady=!1,this.socket=new easyXDM.Socket({remote:this.url,remoteHelper:GameGlobals.path("name.html"),swf:GameGlobals.path("easyxdm.swf"),container:this.container,lazy:!1,onMessage:bind(this,function(t){if("ready"===t)return this.onGameReady(),void 0;var e=t.split(":!");if(2===e.length){var i=e.shift().replace(/^./g,function(t){return t.charAt(0).toUpperCase()});this["messageType"+i]&&this["messageType"+i](e.join(":!"))}}),props:{frameborder:"0",className:"KICKASSELEMENT",style:{width:"100%",height:this.size.height+"px"}}}),this.game.registerElement(this.container)},onGameReady:function(){this.isSocketReady=!0,this.game.registerElement(this.container.getElementsByTagName("iframe")[0]),this.socket.postMessage("url:!"+(window.KICKASSURL||document.location.href)),this.game.statisticsManager.syncWithServer()},sendMessage:function(t){if(this.isSocketReady&&t!=this.lastMessage){try{this.socket.postMessage(t)}catch(e){}this.lastMessage=t}},messageTypeChangeShip:function(t){t=t.split(",");var e=t[0];t[1];var i="initial"===t[2];this.shipId!==e&&(i&&window.KICKASSSHIP||(this.shipId=e,JSONP.get(GameGlobals.path("designer/ship/"+e+"/construction.jsonp"),{ship_id:e,is_initial:i?"1":"0"},bind(this,function(t){this.game.updateShips(t.data,i);try{window.focus()}catch(e){}})),i||this.parent.hideMenu()))},messageTypeChangeWeapon:function(t,e){this.game.changeWeaponById(t,e)},messageTypeSetMultiplier:function(t){t=parseInt(t,10),!isNaN(t)&&t&&(this.game.multiplier=t)},messageTypeNewRank:function(t){this.game.newRank(t)},messageTypePlayerMessage:function(t){this.game.ui.showMessage(t)},destroy:function(){this.game.unregisterElement(this.container),this.game.unregisterElement(this.iframe),this.container.parentNode.removeChild(this.container)}});var UIManager=new Class({initialize:function(){this.UNIQID=0,this.pointBubbles={},this.messages={},this.fx=new Fx,this.fx.addListener(this)},update:function(){this.fx.update()},set:function(t,e,i){var s=t.split("-")[0],n=t.split("-")[1];if(this.pointBubbles[n]){var r=this.pointBubbles[n];r.style.top=e[0]+"px",r.style.opacity=e[1],1==i&&r.parentNode&&(r.parentNode.removeChild(r),delete this.pointBubbles[n])}else if(this.messages[n]&&"messagedown"==s){var a=this.messages[n];a.style.top=e[0]+"px",1==i&&setTimeout(bind(this,function(){this.fx.add("messageup-"+n,{tweens:[[e[0],-100]],transition:Tween.Quadratic,duration:300})}),a.staytime||4e3)}else if(this.messages[n]&&"messageup"==s){var a=this.messages[n];a.style.top=e[0]+"px",1==i&&(a.parentNode.removeChild(a),delete this.messages[n])}},addPointsBubbleAt:function(t,e){var i="bubble"+this.UNIQID++,s=this.game.scrollPos.y+t.y,n=newElement("span",{innerHTML:e,className:"KICKASSELEMENT",styles:{position:"absolute",font:"20px Arial",fontWeight:"bold",opacity:"1",color:"black",textShadow:"#fff 1px 1px 3px",top:s,zIndex:"10000000"}});n.style.left=t.x-n.offsetWidth/2+"px",document.body.appendChild(n),this.pointBubbles[i]=n,this.fx.add("bubble-"+i,{tweens:[[s,s-15],[1,0]]})},showMessage:function(t,e){e=e||!1;var i=300,s=this.UNIQID++,n=newElement("div",{innerHTML:t,className:"KICKASSELEMENT",id:"kickass-message-"+s,styles:{position:"fixed",top:-100,left:"50%",marginLeft:-i/2,width:i,background:"#222",opacity:.8,padding:"10px",color:"#fff",textAlign:"center",borderRadius:15,font:"20px Arial",fontWeight:"bold",zIndex:"10000000"}});n.staytime=e,document.body.appendChild(n);var r=this.getLowestBubbleY();return n.kickassto=r,this.fx.add("messagedown-"+s,{duration:300,tweens:[[-100,r]],transition:Tween.Quadratic}),this.messages[s]=n,n},getLowestBubbleY:function(){var t=100;for(var e in this.messages)this.messages.hasOwnProperty(e)&&(t=Math.max(this.messages[e].kickassto+this.messages[e].offsetHeight+10,t));return t}}),World=new Class({initialize:function(t){return},render:function(){return},update:function(t){}}),Ships={Standard:{points:[[-10,10],[0,-15],[10,10]],thrusters:[{s:{w:20,h:7},p:{x:0,y:14},a:0}],cannons:[{p:{x:0,y:-15},a:0}]}},PLAYERIDS=0,Player=new Class({initialize:function(){this.id=PLAYERIDS++,this.tween=!1,this.isBound=!0,this.pos=new Vector(200,200),this.vel=new Vector(0,0),this.acc=new Vector(0,0),this.dir=new Vector(0,1),this.currentRotation=0,this.isBroken=!1,this.lineOffsets=[],this.deadTime=0,this.friction=.8,this.terminalVelocity=2e3,this.lastPos=new Vector(0,0)},setShip:function(t){this.ship=t,this.verts=[];for(var e,i=0;e=this.ship.points[i];i++)this.verts.push(new Vector(e[0],e[1]));this.verts.push(this.verts[0]),this.thrusters=[],this.cannons=[],this.addThrusters(this.ship.thrusters),this.addCannons(this.ship.cannons),this.size=this.getSizeFromVertsAndObjects(),this.bounds=this.calculateBounds(),this.sheet&&this.sheet.destroy(),this.sheet=new Sheet(new Rect(100,100,this.bounds.x,this.bounds.y)),this.forceRedraw=!0},setCannons:function(t){for(var e,i=[],s=0;e=this.cannons[s];s++){var n=new t(e.pos.x,e.pos.y,e.angle);n.player=this,n.game=this.game,i.push(n),e.destroy()}this.cannons=i},addThrusters:function(t){for(var e,i=0;e=t[i];i++){var s=new Thruster(e);this.thrusters.push(s)}},addCannons:function(t){for(var e,i=0;e=t[i];i++){var s=WeaponMap[e.m]||WeaponMap.cannon,n=new s.cannonClass(e.p.x,e.p.y,e.a);n.player=this,n.game=this.game,this.cannons.push(n)}},update:function(t){if(this.isBroken){if(!this.lineOffsets.length)for(var e=0;e<this.verts.length-1;e++)this.lineOffsets[e]={pos:new Vector(0,0),dir:new Vector(1,1).setAngle(2*Math.PI*Math.random())};for(var e=0;e<this.lineOffsets.length;e++)this.lineOffsets[e].pos.add(this.lineOffsets[e].dir.cp().setLength(50).mul(t));return this.sheet.clear(),this.sheet.setAngle(this.dir.angle()),this.sheet.setPosition(this.pos),this.sheet.drawBrokenPlayer(this.verts,this.lineOffsets),now()-this.deadTime>1e3&&(this.isBroken=!1,this.lineOffsets=[],this.randomPos()),void 0}this.tween||(this.game.isKeyPressed("left")||this.game.isKeyPressed("right")?(this.game.isKeyPressed("left")&&this.rotateLeft(t),this.game.isKeyPressed("right")&&this.rotateRight(t)):this.stopRotate(),this.game.isKeyPressed("up")?this.activateThrusters():this.stopThrusters()),this.game.isKeyPressed(" ")?(this.isShooting=!0,this.isBroken||this.shootPressed()):this.isShooting&&(this.isShooting=!1,this.shootReleased()),this.currentRotation&&this.dir.setAngle(this.dir.angle()+this.currentRotation*t);
var i=this.acc.mulNew(t).sub(this.vel.mulNew(t*this.friction));this.vel.add(i),this.vel.len()>this.terminalVelocity&&this.vel.setLength(this.terminalVelocity);var s=this.vel.mulNew(t);this.pos.add(s),GameGlobals.stats.increaseDistanceWithPixels(s.len());for(var n,r=!this.acc.is({x:0,y:0}),e=0;n=this.thrusters[e];e++)n.setIsShown(r),n.update(t);if(this.isBound&&this.checkBounds(),!this.lastPos.is(this.pos)||this.currentRotation||this.forceRedraw){if(this.forceRedraw=!1,this.sheet.clear(),this.sheet.setAngle(this.dir.angle()+Math.PI/2),this.sheet.setPosition(this.pos),r)for(var n,e=0;n=this.thrusters[e];e++)n.drawTo(this.sheet);this.sheet.drawPlayer(this.verts),this.lastPos=this.pos.cp()}for(var a,e=0;a=this.cannons[e];e++)a.update(t)},randomPos:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height;this.pos=new Vector(random(0,t),random(0,e))},checkBounds:function(){if(!this.tween){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;i>t?(window.scrollTo(this.game.scrollPos.x+50,this.game.scrollPos.y),this.pos.x=0):this.pos.x<0&&(window.scrollTo(this.game.scrollPos.x-50,this.game.scrollPos.y),this.pos.x=t-this.sheet.rect.size.width/2),s>e?(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y+.75*e),this.pos.y=0):this.pos.y<0&&(window.scrollTo(this.game.scrollPos.x,this.game.scrollPos.y-.75*e),this.pos.y=e-this.sheet.rect.size.height/2)}},inRect:function(t){for(var e,i=!1,s=0;e=this.verts[s];s++)t.hasPoint(new Vector(e.x+this.pos.x,e.y+this.pos.y))&&(i=!0);return i},hit:function(){this.isBroken||(this.isBroken=!0,this.deadTime=now())},activateThrusters:function(){this.game.statisticsManager.usedThrusters(),this.acc=new Vector(500,0).setAngle(this.dir.angle())},stopThrusters:function(){this.acc=new Vector(0,0)},rotateLeft:function(t){this.currentRotation=Math.max(2*-Math.PI,this.currentRotation-10*Math.PI*t)},rotateRight:function(t){this.currentRotation=Math.min(2*Math.PI,this.currentRotation+10*Math.PI*t)},stopRotate:function(){this.currentRotation=0},getSizeFromVertsAndObjects:function(){for(var t,e=0,i=0;t=this.verts[i];i++)e=Math.max(e,new Vector(t).len());for(var s,i=0;s=this.thrusters[i];i++){var n=new Vector(s.pos.x-s.size.width/2,s.pos.y-s.size.height/2).rotate(s.angle),r=new Vector(s.pos.x+s.size.width/2,s.pos.y-s.size.height/2).rotate(s.angle),a=new Vector(s.pos.x-s.size.width/2,s.pos.y+s.size.height/2).rotate(s.angle),o=new Vector(s.pos.x+s.size.width/2,s.pos.y+s.size.height/2).rotate(s.angle);e=Math.max(e,n.len(),r.len(),a.len(),o.len())}return{width:2*e,height:2*e}},calculateBounds:function(){return{x:1*Math.max(this.size.width,this.size.height),y:1*Math.max(this.size.height,this.size.width)}},shootPressed:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootPressed()},shootReleased:function(){for(var t,e=0;t=this.cannons[e];e++)t.shootReleased()},flyTo:function(t,e,i){this.tween={start:{pos:this.pos.cp(),dir:this.dir.cp()},to:new Vector(t,e),callback:i||function(){}},this.tween.time=this.getTimeforTween()},destroy:function(){this.sheet.destroy()}}),Thruster=new Class({initialize:function(t,e){this.pos=new Vector(t.p),this.size={width:t.s.w,height:t.s.h},this.angle=t.a||0,this.ship=e,this.isShown=!1,this.flameY=1,this.fx=new Fx,this.fx.addListener(this),this.flames={r:[],y:[]},this.lastFrameUpdate=0,this.generateFlames()},update:function(){this.fx.update(),now()-this.lastFrameUpdate>1e3/60&&this.generateFlames()},set:function(t,e){switch(t){case"flames":this.flameY=e}},setIsShown:function(t){!this.isShown&&t&&(this.flameY=0,this.generateFlames(),this.fx.add("flames",{start:this.flameY,end:1,duration:250,transition:Tween.Quintic})),this.isShown=t},drawTo:function(t){t.drawFlames(this.flames,this.angle)},generateFlames:function(){function t(t,e){return new Vector(t,e)}var e=this.size.width,i=.05*this.size.width,s=.8*this.size.width,n=.1*s,r=e/2,a=s/2;-this.size.height/2;var o=this.pos.x,h=this.pos.y-this.size.height/2;this.flames.r=[t(-r+o,h)],this.flames.y=[t(-a+o,h)],this.flames.self=this;for(var l=0;e>l;l+=i)this.flames.r.push(t(l-r+o,this.flameY*random(.7*this.size.height,this.size.height)+h));this.flames.r.push(t(r+o,h));for(var l=0;s>l;l+=n)this.flames.y.push(t(l-a+o,this.flameY*random(.4*this.size.height,.7*this.size.height)+h));this.flames.y.push(t(a+o,h)),this.lastFrameUpdate=now();for(var c,u=t(o,h),f=0;c=this.flames.r[f];f++)c.sub(u).rotate(this.angle).add(u);for(var c,f=0;c=this.flames.y[f];f++)c.sub(u).rotate(this.angle).add(u)}}),BombManager=new Class({initialize:function(){this.bombShowDelay=30,this.nextBomb=this.bombShowDelay},update:function(t){this.game.isKeyPressed("F")&&this.isReady()&&this.blow(),-1!==this.nextBomb&&this.game.sessionManager.isPlaying&&(this.nextBomb-=t,this.nextBomb<0&&(this.nextBomb=-1,this.game.ui.showMessage("BOMB IS READY<br />(lower right corner or F)")))},blow:function(){var t=this.game.ui.showMessage("3...",5e3);delay(1e3,function(){t.innerHTML="2..."},this),delay(2e3,function(){t.innerHTML="1..."},this),delay(3e3,function(){t.innerHTML="boom"},this),delay(3e3,this.blowStuffUp,this),this.nextBomb=this.bombShowDelay},blowStuffUp:function(){this.game.bulletManager.updateEnemyIndex();for(var t,e=this.game.bulletManager.enemyIndex,i=0;(t=e[i])&&10>i;i++){var s=getRect(t),n=new Vector(s.left+s.width/2,s.top+s.height/2);this.game.explosionManager.addExplosion(n,t,MegaParticleExplosion),t.parentNode.removeChild(t)}this.nextBomb=this.bombShowDelay},isReady:function(){return-1===this.nextBomb}}),ELEMENTSTHATARENOTTOBEINCLUDED=["BR","SCRIPT","STYLE","TITLE","META","HEAD","OPTION","OPTGROUP","LINK"],ELEMENTSIZETHRESHOLD=5,BulletManager=new Class({initialize:function(){this.lastBlink=0,this.blinkActive=!1,this.enemyIndex=[],this.updateDelay=2.5,this.nextUpdate=this.updateDelay},update:function(t){this.game.isKeyPressed("B")?this.blink():this.blinkActive&&this.endBlink(),this.nextUpdate-=t,this.nextUpdate<0&&this.updateEnemyIndex()},blink:function(){if(now()-this.lastBlink>250){for(var t,e=0;t=this.enemyIndex[e];e++)t.style.outline=this.blinkActive?t.KICKASSOLDBORDER:"1px solid red";this.blinkActive=!this.blinkActive,this.lastBlink=now(),this.blinkActive||this.updateEnemyIndex()}},endBlink:function(){for(var t,e=0;t=this.enemyIndex[e];e++)t.style.outline=t.KICKASSOLDBORDER;this.lastBlink=0,this.blinkActive=!1},updateEnemyIndex:function(){var t=document.getElementsByTagName("*");this.enemyIndex=[];for(var e,i=0;e=t[i];i++)this.isDestroyable(e)&&(this.enemyIndex.push(e),e.KICKASSOLDBORDER=e.style.outline||document.defaultView.getComputedStyle(e,null).outline);this.nextUpdate=this.updateDelay},isDestroyable:function(t,e){if(this.shouldIgnoreElement(t,e))return!1;for(var i,s=0;i=t.childNodes[s];s++)if(1===i.nodeType&&-1===ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(i.tagName)&&i.offsetWidth>=ELEMENTSIZETHRESHOLD&&i.offsetHeight>=ELEMENTSIZETHRESHOLD&&"hidden"!==document.defaultView.getComputedStyle(i,null).visibility)return!1;return!0},isDestroyableFromCollision:function(t){return this.isDestroyable(t,!0)},shouldIgnoreElement:function(t,e){if(1!==t.nodeType)return!0;if(t==document.documentElement||t==document.body)return!0;if(-1!==ELEMENTSTHATARENOTTOBEINCLUDED.indexOf(t.tagName))return!0;if("hidden"==t.style.visibility||"none"==t.style.display)return!0;if(t.className&&-1!=t.className.indexOf("KICKASSELEMENT"))return!0;if(!e&&(t.offsetWidth<ELEMENTSIZETHRESHOLD||t.offsetHeight<ELEMENTSIZETHRESHOLD))return!0;var i;return(t.offsetLeft<0||t.offsetTop<0)&&(i=getRect(t),i.left+i.width<0||i.top+i.height<0)?!0:(i||(i=getRect(t)),i.top>=this.game.scrollSize.y?!0:!1)},destroy:function(){for(var t in this.bullets)if(this.bullets.hasOwnProperty(t))for(var e,i=0;e=this.bullets[t][i];i++)e.destroy();this.bullets={}}}),SessionManager=new Class({initialize:function(){this.isPlaying=!1},update:function(){this.isPlaying&&0==this.game.bulletManager.enemyIndex.length&&this.weHaveWon()},weHaveWon:function(){this.isPlaying=!1,this.game.ui.showMessage("You're done!")}}),AlienManager=Class({initialize:function(){this.aliens=[]},update:function(t){if(this.aliens.length)for(var e,i=0;e=this.aliens[i];i++)e.update(t),e.render()}}),alienSize={w:41,h:30};new Class({initialize:function(){this.pos=new Vector(100,100),this.sprite=new Sheet(new Rect(this.pos.x,this.pos.y,alienSize.w,alienSize.h))},update:function(){},render:function(){}});var ExplosionManager=new Class({initialize:function(){this.explosions=[]},update:function(t){for(var e,i=now(),s=0;e=this.explosions[s];s++)i-e.bornAt>(e.ttl||500)?(e.destroy(),this.explosions.splice(s,1)):e.update(t)},addExplosion:function(t,e,i){i=i||ParticleExplosion;var s=new i(t,e);s.game=this.game,s.checkBounds(),this.explosions.push(s)},destroy:function(){for(var t,e=0;t=this.explosions[e];e++)t.destroy();this.explosions=[]}}),Cannon=new Class({initialize:function(t,e,i){this.pos=new Vector(t,e),this.angle=i||0},shootPressed:function(){},shootReleased:function(){},checkCollisions:function(){},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.game.hideAll(),this.checkCollisions(t),this.game.showAll()},checkCollision:function(t){var e=t.checkCollision();return e?(this.game.explosionManager.addExplosion(t.pos,e,this.getExplosionClass()),e.isShot||e.parentNode.removeChild(e),GameGlobals.stats.addElementsDestroyed(),!0):!1},createBullet:function(t){var e=this.getABulletPos(),i=this.getABulletDir(),s=new t(e,i);return s.game=this.game,s.manager=this,s.initCanvas(),s.vel.add(s.vel.cp().setLength(this.player.vel.len())),s},getABulletPos:function(){return this.player.pos.cp().add(this.pos.cp().rotate(this.player.dir.angle()+Math.PI/2))},getABulletDir:function(){return this.player.dir.cp().rotate(this.angle)},destroy:function(){}}),LaserCannon=new Class({Extends:Cannon,initialize:function(){Cannon.prototype.initialize.apply(this,arguments),this.lasers=[]},getExplosionClass:function(){return SplitExplosion},update:function(t){this.lasers.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},checkCollisions:function(t){for(var e,i=0;e=this.lasers[i];i++)e.update(t),this.checkCollision(e)},removeOld:function(){for(var t,e=0;t=this.lasers[e];e++)t.outOfBounds&&(t.destroy(),this.lasers.splice(e,1))},shootPressed:function(){this.lasers.length>5||now()-this.lastFired<500||(this.lastFired=now(),GameGlobals.stats.addShotFired(),this.lasers.push(this.createBullet(LaserBullet)))},destroy:function(){if(this.lasers.length){for(var t,e=0;t=this.lasers[e];e++)t.destroy();this.lasers=[]}}}),BallCannon=new Class({Extends:Cannon,initialize:function(){Cannon.prototype.initialize.apply(this,arguments),this.lastFired=0,this.bullets=[]},getExplosionClass:function(){return ParticleExplosion},update:function(t){this.bullets.length&&(this.removeOld(),Cannon.prototype.update.call(this,t))},removeOld:function(){for(var t,e=now(),i=0;t=this.bullets[i];i++)e-t.bornAt>2e3&&(t.destroy(),this.bullets.splice(i,1))},checkCollisions:function(t){for(var e,i=0;e=this.bullets[i];i++)e.update(t),this.checkCollision(e)&&(e.destroy(),this.bullets.splice(i,1))},shootPressed:function(){now()-this.lastFired<200||(this.lastFired=now(),this.addBullet(),GameGlobals.stats.addShotFired())},addBullet:function(){this.bullets.length>7&&(this.bullets[0].destroy(),this.bullets.shift());var t=this.createBullet(Bullet);this.bullets.push(t)},destroy:function(){for(var t,e=0;t=this.bullets[e];e++)t.destroy();this.bullets=[]}}),Bullet=new Class({initialize:function(t,e){this.pos=t.cp(),this.dir=e,this.vel=new Vector(500,500),this.bornAt=now()},initCanvas:function(){this.sheet=new Sheet(new Rect(this.pos.x,this.pos.y,5,5)),this.sheet.drawBullet()},draw:function(){this.sheet.setPosition(this.pos)},update:function(t){this.pos.add(this.vel.setAngle(this.dir.angle()).mulNew(t)),this.checkBounds(),this.draw()},checkCollision:function(){var t=document.elementFromPoint(this.pos.x,this.pos.y);t&&3==t.nodeType&&(t=t.parentNode);var e=t&&this.game.bulletManager.isDestroyableFromCollision(t)?t:!1;return e},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;i>t?this.pos.x=0:this.pos.x<0&&(this.pos.x=t-this.sheet.rect.size.width/2),s>e?this.pos.y=0:this.pos.y<0&&(this.pos.y=e-this.sheet.rect.size.height/2)},destroy:function(){this.sheet.destroy()}}),LaserBullet=new Class({Extends:Bullet,initialize:function(){Bullet.prototype.initialize.apply(this,arguments),this.vel=new Vector(750,750),this.lastDrawPos=this.pos.cp()},initCanvas:function(){var t=Math.max(GameGlobals.laserImage.width,GameGlobals.laserImage.height);this.sheet=new Sheet(new Rect(0,0,t,t))},update:function(){Bullet.prototype.update.apply(this,arguments)},draw:function(){this.sheet.drawLaser(this.pos,this.dir),this.lastDrawPos=this.pos.cp()},checkBounds:function(){var t=this.game.windowSize.width,e=this.game.windowSize.height,i=this.pos.x+this.sheet.rect.size.width/2,s=this.pos.y+this.sheet.rect.size.height/2;(i>t||this.pos.x<0)&&(this.outOfBounds=!0),(s>e||this.pos.y<0)&&(this.outOfBounds=!0)},destroy:function(){this.sheet.destroy()}});GameGlobals.laserImage=document.createElement("img"),GameGlobals.laserImage.src=GameGlobals.path("css/gfx/kickass/laser.png");var Explosion=new Class({initialize:function(t){this.bornAt=now(),this.pos=t.cp()},update:function(){},checkBounds:function(){},destroy:function(){}}),ParticleExplosion=new Class({Extends:Explosion,initialize:function(t){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(150,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,250,250))},update:function(t){for(var e,i=0;e=this.particles[i];i++)e.pos.add(e.vel.mulNew(t).mul(random(.5,1)).setAngle(e.dir.angle()));this.sheet.clear(),this.sheet.drawExplosion(this.particles)},generateParticles:function(){for(var t=0,e=GameGlobals.hasCanvas?40:10;e>t;t++)this.particles.push({dir:new Vector(random(0,20)-10,random(0,20)-10).normalize(),vel:this.particleVel.cp(),pos:new Vector(0,0),color:["yellow","red"][random(0,1)]})},checkBounds:function(){var t=this.sheet.rect.getRight(),e=this.sheet.rect.getBottom(),i=this.game.windowSize.width,s=this.game.windowSize.height;t>i&&(this.pos.x-=t-i),e>s&&(this.pos.y-=e-s),this.sheet.setPosition(this.pos)},destroy:function(){this.sheet.destroy()}}),MegaParticleExplosion=new Class({Extends:ParticleExplosion,initialize:function(t){Explosion.prototype.initialize.apply(this,arguments),this.particleVel=new Vector(200,0),this.particles=[],this.generateParticles(),this.sheet=new Sheet(new Rect(t.x,t.y,500,500)),this.ttl=2e3,this.generationDelay=.6,this.generationTimes=2,this.nextGenerate=this.generationDelay},update:function(t){this.nextGenerate-=t,this.nextGenerate<=0&&this.generationTimes>0&&(this.nextGenerate=this.generationDelay,this.generateParticles(),this.generationTimes--),ParticleExplosion.prototype.update.call(this,t)}}),SplitExplosion=new Class({Extends:Explosion,initialize:function(t,e){e&&(Explosion.prototype.initialize.apply(this,arguments),this.element=e,this.fx=new Fx,this.fx.addListener(this),this.start())},update:function(){this.element&&this.fx.update()},set:function(t){},start:function(){var t=this.createClones(),e=t[0],i=t[1],s="rotate(-"+random(30,50)+"deg) translate(-100px, 40px)",n="rotate("+random(30,50)+"deg) translate(100px, 40px)";setStyles(e,{WebkitTransform:s,MozTransform:s,OTransform:s,MsTransform:s}),setStyles(i,{WebkitTransform:n,MozTransform:n,OTransform:n,MsTransform:n}),this.left=e,this.right=i,this.fx.add("opacity",{start:1,end:.5,duration:500})},createClones:function(){var t=getRect(this.element),e=this.createContainer(t),i=this.createContainer(t),s=cloneElement(this.element),n=cloneElement(this.element);addClass(s,"KICKASSELEMENT"),addClass(n,"KICKASSELEMENT");var r={margin:0,overflow:"hidden"};return setStyles(s,r),setStyles(n,r),e.appendChild(s),i.appendChild(n),i.style.left=t.left+t.width/2+"px",i.scrollLeft+=t.width/2,this.element.style.opacity=0,this.element.style.visibility="hidden",this.element.style.display="none",each([e,i],function(t){t.style.WebkitTransition="-webkit-transform 500ms ease-in",t.style.OTransition="-o-transform 500ms ease-in",t.style.MozTransition="-moz-transform 500ms ease-in",t.style.MsTransition="-ms-transform 500ms ease-in"})},createContainer:function(t){var e=document.createElement("div");return setStyles(e,{position:"absolute",left:t.left,top:t.top,width:.5*t.width,height:t.height,overflow:"hidden"}),document.body.appendChild(e),e},destroy:function(){try{this.left.parentNode.removeChild(this.left),this.right.parentNode.removeChild(this.right),this.element.parentNode.removeChild(this.element)}catch(t){}}}),Weapons={1:{name:"Cannon",id:"cannon",cannonClass:BallCannon},2:{name:"Laser",id:"laser",cannonClass:LaserCannon}},WeaponMap={cannon:Weapons[1],laser:Weapons[2]},SheetRaphael=new Class({initialize:function(t){this.rect=t,this.fillColor="black",this.strokeColor="black",this.lineWidth=1,this.polyString="",this.raphael=Raphael(this.rect.pos.x-this.rect.size.width/2,this.rect.pos.y-this.rect.size.height/2,this.rect.size.width,this.rect.size.height),this.raphael.canvas.style.zIndex="10000",this.raphael.canvas.className="KICKASSELEMENT",GameGlobals.kickass.registerElement(this.raphael.canvas)},tracePoly:function(t){if(t[0]){this.polyString="M"+t[0].x+" "+t[0].y;for(var e=0;e<t.length;e++)this.polyString+="L"+t[e].x+" "+t[e].y}},setAngle:function(t){this.angle=t},updateCanvas:function(){this.raphael.canvas.width=this.rect.size.width,this.raphael.canvas.height=this.rect.size.height,this.raphael.canvas.style.left=GameGlobals.kickass.scrollPos.x+(this.rect.pos.x-this.rect.size.width/2)+"px",this.raphael.canvas.style.top=GameGlobals.kickass.scrollPos.y+(this.rect.pos.y-this.rect.size.height/2)+"px"},drawLine:function(t,e,i,s){this.tracePoly([[t,e],[i,s]]),this.strokePath()},drawCircle:function(t,e){e=e||{x:0,y:0},this.currentElement=this.raphael.circle(e.x,e.y,t),this.currentElement.attr("fill",this.fillColor)},setFillColor:function(t){this.fillColor=t},setStrokeColor:function(t){this.strokeColor=t},setLineWidth:function(t){this.lineWidth=t},fillPath:function(){this.currentElement=this.raphael.path(this.polyString),this.currentElement.translate(this.rect.size.width/2,this.rect.size.height/2),this.currentElement.attr("fill",this.fillColor),this.currentElement.attr("stroke",this.fillColor),this.currentElement.rotate(Raphael.deg(this.angle),this.rect.size.width/2,this.rect.size.height/2)},strokePath:function(){this.currentElement=this.raphael.path(this.polyString),this.currentElement.attr("stroke",this.strokeColor),this.currentElement.attr("stroke-width",this.lineWidth),this.currentElement.translate(this.rect.size.width/2,this.rect.size.height/2),this.currentElement.rotate(Raphael.deg(this.angle),this.rect.size.width/2,this.rect.size.height/2)},clear:function(){this.raphael.clear()},destroy:function(){GameGlobals.kickass.unregisterElement(this.raphael.canvas),this.raphael.remove()}}),SheetCanvas=new Class({initialize:function(rect){with(this.canvas=document.createElement("canvas"),this.canvas.className="KICKASSELEMENT",this.canvas.style)position="absolute",zIndex="1000000";GameGlobals.kickass.registerElement(this.canvas),this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d")),this.rect=rect,this.angle=0,this.updateCanvas(),document.body.appendChild(this.canvas)},tracePoly:function(t){if(t[0]){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.rotate(this.angle),this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(var e=0;e<t.length;e++)this.ctx.lineTo(t[e].x,t[e].y);this.ctx.restore()}},setAngle:function(t){this.angle=t},updateCanvas:function(){this.canvas.width!=this.rect.size.width&&(this.canvas.width=this.rect.size.width),this.canvas.height!=this.rect.size.height&&(this.canvas.height=this.rect.size.height),this.canvas.style.left=GameGlobals.kickass.scrollPos.x+(this.rect.pos.x-this.rect.size.width/2)+"px",this.canvas.style.top=GameGlobals.kickass.scrollPos.y+(this.rect.pos.y-this.rect.size.height/2)+"px"},drawLine:function(t,e,i,s){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,s),this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},drawCircle:function(t,e){e=e||{x:0,y:0},this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),e&&this.ctx.translate(e.x,e.y),this.ctx.beginPath(),this.ctx.arc(0,0,t,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.closePath(),this.ctx.restore()},drawRect:function(t,e,i,s){this.ctx.save(),this.ctx.translate(this.rect.size.width/2,this.rect.size.height/2),this.ctx.translate(t,e),this.ctx.fillRect(t,e,i,s),this.ctx.restore(),this.ctx.fill()},drawImageFull:function(t){this.ctx.drawImage(t,0,0,this.rect.size.width,this.rect.size.height)},drawImage:function(t,e,i){this.ctx.save(),this.ctx.translate(this.rect.size.width/2+e,this.rect.size.height/2+i),this.ctx.rotate(this.angle),this.ctx.drawImage(t,0,-11),this.ctx.restore()},setFillColor:function(t){this.ctx.fillStyle=t},setStrokeColor:function(t){this.ctx.strokeStyle=t},setLineWidth:function(t){this.ctx.lineWidth=t},fillPath:function(){this.ctx.fill()},strokePath:function(){this.ctx.stroke()},clear:function(){this.ctx.clearRect(0,0,this.rect.size.width,this.rect.size.height)},destroy:function(){GameGlobals.kickass.unregisterElement(this.canvas),this.canvas.parentNode.removeChild(this.canvas)}}),Sheet=new Class({initialize:function(t){this.rect=t,this.drawer=GameGlobals.hasCanvas?new SheetCanvas(t):new SheetRaphael(t)},clear:function(){this.drawer.clear()},setPosition:function(t){this.rect.pos=t.cp(),this.drawer.rect=this.rect,this.drawer.updateCanvas()},setAngle:function(t){this.drawer.setAngle(t)},drawPlayer:function(t){this.drawer.setFillColor("white"),this.drawer.setStrokeColor("black"),this.drawer.setLineWidth(1.5),this.drawer.tracePoly(t),this.drawer.fillPath(),this.drawer.tracePoly(t),this.drawer.strokePath()},drawBrokenPlayer:function(t,e){this.drawer.setStrokeColor("black"),this.drawer.setLineWidth(1.5);for(var i,s=1,n=t[0];i=t[s];s++,n=i){var r=e[s-1];this.drawer.drawLine(n.x+r.pos.x,n.x+r.pos.y,i.x+r.pos.x,i.y+r.pos.y)}},drawFlames:function(t){this.drawer.setLineWidth(1.5),this.drawer.setFillColor("red"),this.drawer.tracePoly(t.r),this.drawer.fillPath(),this.drawer.setFillColor("yellow"),this.drawer.tracePoly(t.y),this.drawer.fillPath()},drawBullet:function(){this.drawer.setFillColor(GameGlobals.bulletColor),this.drawer.drawCircle(2.5)},drawExplosion:function(t){for(var e,i=0;e=t[i];i++)this.drawer.setFillColor(e.color),this.drawer.drawRect(e.pos.x,e.pos.y,3,3)},drawFace:function(t){this.drawer.drawImageFull(t)},drawLaser:function(t,e){this.clear(),this.setPosition(t),this.drawer.setAngle(e.angle()),this.drawer.drawImage(GameGlobals.laserImage,0,0)},transformToSheetCoordinates:function(t){var e=t.cp().sub(new Vector(this.rect.size.width/2,this.rect.size.height/2));return e},destroy:function(){this.drawer.destroy()}}),initKickAss=function(){window.KICKASSGAME?window.KICKASSGAME.addPlayer():(window.KICKASSGAME=GameGlobals.kickass=new KickAss,window.KICKASSGAME.begin())};initKickAss()}("undefined"!=typeof exports?exports:window);